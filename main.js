!function(){"use strict";class e{constructor(e,t){this._formSelector=e.formSelector,this._inputSelector=e.inputSelector,this._errorClass=e.errorClass,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._submitButtonSelector=e.submitButtonSelector,this._form=t}_setFormListeners(){this._inputList=Array.from(this._form.querySelectorAll(this._inputSelector)),this._buttonElement=this._form.querySelector(this._submitButtonSelector),this._toggleButtonState(),this._inputList.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this._toggleButtonState()}))}))}_showInputError(e){const t=this._form.querySelector(".".concat(e.id,"-error"));e.classList.add(this._inputErrorClass),t.textContent=e.validationMessage,t.classList.add(this._errorClass)}_removeInputError(e){const t=this._form.querySelector(".".concat(e.id,"-error"));e.classList.remove(this._inputErrorClass),t.textContent="",t.classList.remove(this._errorClass)}_checkInputValidity(e){e.validity.valid?this._removeInputError(e):this._showInputError(e)}resetValidation(){this._toggleButtonState(),this._inputList.forEach((e=>{this._removeInputError(e)}));const e=this._form.querySelector(".popup-box__submit-button");e.disabled=!0,e.classList.add("popup-box__submit-button_inactive"),this._form.reset()}_toggleButtonState(){this._hasInvalidInput()?(this._buttonElement.classList.add(this._inactiveButtonClass),this._buttonElement.disabled=!0):(this._buttonElement.classList.remove(this._inactiveButtonClass),this._buttonElement.disabled=!1)}_hasInvalidInput(){return this._inputList.some((e=>!e.validity.valid))}enableValidation(){this._setFormListeners(),this._form.addEventListener("submit",(e=>e.preventDefault()))}}class t{constructor(e,t,s){const{name:i,link:n}=e;this._name=i,this._link=n,this._handleImageClick=t,this._cardSelector=s}_getTemplate(){return document.querySelector(this._cardSelector).content.querySelector(".places__item").cloneNode(!0)}_handleToggleLikedBtn(e){e.stopPropagation(),this._placeLikeBtn.classList.toggle("places__like-btn__active")}_handleRemoveItem(e){e.stopPropagation(),this._cardItem.remove(),this._cardItem=null}_setEventListeners(){this._cardItem.addEventListener("click",(()=>{this._handleImageClick(this._name,this._link)})),this._placeLikeBtn.addEventListener("click",(e=>{this._handleToggleLikedBtn(e)})),this._cardItem.querySelector(".places__remove-btn").addEventListener("click",(e=>{this._handleRemoveItem(e)}))}generateCard(){return this._cardItem=this._getTemplate(),this._placeImg=this._cardItem.querySelector(".places__img"),this._placeLikeBtn=this._cardItem.querySelector(".places__like-btn"),this._setEventListeners(),this._placeImg.style.backgroundImage="url(".concat(this._link,")"),this._placeImg.alt="a photo of ".concat(this._name),this._cardItem.querySelector(".places__name").textContent="".concat(this._name),this._cardItem}}class s{constructor(e){var t,s;s=e=>{"Escape"==e.key&&this.close()},(t="_handleEscClose")in this?Object.defineProperty(this,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):this[t]=s,this._popupElement=document.querySelector(e)}open(){this._popupElement.classList.add("popup-box_visible"),document.addEventListener("keydown",this._handleEscClose)}close(){this._popupElement.classList.remove("popup-box_visible"),document.removeEventListener("keydown",this._handleEscClose)}setEventListeners(){this._popupElement.addEventListener("mousedown",(e=>{(e.target.classList.contains("popup-box_visible")||e.target.classList.contains("popup-box__close-button"))&&this.close()}))}}class i extends s{constructor(e,t){var s,i;super(e),i=e=>{e.preventDefault(),this._handleSubmitFrom(this._returnInputValObj()),this.close()},(s="_handleFormSubmit")in this?Object.defineProperty(this,s,{value:i,enumerable:!0,configurable:!0,writable:!0}):this[s]=i,this._handleSubmitFrom=t,this._formElement=this._popupElement.querySelector(".popup-box__form"),this._inputList=[...this._formElement.querySelectorAll(".popup-box__input")]}_returnInputValObj(){const e={};return this._inputList.forEach((t=>{e[t.name]=t.value})),e}open(){super.open()}close(){super.close(),this._formElement.reset()}setEventListeners(){this._formElement.addEventListener("submit",this._handleFormSubmit),super.setEventListeners()}}const n={},o=document.querySelector(".profile__edit-btn"),r=document.querySelector(".profile__add-btn"),l=document.querySelector('input[name="name_input"]'),a=document.querySelector('input[name="about_me"]');function c(e){return new t(e,_,"#places-item-template").generateCard()}function _(e,t){h.open(e,t)}const p=new class{constructor(e,t){let{items:s,renderer:i}=e;this._renderer=i,this._container=document.querySelector(t),this._items=s}renderItems(){this._items.forEach((e=>this._renderer(e)))}addItem(e){this._container.prepend(e)}}({items:[{name:"Yosemite Valley",link:"https://code.s3.yandex.net/web-code/yosemite.jpg"},{name:"Lake Louise",link:"https://code.s3.yandex.net/web-code/lake-louise.jpg"},{name:"Bald Mountains",link:"https://code.s3.yandex.net/web-code/bald-mountains.jpg"},{name:"Latemar",link:"https://code.s3.yandex.net/web-code/latemar.jpg"},{name:"Vanoise National Park",link:"https://code.s3.yandex.net/web-code/vanoise.jpg"},{name:"Lago di Braies",link:"https://code.s3.yandex.net/web-code/lago.jpg"},{name:"Beersheba Turkish railway station",link:"https://upload.wikimedia.org/wikipedia/commons/thumb/d/de/%D7%9E%D7%AA%D7%97%D7%9D_%D7%AA%D7%97%D7%A0%D7%AA_%D7%94%D7%A8%D7%9B%D7%91%D7%AA_%D7%94%D7%98%D7%95%D7%A8%D7%A7%D7%99%D7%AA_%D7%91%D7%91%D7%90%D7%A8_%D7%A9%D7%91%D7%A2.jpg/1280px-%D7%9E%D7%AA%D7%97%D7%9D_%D7%AA%D7%97%D7%A0%D7%AA_%D7%94%D7%A8%D7%9B%D7%91%D7%AA_%D7%94%D7%98%D7%95%D7%A8%D7%A7%D7%99%D7%AA_%D7%91%D7%91%D7%90%D7%A8_%D7%A9%D7%91%D7%A2.jpg"}],renderer:function(e){p.addItem(c(e))}},".places__grid-container"),u=new i(".popup-box_type_profile-edit",(function(e){let{name_input:t,about_me:s}=e;n["form_add-place"].resetValidation(),d.setUserInfo(t,s)})),m=new i(".popup-box_type_add-item",(function(e){let{title_place:t,img_link:s}=e;p.addItem(c({name:t,link:s}))})),h=new class extends s{constructor(e){let{popupSelector:t,imgSelector:s,imgTitleSelector:i}=e;super(t),this._imgElement=this._popupElement.querySelector(s),this._titleElement=this._popupElement.querySelector(i)}_setPopupImg(){this._titleElement.textContent=this.title,this._imgElement.src=this._link,this._imgElement.alt="a pictrue of ".concat(this.title)}open(e,t){this.title=e,this._link=t,this._setPopupImg(),super.open()}}({popupSelector:".popup-box_type_img",imgSelector:".popup-box__img",imgTitleSelector:".popup-box__img-title"}),d=new class{constructor(e){let{nameElm:t,jobElm:s}=e;this._nameElm=document.querySelector(t),this._jobElm=document.querySelector(s)}setUserInfo(e,t){this._nameElm.textContent=e,this._jobElm.textContent=t}getUserInfo(){return{nameInfo:this._nameElm.textContent,aboutMeInfo:this._jobElm.textContent}}}({nameElm:".profile__name",jobElm:".profile__about-me"});var b;p.renderItems(),o.addEventListener("click",(function(){n["form_profile-edit"].resetValidation(),u.open();const{nameInfo:e,aboutMeInfo:t}=d.getUserInfo();l.value=e,a.value=t})),r.addEventListener("click",(function(){n["form_add-place"].resetValidation(),m.open()})),b={formSelector:".popup-box__form",inputSelector:".popup-box__input",submitButtonSelector:".popup-box__submit-button",inactiveButtonClass:"popup-box__submit-button_inactive",inputErrorClass:".popup-box__input_type_error",errorClass:".popup-box__input-error_active"},Array.from(document.querySelectorAll(b.formSelector)).forEach((t=>{const s=new e(b,t),i=t.name;n[i]=s,s.enableValidation()})),u.setEventListeners(),m.setEventListeners(),h.setEventListeners()}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWFpbi5qcyIsIm1hcHBpbmdzIjoieUJBQU8sTUFBTUEsRUFDWEMsWUFBWUMsRUFBVUMsR0FDcEJDLEtBQUtDLGNBQWdCSCxFQUFTSSxhQUM5QkYsS0FBS0csZUFBaUJMLEVBQVNNLGNBQy9CSixLQUFLSyxZQUFjUCxFQUFTUSxXQUM1Qk4sS0FBS08scUJBQXVCVCxFQUFTVSxvQkFDckNSLEtBQUtTLGlCQUFtQlgsRUFBU1ksZ0JBQ2pDVixLQUFLVyxzQkFBd0JiLEVBQVNjLHFCQUN0Q1osS0FBS2EsTUFBUWQsRUFFZmUsb0JBQ0VkLEtBQUtlLFdBQWFDLE1BQU1DLEtBQ3RCakIsS0FBS2EsTUFBTUssaUJBQWlCbEIsS0FBS0csaUJBRW5DSCxLQUFLbUIsZUFBaUJuQixLQUFLYSxNQUFNTyxjQUFjcEIsS0FBS1csdUJBQ3BEWCxLQUFLcUIscUJBQ0xyQixLQUFLZSxXQUFXTyxTQUFTQyxJQUN2QkEsRUFBYUMsaUJBQWlCLFNBQVMsS0FDckN4QixLQUFLeUIsb0JBQW9CRixHQUN6QnZCLEtBQUtxQiwyQkFJWEssZ0JBQWdCSCxHQUNkLE1BQU1JLEVBQWUzQixLQUFLYSxNQUFNTyxjQUFYLFdBQTZCRyxFQUFhSyxHQUExQyxXQUNyQkwsRUFBYU0sVUFBVUMsSUFBSTlCLEtBQUtTLGtCQUNoQ2tCLEVBQWFJLFlBQWNSLEVBQWFTLGtCQUN4Q0wsRUFBYUUsVUFBVUMsSUFBSTlCLEtBQUtLLGFBR2xDNEIsa0JBQWtCVixHQUNoQixNQUFNSSxFQUFlM0IsS0FBS2EsTUFBTU8sY0FBWCxXQUE2QkcsRUFBYUssR0FBMUMsV0FDckJMLEVBQWFNLFVBQVVLLE9BQU9sQyxLQUFLUyxrQkFDbkNrQixFQUFhSSxZQUFjLEdBQzNCSixFQUFhRSxVQUFVSyxPQUFPbEMsS0FBS0ssYUFHckNvQixvQkFBb0JGLEdBQ2RBLEVBQWFZLFNBQVNDLE1BQ3hCcEMsS0FBS2lDLGtCQUFrQlYsR0FDbEJ2QixLQUFLMEIsZ0JBQWdCSCxHQUc5QmMsa0JBQ0VyQyxLQUFLcUIscUJBQ0xyQixLQUFLZSxXQUFXTyxTQUFTQyxJQUN2QnZCLEtBQUtpQyxrQkFBa0JWLE1BRXpCLE1BQU1lLEVBQWF0QyxLQUFLYSxNQUFNTyxjQUFjLDZCQUM1Q2tCLEVBQVdDLFVBQVcsRUFDdEJELEVBQVdULFVBQVVDLElBQUkscUNBQ3pCOUIsS0FBS2EsTUFBTTJCLFFBRWJuQixxQkFDTXJCLEtBQUt5QyxvQkFDUHpDLEtBQUttQixlQUFlVSxVQUFVQyxJQUFJOUIsS0FBS08sc0JBQ3ZDUCxLQUFLbUIsZUFBZW9CLFVBQVcsSUFFL0J2QyxLQUFLbUIsZUFBZVUsVUFBVUssT0FBT2xDLEtBQUtPLHNCQUMxQ1AsS0FBS21CLGVBQWVvQixVQUFXLEdBR25DRSxtQkFDRSxPQUFPekMsS0FBS2UsV0FBVzJCLE1BQU1DLElBQ25CQSxFQUFNUixTQUFTQyxRQUczQlEsbUJBQ0U1QyxLQUFLYyxvQkFDTGQsS0FBS2EsTUFBTVcsaUJBQWlCLFVBQVdxQixHQUFNQSxFQUFFQyxvQkNwRTVDLE1BQU1DLEVBQ1hsRCxZQUFZbUQsRUFBTUMsRUFBa0JDLEdBQ2xDLE1BQU0sS0FBRUMsRUFBRixLQUFRQyxHQUFTSixFQUN2QmhELEtBQUtxRCxNQUFRRixFQUNibkQsS0FBS3NELE1BQVFGLEVBQ2JwRCxLQUFLdUQsa0JBQW9CTixFQUN6QmpELEtBQUt3RCxjQUFnQk4sRUFFdkJPLGVBUUUsT0FQMEJDLFNBQVN0QyxjQUNqQ3BCLEtBQUt3RCxlQUNMRyxRQUVDdkMsY0FBYyxpQkFDZHdDLFdBQVUsR0FJZkMsc0JBQXNCaEIsR0FDcEJBLEVBQUVpQixrQkFDRjlELEtBQUsrRCxjQUFjbEMsVUFBVW1DLE9BQU8sNEJBRXRDQyxrQkFBa0JwQixHQUNoQkEsRUFBRWlCLGtCQUNGOUQsS0FBS2tFLFVBQVVoQyxTQUNmbEMsS0FBS2tFLFVBQVksS0FHbkJDLHFCQUNFbkUsS0FBS2tFLFVBQVUxQyxpQkFBaUIsU0FBUyxLQUN2Q3hCLEtBQUt1RCxrQkFBa0J2RCxLQUFLcUQsTUFBT3JELEtBQUtzRCxVQUUxQ3RELEtBQUsrRCxjQUFjdkMsaUJBQWlCLFNBQVVxQixJQUM1QzdDLEtBQUs2RCxzQkFBc0JoQixNQUU3QjdDLEtBQUtrRSxVQUNGOUMsY0FBYyx1QkFDZEksaUJBQWlCLFNBQVVxQixJQUMxQjdDLEtBQUtpRSxrQkFBa0JwQixNQUk3QnVCLGVBUUUsT0FQQXBFLEtBQUtrRSxVQUFZbEUsS0FBS3lELGVBQ3RCekQsS0FBS3FFLFVBQVlyRSxLQUFLa0UsVUFBVTlDLGNBQWMsZ0JBQzlDcEIsS0FBSytELGNBQWdCL0QsS0FBS2tFLFVBQVU5QyxjQUFjLHFCQUNsRHBCLEtBQUttRSxxQkFDTG5FLEtBQUtxRSxVQUFVQyxNQUFNQyxnQkFBckIsY0FBOEN2RSxLQUFLc0QsTUFBbkQsS0FDQXRELEtBQUtxRSxVQUFVRyxJQUFmLHFCQUFtQ3hFLEtBQUtxRCxPQUN4Q3JELEtBQUtrRSxVQUFVOUMsY0FBYyxpQkFBaUJXLFlBQTlDLFVBQStEL0IsS0FBS3FELE9BQzdEckQsS0FBS2tFLFdDbkRELE1BQU1PLEVBQ25CNUUsWUFBWTZFLEcsVUFJTzdCLElBQ0osVUFBVEEsRUFBRThCLEtBQ0ozRSxLQUFLNEUsVSxFQU5rQiwwQixzQkFBQSxLLHVEQUFBLEssS0FDekI1RSxLQUFLNkUsY0FBZ0JuQixTQUFTdEMsY0FBY3NELEdBUTlDSSxPQUNFOUUsS0FBSzZFLGNBQWNoRCxVQUFVQyxJQUFJLHFCQUNqQzRCLFNBQVNsQyxpQkFBaUIsVUFBV3hCLEtBQUsrRSxpQkFHNUNILFFBQ0U1RSxLQUFLNkUsY0FBY2hELFVBQVVLLE9BQU8scUJBQ3BDd0IsU0FBU3NCLG9CQUFvQixVQUFXaEYsS0FBSytFLGlCQUcvQ0Usb0JBQ0VqRixLQUFLNkUsY0FBY3JELGlCQUFpQixhQUFjcUIsS0FFOUNBLEVBQUVxQyxPQUFPckQsVUFBVXNELFNBQVMsc0JBQzVCdEMsRUFBRXFDLE9BQU9yRCxVQUFVc0QsU0FBUyw2QkFFNUJuRixLQUFLNEUsWUN4QkUsTUFBTVEsVUFBc0JYLEVBQ3pDNUUsWUFBWTZFLEVBQWVXLEcsUUFDekJDLE1BQU1aLEcsRUFRYTdCLElBQ25CQSxFQUFFQyxpQkFDRjlDLEtBQUt1RixrQkFBa0J2RixLQUFLd0Ysc0JBQzVCeEYsS0FBSzRFLFUsRUFac0MsNEIsc0JBQUEsSyx1REFBQSxLLEtBRTNDNUUsS0FBS3VGLGtCQUFvQkYsRUFDekJyRixLQUFLeUYsYUFBZXpGLEtBQUs2RSxjQUFjekQsY0FBYyxvQkFDckRwQixLQUFLZSxXQUFhLElBQ2JmLEtBQUt5RixhQUFhdkUsaUJBQWlCLHNCQVUxQ3NFLHFCQUNFLE1BQU1FLEVBQWMsR0FJcEIsT0FIQTFGLEtBQUtlLFdBQVdPLFNBQVNxRSxJQUN2QkQsRUFBWUMsRUFBS3hDLE1BQVF3QyxFQUFLQyxTQUV6QkYsRUFFVFosT0FDRVEsTUFBTVIsT0FFUkYsUUFDRVUsTUFBTVYsUUFDTjVFLEtBQUt5RixhQUFhakQsUUFFcEJ5QyxvQkFDRWpGLEtBQUt5RixhQUFhakUsaUJBQWlCLFNBQVV4QixLQUFLNkYsbUJBQ2xEUCxNQUFNTCxxQkNsQ1YsTUErQk1hLEVBQWlCLEdBRWpCQyxFQUF1QnJDLFNBQVN0QyxjQUFjLHNCQUM5QzRFLEVBQXdCdEMsU0FBU3RDLGNBQWMscUJBRS9DNkUsRUFBWXZDLFNBQVN0QyxjQUFjLDRCQUNuQzhFLEVBQWV4QyxTQUFTdEMsY0FBYywwQkN0QjVDLFNBQVMrRSxFQUFnQlIsR0FFdkIsT0FEZ0IsSUFBSTVDLEVBQUs0QyxFQUFNUyxFQUFjLHlCQUM5QmhDLGVBMkJqQixTQUFTZ0MsRUFBYUMsRUFBT2pELEdBQzNCa0QsRUFBWXhCLEtBQUt1QixFQUFPakQsR0FpQzFCLE1BQU1tRCxFQUFZLElDOUVILE1BQ2IxRyxZQUFZLEVBQXFCMkcsR0FBbUIsSUFBeEMsTUFBRUMsRUFBRixTQUFTQyxHQUErQixFQUNsRDFHLEtBQUsyRyxVQUFZRCxFQUNqQjFHLEtBQUs0RyxXQUFhbEQsU0FBU3RDLGNBQWNvRixHQUN6Q3hHLEtBQUs2RyxPQUFTSixFQUdoQkssY0FDRTlHLEtBQUs2RyxPQUFPdkYsU0FBU3FFLEdBQVMzRixLQUFLMkcsVUFBVWhCLEtBRy9Db0IsUUFBUUMsR0FDTmhILEtBQUs0RyxXQUFXSyxRQUFRRCxLRG1FMUIsQ0FDRVAsTURoRmlCLENBQ25CLENBQ0V0RCxLQUFNLGtCQUNOQyxLQUFNLG9EQUVSLENBQ0VELEtBQU0sY0FDTkMsS0FBTSx1REFFUixDQUNFRCxLQUFNLGlCQUNOQyxLQUFNLDBEQUVSLENBQ0VELEtBQU0sVUFDTkMsS0FBTSxtREFFUixDQUNFRCxLQUFNLHdCQUNOQyxLQUFNLG1EQUVSLENBQ0VELEtBQU0saUJBQ05DLEtBQU0sZ0RBRVIsQ0FDRUQsS0FBTSxvQ0FDTkMsS0FBTSw2WkNzRE5zRCxTQVBKLFNBQW9CZixHQUNsQlksRUFBVVEsUUFBUVosRUFBZ0JSLE1BUWxDLDJCQUVJdUIsRUFBWSxJQUFJOUIsRUFDcEIsZ0NBcENGLFlBQTJELElBQTFCLFdBQUUrQixFQUFGLFNBQWNDLEdBQVksRUFDekR0QixFQUFlLGtCQUFrQnpELGtCQUNqQ2dGLEVBQVlDLFlBQVlILEVBQVlDLE1BcUNoQ0csRUFBVyxJQUFJbkMsRUFDbkIsNEJBM0NGLFlBQW9FLElBQXJDb0MsWUFBYXJFLEVBQU1zRSxTQUFVckUsR0FBUSxFQUNsRW1ELEVBQVVRLFFBQVFaLEVBQWdCLENBQUVoRCxLQUFBQSxFQUFNQyxLQUFBQSxRQTZDdENrRCxFQUFjLElFM0ZMLGNBQTZCN0IsRUFDMUM1RSxZQUFZLEdBQWtELElBQWxELGNBQUU2RSxFQUFGLFlBQWlCZ0QsRUFBakIsaUJBQThCQyxHQUFvQixFQUM1RHJDLE1BQU1aLEdBQ04xRSxLQUFLNEgsWUFBYzVILEtBQUs2RSxjQUFjekQsY0FBY3NHLEdBQ3BEMUgsS0FBSzZILGNBQWdCN0gsS0FBSzZFLGNBQWN6RCxjQUFjdUcsR0FHeERHLGVBQ0U5SCxLQUFLNkgsY0FBYzlGLFlBQWMvQixLQUFLcUcsTUFDdENyRyxLQUFLNEgsWUFBWUcsSUFBTS9ILEtBQUtzRCxNQUM1QnRELEtBQUs0SCxZQUFZcEQsSUFBakIsdUJBQXVDeEUsS0FBS3FHLE9BRzlDdkIsS0FBS3VCLEVBQU9qRCxHQUNWcEQsS0FBS3FHLE1BQVFBLEVBQ2JyRyxLQUFLc0QsTUFBUUYsRUFDYnBELEtBQUs4SCxlQUNMeEMsTUFBTVIsU0YwRTZCLENBQ3JDSixjQUFlLHNCQUNmZ0QsWUFBYSxrQkFDYkMsaUJBQWtCLDBCQUVkTixFQUFjLElHbEdMLE1BQ2J4SCxZQUFZLEdBQXFCLElBQXJCLFFBQUVtSSxFQUFGLE9BQVdDLEdBQVUsRUFDL0JqSSxLQUFLa0ksU0FBV3hFLFNBQVN0QyxjQUFjNEcsR0FDdkNoSSxLQUFLbUksUUFBVXpFLFNBQVN0QyxjQUFjNkcsR0FHeENYLFlBQVluRSxFQUFNaUYsR0FDaEJwSSxLQUFLa0ksU0FBU25HLFlBQWNvQixFQUM1Qm5ELEtBQUttSSxRQUFRcEcsWUFBY3FHLEVBRTdCQyxjQUNFLE1BQU8sQ0FDTEMsU0FBVXRJLEtBQUtrSSxTQUFTbkcsWUFDeEJ3RyxZQUFhdkksS0FBS21JLFFBQVFwRyxlSHFGQyxDQUMvQmlHLFFBQVMsaUJBQ1RDLE9BQVEsdUJBN0NWLElBbkMwQm5JLEVBb0N4QnlHLEVBQVVPLGNBQ1ZmLEVBQXFCdkUsaUJBQWlCLFNBcEJ4QyxXQUNFc0UsRUFBZSxxQkFBcUJ6RCxrQkFDcEM2RSxFQUFVcEMsT0FDVixNQUFNLFNBQUV3RCxFQUFGLFlBQVlDLEdBQWdCbEIsRUFBWWdCLGNBQzlDcEMsRUFBVUwsTUFBUTBDLEVBQ2xCcEMsRUFBYU4sTUFBUTJDLEtBZ0JyQnZDLEVBQXNCeEUsaUJBQWlCLFNBekJ6QyxXQUNFc0UsRUFBZSxrQkFBa0J6RCxrQkFDakNrRixFQUFTekMsVUFmZWhGLEVBdUNQLENBQ2ZJLGFBQWMsbUJBQ2RFLGNBQWUsb0JBQ2ZRLHFCQUFzQiw0QkFDdEJKLG9CQUFxQixvQ0FDckJFLGdCQUFpQiwrQkFDakJKLFdBQVksa0NBNUNJVSxNQUFNQyxLQUN0QnlDLFNBQVN4QyxpQkFBaUJwQixFQUFTSSxlQUczQm9CLFNBQVN2QixJQUNqQixNQUFNeUksRUFBVyxJQUFJNUksRUFBY0UsRUFBVUMsR0FDdkMwSSxFQUFXMUksRUFBS29ELEtBQ3RCMkMsRUFBZTJDLEdBQVlELEVBQzNCQSxFQUFTNUYsc0JBeUNYc0UsRUFBVWpDLG9CQUNWc0MsRUFBU3RDLG9CQUNUcUIsRUFBWXJCLG9CIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL0NhcmQuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL1BvcHVwLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvdXRpbHMvY29uc3RhbnRzLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvcGFnZXMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL1NlY3Rpb24uanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9Vc2VySW5mby5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgY2xhc3MgRm9ybVZhbGlkYXRvciB7XHJcbiAgY29uc3RydWN0b3Ioc2V0dGluZ3MsIGZvcm0pIHtcclxuICAgIHRoaXMuX2Zvcm1TZWxlY3RvciA9IHNldHRpbmdzLmZvcm1TZWxlY3RvcjtcclxuICAgIHRoaXMuX2lucHV0U2VsZWN0b3IgPSBzZXR0aW5ncy5pbnB1dFNlbGVjdG9yO1xyXG4gICAgdGhpcy5fZXJyb3JDbGFzcyA9IHNldHRpbmdzLmVycm9yQ2xhc3M7XHJcbiAgICB0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzID0gc2V0dGluZ3MuaW5hY3RpdmVCdXR0b25DbGFzcztcclxuICAgIHRoaXMuX2lucHV0RXJyb3JDbGFzcyA9IHNldHRpbmdzLmlucHV0RXJyb3JDbGFzcztcclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvblNlbGVjdG9yID0gc2V0dGluZ3Muc3VibWl0QnV0dG9uU2VsZWN0b3I7XHJcbiAgICB0aGlzLl9mb3JtID0gZm9ybTtcclxuICB9XHJcbiAgX3NldEZvcm1MaXN0ZW5lcnMoKSB7XHJcbiAgICB0aGlzLl9pbnB1dExpc3QgPSBBcnJheS5mcm9tKFxyXG4gICAgICB0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3JBbGwodGhpcy5faW5wdXRTZWxlY3RvcilcclxuICAgICk7XHJcbiAgICB0aGlzLl9idXR0b25FbGVtZW50ID0gdGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yKHRoaXMuX3N1Ym1pdEJ1dHRvblNlbGVjdG9yKTtcclxuICAgIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKCk7XHJcbiAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaCgoaW5wdXRFbGVtZW50KSA9PiB7XHJcbiAgICAgIGlucHV0RWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiaW5wdXRcIiwgKCkgPT4ge1xyXG4gICAgICAgIHRoaXMuX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dEVsZW1lbnQpO1xyXG4gICAgICAgIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKCk7XHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcbiAgfVxyXG4gIF9zaG93SW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpIHtcclxuICAgIGNvbnN0IGVycm9yRWxlbWVudCA9IHRoaXMuX2Zvcm0ucXVlcnlTZWxlY3RvcihgLiR7aW5wdXRFbGVtZW50LmlkfS1lcnJvcmApO1xyXG4gICAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5hZGQodGhpcy5faW5wdXRFcnJvckNsYXNzKTtcclxuICAgIGVycm9yRWxlbWVudC50ZXh0Q29udGVudCA9IGlucHV0RWxlbWVudC52YWxpZGF0aW9uTWVzc2FnZTtcclxuICAgIGVycm9yRWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuX2Vycm9yQ2xhc3MpO1xyXG4gIH1cclxuXHJcbiAgX3JlbW92ZUlucHV0RXJyb3IoaW5wdXRFbGVtZW50KSB7XHJcbiAgICBjb25zdCBlcnJvckVsZW1lbnQgPSB0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3IoYC4ke2lucHV0RWxlbWVudC5pZH0tZXJyb3JgKTtcclxuICAgIGlucHV0RWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2lucHV0RXJyb3JDbGFzcyk7XHJcbiAgICBlcnJvckVsZW1lbnQudGV4dENvbnRlbnQgPSBcIlwiO1xyXG4gICAgZXJyb3JFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5fZXJyb3JDbGFzcyk7XHJcbiAgfVxyXG5cclxuICBfY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWxlbWVudCkge1xyXG4gICAgaWYgKGlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZCkge1xyXG4gICAgICB0aGlzLl9yZW1vdmVJbnB1dEVycm9yKGlucHV0RWxlbWVudCk7XHJcbiAgICB9IGVsc2UgdGhpcy5fc2hvd0lucHV0RXJyb3IoaW5wdXRFbGVtZW50KTtcclxuICB9XHJcblxyXG4gIHJlc2V0VmFsaWRhdGlvbigpIHtcclxuICAgIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKCk7XHJcbiAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaCgoaW5wdXRFbGVtZW50KSA9PiB7XHJcbiAgICAgIHRoaXMuX3JlbW92ZUlucHV0RXJyb3IoaW5wdXRFbGVtZW50KTtcclxuICAgIH0pO1xyXG4gICAgY29uc3QgYnRuRm9ybUVsbSA9IHRoaXMuX2Zvcm0ucXVlcnlTZWxlY3RvcihcIi5wb3B1cC1ib3hfX3N1Ym1pdC1idXR0b25cIik7XHJcbiAgICBidG5Gb3JtRWxtLmRpc2FibGVkID0gdHJ1ZTtcclxuICAgIGJ0bkZvcm1FbG0uY2xhc3NMaXN0LmFkZChcInBvcHVwLWJveF9fc3VibWl0LWJ1dHRvbl9pbmFjdGl2ZVwiKTtcclxuICAgIHRoaXMuX2Zvcm0ucmVzZXQoKTtcclxuICB9XHJcbiAgX3RvZ2dsZUJ1dHRvblN0YXRlKCkge1xyXG4gICAgaWYgKHRoaXMuX2hhc0ludmFsaWRJbnB1dCgpKSB7XHJcbiAgICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcclxuICAgICAgdGhpcy5fYnV0dG9uRWxlbWVudC5kaXNhYmxlZCA9IHRydWU7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLl9idXR0b25FbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyk7XHJcbiAgICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQuZGlzYWJsZWQgPSBmYWxzZTtcclxuICAgIH1cclxuICB9XHJcbiAgX2hhc0ludmFsaWRJbnB1dCgpIHtcclxuICAgIHJldHVybiB0aGlzLl9pbnB1dExpc3Quc29tZSgoaW5wdXQpID0+IHtcclxuICAgICAgcmV0dXJuICFpbnB1dC52YWxpZGl0eS52YWxpZDtcclxuICAgIH0pO1xyXG4gIH1cclxuICBlbmFibGVWYWxpZGF0aW9uKCkge1xyXG4gICAgdGhpcy5fc2V0Rm9ybUxpc3RlbmVycygpO1xyXG4gICAgdGhpcy5fZm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChlKSA9PiBlLnByZXZlbnREZWZhdWx0KCkpO1xyXG4gIH1cclxufVxyXG4iLCJcclxuZXhwb3J0IGNsYXNzIENhcmQge1xyXG4gIGNvbnN0cnVjdG9yKGRhdGEsIGhhbmRsZUltYWdlQ2xpY2ssIGNhcmRTZWxlY3Rvcikge1xyXG4gICAgY29uc3QgeyBuYW1lLCBsaW5rIH0gPSBkYXRhO1xyXG4gICAgdGhpcy5fbmFtZSA9IG5hbWU7XHJcbiAgICB0aGlzLl9saW5rID0gbGluaztcclxuICAgIHRoaXMuX2hhbmRsZUltYWdlQ2xpY2sgPSBoYW5kbGVJbWFnZUNsaWNrO1xyXG4gICAgdGhpcy5fY2FyZFNlbGVjdG9yID0gY2FyZFNlbGVjdG9yO1xyXG4gIH1cclxuICBfZ2V0VGVtcGxhdGUoKSB7XHJcbiAgICBjb25zdCBwbGFjZUl0ZW1UZW1wbGF0ZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgICAgIHRoaXMuX2NhcmRTZWxlY3RvclxyXG4gICAgKS5jb250ZW50O1xyXG4gICAgY29uc3QgY2FyZEVsZW1lbnQgPSBwbGFjZUl0ZW1UZW1wbGF0ZVxyXG4gICAgICAucXVlcnlTZWxlY3RvcihcIi5wbGFjZXNfX2l0ZW1cIilcclxuICAgICAgLmNsb25lTm9kZSh0cnVlKTtcclxuXHJcbiAgICByZXR1cm4gY2FyZEVsZW1lbnQ7XHJcbiAgfVxyXG4gIF9oYW5kbGVUb2dnbGVMaWtlZEJ0bihlKSB7XHJcbiAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xyXG4gICAgdGhpcy5fcGxhY2VMaWtlQnRuLmNsYXNzTGlzdC50b2dnbGUoXCJwbGFjZXNfX2xpa2UtYnRuX19hY3RpdmVcIik7XHJcbiAgfVxyXG4gIF9oYW5kbGVSZW1vdmVJdGVtKGUpIHtcclxuICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgICB0aGlzLl9jYXJkSXRlbS5yZW1vdmUoKTtcclxuICAgIHRoaXMuX2NhcmRJdGVtID0gbnVsbDsgXHJcbiAgfVxyXG5cclxuICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICB0aGlzLl9jYXJkSXRlbS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gICAgICB0aGlzLl9oYW5kbGVJbWFnZUNsaWNrKHRoaXMuX25hbWUsIHRoaXMuX2xpbmspO1xyXG4gICAgfSk7XHJcbiAgICB0aGlzLl9wbGFjZUxpa2VCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChlKSA9PiB7XHJcbiAgICAgIHRoaXMuX2hhbmRsZVRvZ2dsZUxpa2VkQnRuKGUpO1xyXG4gICAgfSk7XHJcbiAgICB0aGlzLl9jYXJkSXRlbVxyXG4gICAgICAucXVlcnlTZWxlY3RvcihcIi5wbGFjZXNfX3JlbW92ZS1idG5cIilcclxuICAgICAgLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZSkgPT4ge1xyXG4gICAgICAgIHRoaXMuX2hhbmRsZVJlbW92ZUl0ZW0oZSk7XHJcbiAgICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgZ2VuZXJhdGVDYXJkKCkge1xyXG4gICAgdGhpcy5fY2FyZEl0ZW0gPSB0aGlzLl9nZXRUZW1wbGF0ZSgpO1xyXG4gICAgdGhpcy5fcGxhY2VJbWcgPSB0aGlzLl9jYXJkSXRlbS5xdWVyeVNlbGVjdG9yKFwiLnBsYWNlc19faW1nXCIpO1xyXG4gICAgdGhpcy5fcGxhY2VMaWtlQnRuID0gdGhpcy5fY2FyZEl0ZW0ucXVlcnlTZWxlY3RvcihcIi5wbGFjZXNfX2xpa2UtYnRuXCIpO1xyXG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuICAgIHRoaXMuX3BsYWNlSW1nLnN0eWxlLmJhY2tncm91bmRJbWFnZSA9IGB1cmwoJHt0aGlzLl9saW5rfSlgO1xyXG4gICAgdGhpcy5fcGxhY2VJbWcuYWx0ID0gYGEgcGhvdG8gb2YgJHt0aGlzLl9uYW1lfWA7XHJcbiAgICB0aGlzLl9jYXJkSXRlbS5xdWVyeVNlbGVjdG9yKFwiLnBsYWNlc19fbmFtZVwiKS50ZXh0Q29udGVudCA9IGAke3RoaXMuX25hbWV9YDtcclxuICAgIHJldHVybiB0aGlzLl9jYXJkSXRlbTtcclxuICB9XHJcbn1cclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXAge1xyXG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IpIHtcclxuICAgIHRoaXMuX3BvcHVwRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IocG9wdXBTZWxlY3Rvcik7XHJcbiAgfVxyXG5cclxuICBfaGFuZGxlRXNjQ2xvc2UgPSAoZSkgPT4ge1xyXG4gICAgaWYgKGUua2V5ID09IFwiRXNjYXBlXCIpIHtcclxuICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgfVxyXG4gIH07XHJcbiAgb3BlbigpIHtcclxuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5jbGFzc0xpc3QuYWRkKFwicG9wdXAtYm94X3Zpc2libGVcIik7XHJcbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSk7XHJcbiAgfVxyXG5cclxuICBjbG9zZSgpIHtcclxuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKFwicG9wdXAtYm94X3Zpc2libGVcIik7XHJcbiAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSk7XHJcbiAgfVxyXG5cclxuICBzZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwibW91c2Vkb3duXCIsIChlKSA9PiB7XHJcbiAgICAgIGlmIChcclxuICAgICAgICBlLnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJwb3B1cC1ib3hfdmlzaWJsZVwiKSB8fFxyXG4gICAgICAgIGUudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhcInBvcHVwLWJveF9fY2xvc2UtYnV0dG9uXCIpXHJcbiAgICAgICkge1xyXG4gICAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgfVxyXG59XHJcbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoRm9ybSBleHRlbmRzIFBvcHVwIHtcclxuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yLCBoYW5kbGVTdWJtaXRGcm9tKSB7XHJcbiAgICBzdXBlcihwb3B1cFNlbGVjdG9yKTtcclxuICAgIHRoaXMuX2hhbmRsZVN1Ym1pdEZyb20gPSBoYW5kbGVTdWJtaXRGcm9tO1xyXG4gICAgdGhpcy5fZm9ybUVsZW1lbnQgPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5wb3B1cC1ib3hfX2Zvcm1cIik7XHJcbiAgICB0aGlzLl9pbnB1dExpc3QgPSBbXHJcbiAgICAgIC4uLnRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIucG9wdXAtYm94X19pbnB1dFwiKSxcclxuICAgIF07XHJcbiAgfVxyXG5cclxuICBfaGFuZGxlRm9ybVN1Ym1pdCA9IChlKSA9PiB7XHJcbiAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICB0aGlzLl9oYW5kbGVTdWJtaXRGcm9tKHRoaXMuX3JldHVybklucHV0VmFsT2JqKCkpO1xyXG4gICAgdGhpcy5jbG9zZSgpO1xyXG4gIH07XHJcblxyXG4gIF9yZXR1cm5JbnB1dFZhbE9iaigpIHtcclxuICAgIGNvbnN0IHZhbElucHV0T2JqID0ge307XHJcbiAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaCgoaXRlbSkgPT4ge1xyXG4gICAgICB2YWxJbnB1dE9ialtpdGVtLm5hbWVdID0gaXRlbS52YWx1ZTtcclxuICAgIH0pO1xyXG4gICAgcmV0dXJuIHZhbElucHV0T2JqO1xyXG4gIH1cclxuICBvcGVuKCkge1xyXG4gICAgc3VwZXIub3BlbigpO1xyXG4gIH1cclxuICBjbG9zZSgpIHtcclxuICAgIHN1cGVyLmNsb3NlKCk7XHJcbiAgICB0aGlzLl9mb3JtRWxlbWVudC5yZXNldCgpO1xyXG4gIH1cclxuICBzZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIHRoaXMuX2Zvcm1FbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCk7XHJcbiAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xyXG4gIH1cclxufVxyXG4iLCJjb25zdCBpbml0aWFsQ2FyZHMgPSBbXHJcbiAge1xyXG4gICAgbmFtZTogXCJZb3NlbWl0ZSBWYWxsZXlcIixcclxuICAgIGxpbms6IFwiaHR0cHM6Ly9jb2RlLnMzLnlhbmRleC5uZXQvd2ViLWNvZGUveW9zZW1pdGUuanBnXCIsXHJcbiAgfSxcclxuICB7XHJcbiAgICBuYW1lOiBcIkxha2UgTG91aXNlXCIsXHJcbiAgICBsaW5rOiBcImh0dHBzOi8vY29kZS5zMy55YW5kZXgubmV0L3dlYi1jb2RlL2xha2UtbG91aXNlLmpwZ1wiLFxyXG4gIH0sXHJcbiAge1xyXG4gICAgbmFtZTogXCJCYWxkIE1vdW50YWluc1wiLFxyXG4gICAgbGluazogXCJodHRwczovL2NvZGUuczMueWFuZGV4Lm5ldC93ZWItY29kZS9iYWxkLW1vdW50YWlucy5qcGdcIixcclxuICB9LFxyXG4gIHtcclxuICAgIG5hbWU6IFwiTGF0ZW1hclwiLFxyXG4gICAgbGluazogXCJodHRwczovL2NvZGUuczMueWFuZGV4Lm5ldC93ZWItY29kZS9sYXRlbWFyLmpwZ1wiLFxyXG4gIH0sXHJcbiAge1xyXG4gICAgbmFtZTogXCJWYW5vaXNlIE5hdGlvbmFsIFBhcmtcIixcclxuICAgIGxpbms6IFwiaHR0cHM6Ly9jb2RlLnMzLnlhbmRleC5uZXQvd2ViLWNvZGUvdmFub2lzZS5qcGdcIixcclxuICB9LFxyXG4gIHtcclxuICAgIG5hbWU6IFwiTGFnbyBkaSBCcmFpZXNcIixcclxuICAgIGxpbms6IFwiaHR0cHM6Ly9jb2RlLnMzLnlhbmRleC5uZXQvd2ViLWNvZGUvbGFnby5qcGdcIixcclxuICB9LFxyXG4gIHtcclxuICAgIG5hbWU6IFwiQmVlcnNoZWJhIFR1cmtpc2ggcmFpbHdheSBzdGF0aW9uXCIsXHJcbiAgICBsaW5rOiBcImh0dHBzOi8vdXBsb2FkLndpa2ltZWRpYS5vcmcvd2lraXBlZGlhL2NvbW1vbnMvdGh1bWIvZC9kZS8lRDclOUUlRDclQUElRDclOTclRDclOURfJUQ3JUFBJUQ3JTk3JUQ3JUEwJUQ3JUFBXyVENyU5NCVENyVBOCVENyU5QiVENyU5MSVENyVBQV8lRDclOTQlRDclOTglRDclOTUlRDclQTglRDclQTclRDclOTklRDclQUFfJUQ3JTkxJUQ3JTkxJUQ3JTkwJUQ3JUE4XyVENyVBOSVENyU5MSVENyVBMi5qcGcvMTI4MHB4LSVENyU5RSVENyVBQSVENyU5NyVENyU5RF8lRDclQUElRDclOTclRDclQTAlRDclQUFfJUQ3JTk0JUQ3JUE4JUQ3JTlCJUQ3JTkxJUQ3JUFBXyVENyU5NCVENyU5OCVENyU5NSVENyVBOCVENyVBNyVENyU5OSVENyVBQV8lRDclOTElRDclOTElRDclOTAlRDclQThfJUQ3JUE5JUQ3JTkxJUQ3JUEyLmpwZ1wiLFxyXG4gIH0sXHJcbiAgXHJcbl07XHJcbmNvbnN0IGZvcm1WYWxpZGF0b3JzID0ge307XHJcblxyXG5jb25zdCBvcGVuRWRpdFVzZXJQb3B1cEJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fZWRpdC1idG5cIik7XHJcbmNvbnN0IG9wZW5BZGRQbGFjZXNQb3B1cEJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fYWRkLWJ0blwiKTtcclxuXHJcbmNvbnN0IG5hbWVJbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2lucHV0W25hbWU9XCJuYW1lX2lucHV0XCJdJyk7XHJcbmNvbnN0IGFib3V0TWVJbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2lucHV0W25hbWU9XCJhYm91dF9tZVwiXScpO1xyXG5cclxuZXhwb3J0IHtcclxuICBhYm91dE1lSW5wdXQsXHJcbiAgbmFtZUlucHV0LFxyXG4gIGluaXRpYWxDYXJkcyxcclxuICBvcGVuRWRpdFVzZXJQb3B1cEJ0bixcclxuICBvcGVuQWRkUGxhY2VzUG9wdXBCdG4sXHJcbiAgZm9ybVZhbGlkYXRvcnMsXHJcbn07XHJcbiIsImltcG9ydCBcIi4vaW5kZXguY3NzXCI7XHJcbmltcG9ydCB7IEZvcm1WYWxpZGF0b3IgfSBmcm9tIFwiLi4vY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzXCI7XHJcbmltcG9ydCB7IENhcmQgfSBmcm9tIFwiLi4vY29tcG9uZW50cy9DYXJkLmpzXCI7XHJcbmltcG9ydCBTZWN0aW9uIGZyb20gXCIuLi9jb21wb25lbnRzL1NlY3Rpb24uanNcIjtcclxuaW1wb3J0IFBvcHVwV2l0aEZvcm0gZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qc1wiO1xyXG5pbXBvcnQgUG9wdXBXaXRoSW1hZ2UgZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanNcIjtcclxuaW1wb3J0IFVzZXJJbmZvIGZyb20gXCIuLi9jb21wb25lbnRzL1VzZXJJbmZvLmpzXCI7XHJcbmltcG9ydCB7XHJcbiAgYWJvdXRNZUlucHV0LFxyXG4gIG5hbWVJbnB1dCxcclxuICBpbml0aWFsQ2FyZHMsXHJcbiAgb3BlbkVkaXRVc2VyUG9wdXBCdG4sXHJcbiAgb3BlbkFkZFBsYWNlc1BvcHVwQnRuLFxyXG4gIGZvcm1WYWxpZGF0b3JzLFxyXG59IGZyb20gXCIuLi91dGlscy9jb25zdGFudHMuanNcIjtcclxuZnVuY3Rpb24gY3JlYXRlUGxhY2VJdGVtKGl0ZW0pIHtcclxuICBjb25zdCBuZXdDYXJkID0gbmV3IENhcmQoaXRlbSwgb3BlbkltZ1BvcHVwLCBcIiNwbGFjZXMtaXRlbS10ZW1wbGF0ZVwiKTtcclxuICByZXR1cm4gbmV3Q2FyZC5nZW5lcmF0ZUNhcmQoKTtcclxufVxyXG5cclxuZnVuY3Rpb24gZW5hYmxlVmFsaWRhdGlvbihzZXR0aW5ncykge1xyXG4gIGNvbnN0IGZvcm1JdGVtcyA9IEFycmF5LmZyb20oXHJcbiAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKHNldHRpbmdzLmZvcm1TZWxlY3RvcilcclxuICApO1xyXG5cclxuICBmb3JtSXRlbXMuZm9yRWFjaCgoZm9ybSkgPT4ge1xyXG4gICAgY29uc3QgbmV3VmFpbGQgPSBuZXcgRm9ybVZhbGlkYXRvcihzZXR0aW5ncywgZm9ybSk7XHJcbiAgICBjb25zdCBmb3JtTmFtZSA9IGZvcm0ubmFtZTtcclxuICAgIGZvcm1WYWxpZGF0b3JzW2Zvcm1OYW1lXSA9IG5ld1ZhaWxkO1xyXG4gICAgbmV3VmFpbGQuZW5hYmxlVmFsaWRhdGlvbigpO1xyXG4gIH0pO1xyXG59XHJcblxyXG5mdW5jdGlvbiBvcGVuQWRkUHJvZmlsZVBvcHVwKCkge1xyXG4gIGZvcm1WYWxpZGF0b3JzW1wiZm9ybV9hZGQtcGxhY2VcIl0ucmVzZXRWYWxpZGF0aW9uKCk7XHJcbiAgQWRkUG9wdXAub3BlbigpO1xyXG59XHJcbmZ1bmN0aW9uIG9wZW5FZGl0UHJvZmlsZVBvcHVwKCkge1xyXG4gIGZvcm1WYWxpZGF0b3JzW1wiZm9ybV9wcm9maWxlLWVkaXRcIl0ucmVzZXRWYWxpZGF0aW9uKCk7XHJcbiAgRWRpdFBvcHVwLm9wZW4oKTtcclxuICBjb25zdCB7IG5hbWVJbmZvLCBhYm91dE1lSW5mbyB9ID0gcHJvZmlsZVVzZXIuZ2V0VXNlckluZm8oKTtcclxuICBuYW1lSW5wdXQudmFsdWUgPSBuYW1lSW5mbztcclxuICBhYm91dE1lSW5wdXQudmFsdWUgPSBhYm91dE1lSW5mbztcclxufVxyXG5mdW5jdGlvbiBvcGVuSW1nUG9wdXAodGl0bGUsIGxpbmspIHtcclxuICBuZXdJbWdQb3B1cC5vcGVuKHRpdGxlLCBsaW5rKTtcclxufVxyXG5mdW5jdGlvbiBoYW5kbGVTdWJtaXRBZGRJdGVtKHsgdGl0bGVfcGxhY2U6IG5hbWUsIGltZ19saW5rOiBsaW5rIH0pIHtcclxuICBjYXJkc0xpc3QuYWRkSXRlbShjcmVhdGVQbGFjZUl0ZW0oeyBuYW1lLCBsaW5rIH0pKTtcclxufVxyXG5mdW5jdGlvbiBoYW5kbGVTdWJtaXRFZGl0UHJvZmlsZSh7IG5hbWVfaW5wdXQsIGFib3V0X21lIH0pIHtcclxuICBmb3JtVmFsaWRhdG9yc1tcImZvcm1fYWRkLXBsYWNlXCJdLnJlc2V0VmFsaWRhdGlvbigpO1xyXG4gIHByb2ZpbGVVc2VyLnNldFVzZXJJbmZvKG5hbWVfaW5wdXQsIGFib3V0X21lKTtcclxufVxyXG5cclxuZnVuY3Rpb24gb25Jbml0KCkge1xyXG4gIGNhcmRzTGlzdC5yZW5kZXJJdGVtcygpO1xyXG4gIG9wZW5FZGl0VXNlclBvcHVwQnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBvcGVuRWRpdFByb2ZpbGVQb3B1cCk7XHJcbiAgb3BlbkFkZFBsYWNlc1BvcHVwQnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBvcGVuQWRkUHJvZmlsZVBvcHVwKTtcclxuICBlbmFibGVWYWxpZGF0aW9uKHtcclxuICAgIGZvcm1TZWxlY3RvcjogXCIucG9wdXAtYm94X19mb3JtXCIsXHJcbiAgICBpbnB1dFNlbGVjdG9yOiBcIi5wb3B1cC1ib3hfX2lucHV0XCIsXHJcbiAgICBzdWJtaXRCdXR0b25TZWxlY3RvcjogXCIucG9wdXAtYm94X19zdWJtaXQtYnV0dG9uXCIsXHJcbiAgICBpbmFjdGl2ZUJ1dHRvbkNsYXNzOiBcInBvcHVwLWJveF9fc3VibWl0LWJ1dHRvbl9pbmFjdGl2ZVwiLFxyXG4gICAgaW5wdXRFcnJvckNsYXNzOiBcIi5wb3B1cC1ib3hfX2lucHV0X3R5cGVfZXJyb3JcIixcclxuICAgIGVycm9yQ2xhc3M6IFwiLnBvcHVwLWJveF9faW5wdXQtZXJyb3JfYWN0aXZlXCIsXHJcbiAgfSk7XHJcbiAgc2V0UG9wdXBFdmVudCgpO1xyXG59XHJcbmZ1bmN0aW9uIHNldFBvcHVwRXZlbnQoKSB7XHJcbiAgRWRpdFBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgQWRkUG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuICBuZXdJbWdQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xyXG59XHJcbmZ1bmN0aW9uIHJlbmRlckNhcmQoaXRlbSkge1xyXG4gIGNhcmRzTGlzdC5hZGRJdGVtKGNyZWF0ZVBsYWNlSXRlbShpdGVtKSk7XHJcbn1cclxuXHJcbmNvbnN0IGNhcmRzTGlzdCA9IG5ldyBTZWN0aW9uKFxyXG4gIHtcclxuICAgIGl0ZW1zOiBpbml0aWFsQ2FyZHMsXHJcbiAgICByZW5kZXJlcjogcmVuZGVyQ2FyZCxcclxuICB9LFxyXG4gIFwiLnBsYWNlc19fZ3JpZC1jb250YWluZXJcIlxyXG4pO1xyXG5jb25zdCBFZGl0UG9wdXAgPSBuZXcgUG9wdXBXaXRoRm9ybShcclxuICBcIi5wb3B1cC1ib3hfdHlwZV9wcm9maWxlLWVkaXRcIixcclxuICBoYW5kbGVTdWJtaXRFZGl0UHJvZmlsZVxyXG4pO1xyXG5jb25zdCBBZGRQb3B1cCA9IG5ldyBQb3B1cFdpdGhGb3JtKFxyXG4gIFwiLnBvcHVwLWJveF90eXBlX2FkZC1pdGVtXCIsXHJcbiAgaGFuZGxlU3VibWl0QWRkSXRlbVxyXG4pO1xyXG5jb25zdCBuZXdJbWdQb3B1cCA9IG5ldyBQb3B1cFdpdGhJbWFnZSh7XHJcbiAgcG9wdXBTZWxlY3RvcjogXCIucG9wdXAtYm94X3R5cGVfaW1nXCIsXHJcbiAgaW1nU2VsZWN0b3I6IFwiLnBvcHVwLWJveF9faW1nXCIsXHJcbiAgaW1nVGl0bGVTZWxlY3RvcjogXCIucG9wdXAtYm94X19pbWctdGl0bGVcIixcclxufSk7XHJcbmNvbnN0IHByb2ZpbGVVc2VyID0gbmV3IFVzZXJJbmZvKHtcclxuICBuYW1lRWxtOiBcIi5wcm9maWxlX19uYW1lXCIsXHJcbiAgam9iRWxtOiBcIi5wcm9maWxlX19hYm91dC1tZVwiLFxyXG59KTtcclxub25Jbml0KCk7XHJcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFNlY3Rpb24ge1xyXG4gIGNvbnN0cnVjdG9yKHsgaXRlbXMsIHJlbmRlcmVyIH0sIGNvbnRhaW5lclNlbGVjdG9yKSB7XHJcbiAgICB0aGlzLl9yZW5kZXJlciA9IHJlbmRlcmVyO1xyXG4gICAgdGhpcy5fY29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihjb250YWluZXJTZWxlY3Rvcik7XHJcbiAgICB0aGlzLl9pdGVtcyA9IGl0ZW1zO1xyXG4gIH1cclxuXHJcbiAgcmVuZGVySXRlbXMoKSB7XHJcbiAgICB0aGlzLl9pdGVtcy5mb3JFYWNoKChpdGVtKSA9PiB0aGlzLl9yZW5kZXJlcihpdGVtKSk7XHJcbiAgfVxyXG5cclxuICBhZGRJdGVtKGVsKSB7XHJcbiAgICB0aGlzLl9jb250YWluZXIucHJlcGVuZChlbCk7XHJcbiAgfVxyXG59XHJcbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoSW1hZ2UgZXh0ZW5kcyBQb3B1cCB7XHJcbiAgY29uc3RydWN0b3IoeyBwb3B1cFNlbGVjdG9yLCBpbWdTZWxlY3RvciwgaW1nVGl0bGVTZWxlY3RvciB9KSB7XHJcbiAgICBzdXBlcihwb3B1cFNlbGVjdG9yKTtcclxuICAgIHRoaXMuX2ltZ0VsZW1lbnQgPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihpbWdTZWxlY3Rvcik7XHJcbiAgICB0aGlzLl90aXRsZUVsZW1lbnQgPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihpbWdUaXRsZVNlbGVjdG9yKTtcclxuICB9XHJcblxyXG4gIF9zZXRQb3B1cEltZygpIHtcclxuICAgIHRoaXMuX3RpdGxlRWxlbWVudC50ZXh0Q29udGVudCA9IHRoaXMudGl0bGU7XHJcbiAgICB0aGlzLl9pbWdFbGVtZW50LnNyYyA9IHRoaXMuX2xpbms7XHJcbiAgICB0aGlzLl9pbWdFbGVtZW50LmFsdCA9IGBhIHBpY3RydWUgb2YgJHt0aGlzLnRpdGxlfWA7XHJcbiAgfVxyXG5cclxuICBvcGVuKHRpdGxlLCBsaW5rKSB7XHJcbiAgICB0aGlzLnRpdGxlID0gdGl0bGU7XHJcbiAgICB0aGlzLl9saW5rID0gbGluaztcclxuICAgIHRoaXMuX3NldFBvcHVwSW1nKCk7XHJcbiAgICBzdXBlci5vcGVuKCk7XHJcbiAgfVxyXG59XHJcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFVzZXJJbmZvIHtcclxuICBjb25zdHJ1Y3Rvcih7IG5hbWVFbG0sIGpvYkVsbSB9KSB7XHJcbiAgICB0aGlzLl9uYW1lRWxtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihuYW1lRWxtKTtcclxuICAgIHRoaXMuX2pvYkVsbSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3Ioam9iRWxtKTtcclxuICB9XHJcblxyXG4gIHNldFVzZXJJbmZvKG5hbWUsIGFib3V0TWUpIHtcclxuICAgIHRoaXMuX25hbWVFbG0udGV4dENvbnRlbnQgPSBuYW1lO1xyXG4gICAgdGhpcy5fam9iRWxtLnRleHRDb250ZW50ID0gYWJvdXRNZTtcclxuICB9XHJcbiAgZ2V0VXNlckluZm8oKSB7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICBuYW1lSW5mbzogdGhpcy5fbmFtZUVsbS50ZXh0Q29udGVudCxcclxuICAgICAgYWJvdXRNZUluZm86IHRoaXMuX2pvYkVsbS50ZXh0Q29udGVudCxcclxuICAgIH07XHJcbiAgfVxyXG59XHJcbiJdLCJuYW1lcyI6WyJGb3JtVmFsaWRhdG9yIiwiY29uc3RydWN0b3IiLCJzZXR0aW5ncyIsImZvcm0iLCJ0aGlzIiwiX2Zvcm1TZWxlY3RvciIsImZvcm1TZWxlY3RvciIsIl9pbnB1dFNlbGVjdG9yIiwiaW5wdXRTZWxlY3RvciIsIl9lcnJvckNsYXNzIiwiZXJyb3JDbGFzcyIsIl9pbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiaW5hY3RpdmVCdXR0b25DbGFzcyIsIl9pbnB1dEVycm9yQ2xhc3MiLCJpbnB1dEVycm9yQ2xhc3MiLCJfc3VibWl0QnV0dG9uU2VsZWN0b3IiLCJzdWJtaXRCdXR0b25TZWxlY3RvciIsIl9mb3JtIiwiX3NldEZvcm1MaXN0ZW5lcnMiLCJfaW5wdXRMaXN0IiwiQXJyYXkiLCJmcm9tIiwicXVlcnlTZWxlY3RvckFsbCIsIl9idXR0b25FbGVtZW50IiwicXVlcnlTZWxlY3RvciIsIl90b2dnbGVCdXR0b25TdGF0ZSIsImZvckVhY2giLCJpbnB1dEVsZW1lbnQiLCJhZGRFdmVudExpc3RlbmVyIiwiX2NoZWNrSW5wdXRWYWxpZGl0eSIsIl9zaG93SW5wdXRFcnJvciIsImVycm9yRWxlbWVudCIsImlkIiwiY2xhc3NMaXN0IiwiYWRkIiwidGV4dENvbnRlbnQiLCJ2YWxpZGF0aW9uTWVzc2FnZSIsIl9yZW1vdmVJbnB1dEVycm9yIiwicmVtb3ZlIiwidmFsaWRpdHkiLCJ2YWxpZCIsInJlc2V0VmFsaWRhdGlvbiIsImJ0bkZvcm1FbG0iLCJkaXNhYmxlZCIsInJlc2V0IiwiX2hhc0ludmFsaWRJbnB1dCIsInNvbWUiLCJpbnB1dCIsImVuYWJsZVZhbGlkYXRpb24iLCJlIiwicHJldmVudERlZmF1bHQiLCJDYXJkIiwiZGF0YSIsImhhbmRsZUltYWdlQ2xpY2siLCJjYXJkU2VsZWN0b3IiLCJuYW1lIiwibGluayIsIl9uYW1lIiwiX2xpbmsiLCJfaGFuZGxlSW1hZ2VDbGljayIsIl9jYXJkU2VsZWN0b3IiLCJfZ2V0VGVtcGxhdGUiLCJkb2N1bWVudCIsImNvbnRlbnQiLCJjbG9uZU5vZGUiLCJfaGFuZGxlVG9nZ2xlTGlrZWRCdG4iLCJzdG9wUHJvcGFnYXRpb24iLCJfcGxhY2VMaWtlQnRuIiwidG9nZ2xlIiwiX2hhbmRsZVJlbW92ZUl0ZW0iLCJfY2FyZEl0ZW0iLCJfc2V0RXZlbnRMaXN0ZW5lcnMiLCJnZW5lcmF0ZUNhcmQiLCJfcGxhY2VJbWciLCJzdHlsZSIsImJhY2tncm91bmRJbWFnZSIsImFsdCIsIlBvcHVwIiwicG9wdXBTZWxlY3RvciIsImtleSIsImNsb3NlIiwiX3BvcHVwRWxlbWVudCIsIm9wZW4iLCJfaGFuZGxlRXNjQ2xvc2UiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwic2V0RXZlbnRMaXN0ZW5lcnMiLCJ0YXJnZXQiLCJjb250YWlucyIsIlBvcHVwV2l0aEZvcm0iLCJoYW5kbGVTdWJtaXRGcm9tIiwic3VwZXIiLCJfaGFuZGxlU3VibWl0RnJvbSIsIl9yZXR1cm5JbnB1dFZhbE9iaiIsIl9mb3JtRWxlbWVudCIsInZhbElucHV0T2JqIiwiaXRlbSIsInZhbHVlIiwiX2hhbmRsZUZvcm1TdWJtaXQiLCJmb3JtVmFsaWRhdG9ycyIsIm9wZW5FZGl0VXNlclBvcHVwQnRuIiwib3BlbkFkZFBsYWNlc1BvcHVwQnRuIiwibmFtZUlucHV0IiwiYWJvdXRNZUlucHV0IiwiY3JlYXRlUGxhY2VJdGVtIiwib3BlbkltZ1BvcHVwIiwidGl0bGUiLCJuZXdJbWdQb3B1cCIsImNhcmRzTGlzdCIsImNvbnRhaW5lclNlbGVjdG9yIiwiaXRlbXMiLCJyZW5kZXJlciIsIl9yZW5kZXJlciIsIl9jb250YWluZXIiLCJfaXRlbXMiLCJyZW5kZXJJdGVtcyIsImFkZEl0ZW0iLCJlbCIsInByZXBlbmQiLCJFZGl0UG9wdXAiLCJuYW1lX2lucHV0IiwiYWJvdXRfbWUiLCJwcm9maWxlVXNlciIsInNldFVzZXJJbmZvIiwiQWRkUG9wdXAiLCJ0aXRsZV9wbGFjZSIsImltZ19saW5rIiwiaW1nU2VsZWN0b3IiLCJpbWdUaXRsZVNlbGVjdG9yIiwiX2ltZ0VsZW1lbnQiLCJfdGl0bGVFbGVtZW50IiwiX3NldFBvcHVwSW1nIiwic3JjIiwibmFtZUVsbSIsImpvYkVsbSIsIl9uYW1lRWxtIiwiX2pvYkVsbSIsImFib3V0TWUiLCJnZXRVc2VySW5mbyIsIm5hbWVJbmZvIiwiYWJvdXRNZUluZm8iLCJuZXdWYWlsZCIsImZvcm1OYW1lIl0sInNvdXJjZVJvb3QiOiIifQ==