!function(){"use strict";var t={855:function(t,e,s){t.exports=s.p+"images/spinner_svg.dc4086388e55820fbae1.svg"}},e={};function s(n){var i=e[n];if(void 0!==i)return i.exports;var o=e[n]={exports:{}};return t[n](o,o.exports,s),o.exports}s.p="",function(){class t{constructor(t,e){this._formSelector=t.formSelector,this._inputSelector=t.inputSelector,this._errorClass=t.errorClass,this._inactiveButtonClass=t.inactiveButtonClass,this._inputErrorClass=t.inputErrorClass,this._submitButtonSelector=t.submitButtonSelector,this._form=e}_setFormListeners(){this._inputList=Array.from(this._form.querySelectorAll(this._inputSelector)),this._buttonElement=this._form.querySelector(this._submitButtonSelector),this._toggleButtonState(),this._inputList.forEach((t=>{t.addEventListener("input",(()=>{this._checkInputValidity(t),this._toggleButtonState()}))}))}_showInputError(t){const e=this._form.querySelector(".".concat(t.id,"-error"));t.classList.add(this._inputErrorClass),e.textContent=t.validationMessage,e.classList.add(this._errorClass)}_removeInputError(t){const e=this._form.querySelector(".".concat(t.id,"-error"));t.classList.remove(this._inputErrorClass),e.textContent="",e.classList.remove(this._errorClass)}_checkInputValidity(t){t.validity.valid?this._removeInputError(t):this._showInputError(t)}resetValidation(){this._toggleButtonState(),this._inputList.forEach((t=>{this._removeInputError(t)}));const t=this._form.querySelector(".popup-box__submit-button");t.disabled=!0,t.classList.add("popup-box__submit-button_inactive"),this._form.reset()}_toggleButtonState(){this._hasInvalidInput()?(this._buttonElement.classList.add(this._inactiveButtonClass),this._buttonElement.disabled=!0):(this._buttonElement.classList.remove(this._inactiveButtonClass),this._buttonElement.disabled=!1)}_hasInvalidInput(){return this._inputList.some((t=>!t.validity.valid))}enableValidation(){this._setFormListeners(),this._form.addEventListener("submit",(t=>t.preventDefault()))}}class e{constructor(t,e,s){const{name:n,link:i}=t;this._name=n,this._link=i,this._handleImageClick=e,this._cardSelector=s}_getTemplate(){return document.querySelector(this._cardSelector).content.querySelector(".places__item").cloneNode(!0)}_handleToggleLikedBtn(t){t.stopPropagation(),this._placeLikeBtn.classList.toggle("places__like-btn__active")}_handleRemoveItem(t){t.stopPropagation(),this._cardItem.remove(),this._cardItem=null}_setEventListeners(){"Loading..."===this._name&&"images/spinner_svg.dc4086388e55820fbae1.svg"===this._link||(this._cardItem.addEventListener("click",(()=>{this._handleImageClick(this._name,this._link)})),this._placeLikeBtn.addEventListener("click",(t=>{this._handleToggleLikedBtn(t)})),this._cardItem.querySelector(".places__remove-btn").addEventListener("click",(t=>{this._handleRemoveItem(t)})))}generateCard(){return this._cardItem=this._getTemplate(),this._placeImg=this._cardItem.querySelector(".places__img"),this._placeLikeBtn=this._cardItem.querySelector(".places__like-btn"),this._setEventListeners(),this._placeImg.style.backgroundImage="url(".concat(this._link,")"),this._placeImg.alt="a photo of ".concat(this._name),this._cardItem.querySelector(".places__name").textContent="".concat(this._name),this._cardItem}}class n{constructor(t){var e,s;s=t=>{"Escape"==t.key&&this.close()},(e="_handleEscClose")in this?Object.defineProperty(this,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):this[e]=s,this._popupElement=document.querySelector(t)}open(){this._popupElement.classList.add("popup-box_visible"),document.addEventListener("keydown",this._handleEscClose)}close(){this._popupElement.classList.remove("popup-box_visible"),document.removeEventListener("keydown",this._handleEscClose)}setEventListeners(){this._popupElement.addEventListener("mousedown",(t=>{(t.target.classList.contains("popup-box_visible")||t.target.classList.contains("popup-box__close-button"))&&this.close()}))}}class i extends n{constructor(t,e){var s,n;super(t),n=t=>{t.preventDefault(),this._handleSubmitFrom(this._returnInputValObj()),this.close()},(s="_handleFormSubmit")in this?Object.defineProperty(this,s,{value:n,enumerable:!0,configurable:!0,writable:!0}):this[s]=n,this._handleSubmitFrom=e,this._formElement=this._popupElement.querySelector(".popup-box__form"),this._inputList=[...this._formElement.querySelectorAll(".popup-box__input")]}_returnInputValObj(){const t={};return this._inputList.forEach((e=>{t[e.name]=e.value})),t}open(){super.open()}close(){super.close(),this._formElement.reset()}setEventListeners(){this._formElement.addEventListener("submit",this._handleFormSubmit),super.setEventListeners()}}var o=s(855);const r={},a=document.querySelector(".profile__edit-btn"),l=document.querySelector(".profile__add-btn"),c=document.querySelector('input[name="name_input"]'),u=document.querySelector('input[name="about_me"]');function _(t){return new e(t,h,"#places-item-template").generateCard()}function p(){r["form_add-place"].resetValidation(),E.open()}function m(){r["form_profile-edit"].resetValidation(),f.open();const{nameInfo:t,aboutMeInfo:e}=g.getUserInfo();c.value=t,u.value=e}function h(t,e){v.open(t,e)}function d(t,e,s){t?(g.setUserInfo({name:"Loading...",about:"Loading...",_id:null}),g.setPictureProfile(o),b.setNewItemlist([{name:"Loading...",link:o}])):(document.querySelector(".places__grid-container").innerHTML="",g.setUserInfo({name:s.name,about:s.about,_id:s._id}),g.setPictureProfile(s.avatar),b.setNewItemlist(e))}const b=new class{constructor(t,e){this._renderer=t,this._container=document.querySelector(e)}renderItems(){this._items.forEach((t=>this._renderer(t)))}addItem(t){this._container.prepend(t)}setNewItemlist(t){this._items=t,this.renderItems()}}((function(t){b.addItem(_(t))}),".places__grid-container"),f=new i(".popup-box_type_profile-edit",(function(t){let{name_input:e,about_me:s}=t;r["form_add-place"].resetValidation(),I.setUserInfo({name:e,about:s}).then((t=>{g.setUserInfo(t)}))})),E=new i(".popup-box_type_add-item",(function(t){let{title_place:e,img_link:s}=t;b.addItem(_({name:e,link:s}))})),v=new class extends n{constructor(t){let{popupSelector:e,imgSelector:s,imgTitleSelector:n}=t;super(e),this._imgElement=this._popupElement.querySelector(s),this._titleElement=this._popupElement.querySelector(n)}_setPopupImg(){this._titleElement.textContent=this.title,this._imgElement.src=this._link,this._imgElement.alt="a pictrue of ".concat(this.title)}open(t,e){this.title=t,this._link=e,this._setPopupImg(),super.open()}}({popupSelector:".popup-box_type_img",imgSelector:".popup-box__img",imgTitleSelector:".popup-box__img-title"}),g=new class{constructor(t){let{nameElm:e,jobElm:s,picElm:n}=t;this._nameElm=document.querySelector(e),this._jobElm=document.querySelector(s),this._picElm=document.querySelector(n)}setUserInfo(t){let{name:e,about:s,_id:n}=t;this._nameElm.textContent=e,this._jobElm.textContent=s,this._userId=n}getUserInfo(){return{nameInfo:this._nameElm.textContent,aboutMeInfo:this._jobElm.textContent}}setPictureProfile(t){this._picElm.src=t}}({nameElm:".profile__name",jobElm:".profile__about-me",picElm:".profile__avatar"}),I=new class{constructor(t){let{baseUrl:e,headers:s}=t;this.headers=s,this.baseUrl=e}_onHttpRequest(t,e,s){const n="".concat(this.baseUrl).concat(t);return fetch(n,{method:e,headers:this.headers,body:JSON.stringify(s)}).then((t=>t.ok?t.json():Promise.reject("Error: ".concat(t.status))))}getInitInfo(){return Promise.all([this._getInitialCards(),this._getUserInfo()])}_getUserInfo(){return this._onHttpRequest("users/me","GET")}_getInitialCards(){return this._onHttpRequest("cards","GET")}setUserInfo(t){let{name:e,about:s}=t;return this._onHttpRequest("users/me","PATCH",{name:e,about:s})}addNewCard(t){let{name:e,link:s}=t;return this._onHttpRequest("cards","post",{name:e,link:s})}}({baseUrl:"https://around.nomoreparties.co/v1/group-12/",headers:{authorization:"035a3e80-0d3f-421b-b4fa-7f406e49ad5f","Content-Type":"application/json"}});d(!0),I.getInitInfo().then((e=>{let[s,n]=e;var i;d(!1,s,n),a.addEventListener("click",m),l.addEventListener("click",p),i={formSelector:".popup-box__form",inputSelector:".popup-box__input",submitButtonSelector:".popup-box__submit-button",inactiveButtonClass:"popup-box__submit-button_inactive",inputErrorClass:".popup-box__input_type_error",errorClass:".popup-box__input-error_active"},Array.from(document.querySelectorAll(i.formSelector)).forEach((e=>{const s=new t(i,e),n=e.name;r[n]=s,s.enableValidation()})),f.setEventListeners(),E.setEventListeners(),v.setEventListeners()})).catch((t=>{console.log(t)}))}()}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUFBQSxFQUFLQyxLQUFBQSxNQ2pDakMsQ0FDakJ1RyxRQUFTLCtDQUNUQyxRQUFTLENBQ1RrQixjQUFlLHVDQUNiLGVBQWdCLHNCTCtFbEIvRCxHQUFlLEdBQ2Z5QixFQUNHaUMsY0FDQWhDLE1BQUssSUFBOEIsSUFBNUJ4QixFQUFjQyxHQUFjLEVBOUR4QyxJQUEwQnBILEVBK0RwQmlILEdBQWUsRUFBT0UsRUFBY0MsR0FDcENuQixFQUFxQnZFLGlCQUFpQixRQUFTK0UsR0FDL0NQLEVBQXNCeEUsaUJBQWlCLFFBQVM2RSxHQWpFNUJ2RyxFQWtFSCxDQUNmSSxhQUFjLG1CQUNkRSxjQUFlLG9CQUNmUSxxQkFBc0IsNEJBQ3RCSixvQkFBcUIsb0NBQ3JCRSxnQkFBaUIsK0JBQ2pCSixXQUFZLGtDQXZFQVUsTUFBTUMsS0FDdEJ5QyxTQUFTeEMsaUJBQWlCcEIsRUFBU0ksZUFHM0JvQixTQUFTdkIsSUFDakIsTUFBTWdMLEVBQVcsSUFBSW5MLEVBQWNFLEVBQVVDLEdBQ3ZDaUwsRUFBV2pMLEVBQUtvRCxLQUN0QjJDLEVBQWVrRixHQUFZRCxFQUMzQkEsRUFBU25JLHNCQXlFWDRELEVBQVV2QixvQkFDVnFCLEVBQVNyQixvQkFDVDZCLEVBQVk3Qix1QkFQVGdHLE9BQU9DLElBQ05DLFFBQVFDLElBQUlGLE0iLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80L3dlYnBhY2svYm9vdHN0cmFwIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvd2VicGFjay9ydW50aW1lL3B1YmxpY1BhdGgiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL0NhcmQuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL1BvcHVwLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvdXRpbHMvY29uc3RhbnRzLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvcGFnZXMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL1NlY3Rpb24uanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9Vc2VySW5mby5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL3V0aWxzL0FwaS5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vY29uZmlnLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIFRoZSBtb2R1bGUgY2FjaGVcbnZhciBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX18gPSB7fTtcblxuLy8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbmZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG5cdHZhciBjYWNoZWRNb2R1bGUgPSBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX19bbW9kdWxlSWRdO1xuXHRpZiAoY2FjaGVkTW9kdWxlICE9PSB1bmRlZmluZWQpIHtcblx0XHRyZXR1cm4gY2FjaGVkTW9kdWxlLmV4cG9ydHM7XG5cdH1cblx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcblx0dmFyIG1vZHVsZSA9IF9fd2VicGFja19tb2R1bGVfY2FjaGVfX1ttb2R1bGVJZF0gPSB7XG5cdFx0Ly8gbm8gbW9kdWxlLmlkIG5lZWRlZFxuXHRcdC8vIG5vIG1vZHVsZS5sb2FkZWQgbmVlZGVkXG5cdFx0ZXhwb3J0czoge31cblx0fTtcblxuXHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cblx0X193ZWJwYWNrX21vZHVsZXNfX1ttb2R1bGVJZF0obW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cblx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcblx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xufVxuXG4iLCJfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSBcIlwiOyIsImV4cG9ydCBjbGFzcyBGb3JtVmFsaWRhdG9yIHtcclxuICBjb25zdHJ1Y3RvcihzZXR0aW5ncywgZm9ybSkge1xyXG4gICAgdGhpcy5fZm9ybVNlbGVjdG9yID0gc2V0dGluZ3MuZm9ybVNlbGVjdG9yO1xyXG4gICAgdGhpcy5faW5wdXRTZWxlY3RvciA9IHNldHRpbmdzLmlucHV0U2VsZWN0b3I7XHJcbiAgICB0aGlzLl9lcnJvckNsYXNzID0gc2V0dGluZ3MuZXJyb3JDbGFzcztcclxuICAgIHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MgPSBzZXR0aW5ncy5pbmFjdGl2ZUJ1dHRvbkNsYXNzO1xyXG4gICAgdGhpcy5faW5wdXRFcnJvckNsYXNzID0gc2V0dGluZ3MuaW5wdXRFcnJvckNsYXNzO1xyXG4gICAgdGhpcy5fc3VibWl0QnV0dG9uU2VsZWN0b3IgPSBzZXR0aW5ncy5zdWJtaXRCdXR0b25TZWxlY3RvcjtcclxuICAgIHRoaXMuX2Zvcm0gPSBmb3JtO1xyXG4gIH1cclxuICBfc2V0Rm9ybUxpc3RlbmVycygpIHtcclxuICAgIHRoaXMuX2lucHV0TGlzdCA9IEFycmF5LmZyb20oXHJcbiAgICAgIHRoaXMuX2Zvcm0ucXVlcnlTZWxlY3RvckFsbCh0aGlzLl9pbnB1dFNlbGVjdG9yKVxyXG4gICAgKTtcclxuICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQgPSB0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3IodGhpcy5fc3VibWl0QnV0dG9uU2VsZWN0b3IpO1xyXG4gICAgdGhpcy5fdG9nZ2xlQnV0dG9uU3RhdGUoKTtcclxuICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKChpbnB1dEVsZW1lbnQpID0+IHtcclxuICAgICAgaW5wdXRFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJpbnB1dFwiLCAoKSA9PiB7XHJcbiAgICAgICAgdGhpcy5fY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWxlbWVudCk7XHJcbiAgICAgICAgdGhpcy5fdG9nZ2xlQnV0dG9uU3RhdGUoKTtcclxuICAgICAgfSk7XHJcbiAgICB9KTtcclxuICB9XHJcbiAgX3Nob3dJbnB1dEVycm9yKGlucHV0RWxlbWVudCkge1xyXG4gICAgY29uc3QgZXJyb3JFbGVtZW50ID0gdGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yKGAuJHtpbnB1dEVsZW1lbnQuaWR9LWVycm9yYCk7XHJcbiAgICBpbnB1dEVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9pbnB1dEVycm9yQ2xhc3MpO1xyXG4gICAgZXJyb3JFbGVtZW50LnRleHRDb250ZW50ID0gaW5wdXRFbGVtZW50LnZhbGlkYXRpb25NZXNzYWdlO1xyXG4gICAgZXJyb3JFbGVtZW50LmNsYXNzTGlzdC5hZGQodGhpcy5fZXJyb3JDbGFzcyk7XHJcbiAgfVxyXG5cclxuICBfcmVtb3ZlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpIHtcclxuICAgIGNvbnN0IGVycm9yRWxlbWVudCA9IHRoaXMuX2Zvcm0ucXVlcnlTZWxlY3RvcihgLiR7aW5wdXRFbGVtZW50LmlkfS1lcnJvcmApO1xyXG4gICAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5wdXRFcnJvckNsYXNzKTtcclxuICAgIGVycm9yRWxlbWVudC50ZXh0Q29udGVudCA9IFwiXCI7XHJcbiAgICBlcnJvckVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9lcnJvckNsYXNzKTtcclxuICB9XHJcblxyXG4gIF9jaGVja0lucHV0VmFsaWRpdHkoaW5wdXRFbGVtZW50KSB7XHJcbiAgICBpZiAoaW5wdXRFbGVtZW50LnZhbGlkaXR5LnZhbGlkKSB7XHJcbiAgICAgIHRoaXMuX3JlbW92ZUlucHV0RXJyb3IoaW5wdXRFbGVtZW50KTtcclxuICAgIH0gZWxzZSB0aGlzLl9zaG93SW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpO1xyXG4gIH1cclxuXHJcbiAgcmVzZXRWYWxpZGF0aW9uKCkge1xyXG4gICAgdGhpcy5fdG9nZ2xlQnV0dG9uU3RhdGUoKTtcclxuICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKChpbnB1dEVsZW1lbnQpID0+IHtcclxuICAgICAgdGhpcy5fcmVtb3ZlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpO1xyXG4gICAgfSk7XHJcbiAgICBjb25zdCBidG5Gb3JtRWxtID0gdGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwLWJveF9fc3VibWl0LWJ1dHRvblwiKTtcclxuICAgIGJ0bkZvcm1FbG0uZGlzYWJsZWQgPSB0cnVlO1xyXG4gICAgYnRuRm9ybUVsbS5jbGFzc0xpc3QuYWRkKFwicG9wdXAtYm94X19zdWJtaXQtYnV0dG9uX2luYWN0aXZlXCIpO1xyXG4gICAgdGhpcy5fZm9ybS5yZXNldCgpO1xyXG4gIH1cclxuICBfdG9nZ2xlQnV0dG9uU3RhdGUoKSB7XHJcbiAgICBpZiAodGhpcy5faGFzSW52YWxpZElucHV0KCkpIHtcclxuICAgICAgdGhpcy5fYnV0dG9uRWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MpO1xyXG4gICAgICB0aGlzLl9idXR0b25FbGVtZW50LmRpc2FibGVkID0gdHJ1ZTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcclxuICAgICAgdGhpcy5fYnV0dG9uRWxlbWVudC5kaXNhYmxlZCA9IGZhbHNlO1xyXG4gICAgfVxyXG4gIH1cclxuICBfaGFzSW52YWxpZElucHV0KCkge1xyXG4gICAgcmV0dXJuIHRoaXMuX2lucHV0TGlzdC5zb21lKChpbnB1dCkgPT4ge1xyXG4gICAgICByZXR1cm4gIWlucHV0LnZhbGlkaXR5LnZhbGlkO1xyXG4gICAgfSk7XHJcbiAgfVxyXG4gIGVuYWJsZVZhbGlkYXRpb24oKSB7XHJcbiAgICB0aGlzLl9zZXRGb3JtTGlzdGVuZXJzKCk7XHJcbiAgICB0aGlzLl9mb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGUpID0+IGUucHJldmVudERlZmF1bHQoKSk7XHJcbiAgfVxyXG59XHJcbiIsImV4cG9ydCBjbGFzcyBDYXJkIHtcclxuICBjb25zdHJ1Y3RvcihkYXRhLCBoYW5kbGVJbWFnZUNsaWNrLCBjYXJkU2VsZWN0b3IpIHtcclxuICAgIGNvbnN0IHsgbmFtZSwgbGluayB9ID0gZGF0YTtcclxuICAgIHRoaXMuX25hbWUgPSBuYW1lO1xyXG4gICAgdGhpcy5fbGluayA9IGxpbms7XHJcbiAgICB0aGlzLl9oYW5kbGVJbWFnZUNsaWNrID0gaGFuZGxlSW1hZ2VDbGljaztcclxuICAgIHRoaXMuX2NhcmRTZWxlY3RvciA9IGNhcmRTZWxlY3RvcjtcclxuICB9XHJcbiAgX2dldFRlbXBsYXRlKCkge1xyXG4gICAgY29uc3QgcGxhY2VJdGVtVGVtcGxhdGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gICAgICB0aGlzLl9jYXJkU2VsZWN0b3JcclxuICAgICkuY29udGVudDtcclxuICAgIGNvbnN0IGNhcmRFbGVtZW50ID0gcGxhY2VJdGVtVGVtcGxhdGVcclxuICAgICAgLnF1ZXJ5U2VsZWN0b3IoXCIucGxhY2VzX19pdGVtXCIpXHJcbiAgICAgIC5jbG9uZU5vZGUodHJ1ZSk7XHJcblxyXG4gICAgcmV0dXJuIGNhcmRFbGVtZW50O1xyXG4gIH1cclxuICBfaGFuZGxlVG9nZ2xlTGlrZWRCdG4oZSkge1xyXG4gICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcclxuICAgIHRoaXMuX3BsYWNlTGlrZUJ0bi5jbGFzc0xpc3QudG9nZ2xlKFwicGxhY2VzX19saWtlLWJ0bl9fYWN0aXZlXCIpO1xyXG4gIH1cclxuICBfaGFuZGxlUmVtb3ZlSXRlbShlKSB7XHJcbiAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xyXG4gICAgdGhpcy5fY2FyZEl0ZW0ucmVtb3ZlKCk7XHJcbiAgICB0aGlzLl9jYXJkSXRlbSA9IG51bGw7XHJcbiAgfVxyXG5cclxuICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICBpZiAoXHJcbiAgICAgIHRoaXMuX25hbWUgPT09IFwiTG9hZGluZy4uLlwiICYmXHJcbiAgICAgIHRoaXMuX2xpbmsgPT09IFwiaW1hZ2VzL3NwaW5uZXJfc3ZnLmRjNDA4NjM4OGU1NTgyMGZiYWUxLnN2Z1wiXHJcbiAgICApXHJcbiAgICAgIHJldHVybjtcclxuICAgIHRoaXMuX2NhcmRJdGVtLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICAgIHRoaXMuX2hhbmRsZUltYWdlQ2xpY2sodGhpcy5fbmFtZSwgdGhpcy5fbGluayk7XHJcbiAgICB9KTtcclxuICAgIHRoaXMuX3BsYWNlTGlrZUJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGUpID0+IHtcclxuICAgICAgdGhpcy5faGFuZGxlVG9nZ2xlTGlrZWRCdG4oZSk7XHJcbiAgICB9KTtcclxuICAgIHRoaXMuX2NhcmRJdGVtXHJcbiAgICAgIC5xdWVyeVNlbGVjdG9yKFwiLnBsYWNlc19fcmVtb3ZlLWJ0blwiKVxyXG4gICAgICAuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChlKSA9PiB7XHJcbiAgICAgICAgdGhpcy5faGFuZGxlUmVtb3ZlSXRlbShlKTtcclxuICAgICAgfSk7XHJcbiAgfVxyXG5cclxuICBnZW5lcmF0ZUNhcmQoKSB7XHJcbiAgICB0aGlzLl9jYXJkSXRlbSA9IHRoaXMuX2dldFRlbXBsYXRlKCk7XHJcbiAgICB0aGlzLl9wbGFjZUltZyA9IHRoaXMuX2NhcmRJdGVtLnF1ZXJ5U2VsZWN0b3IoXCIucGxhY2VzX19pbWdcIik7XHJcbiAgICB0aGlzLl9wbGFjZUxpa2VCdG4gPSB0aGlzLl9jYXJkSXRlbS5xdWVyeVNlbGVjdG9yKFwiLnBsYWNlc19fbGlrZS1idG5cIik7XHJcbiAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xyXG4gICAgdGhpcy5fcGxhY2VJbWcuc3R5bGUuYmFja2dyb3VuZEltYWdlID0gYHVybCgke3RoaXMuX2xpbmt9KWA7XHJcbiAgICB0aGlzLl9wbGFjZUltZy5hbHQgPSBgYSBwaG90byBvZiAke3RoaXMuX25hbWV9YDtcclxuICAgIHRoaXMuX2NhcmRJdGVtLnF1ZXJ5U2VsZWN0b3IoXCIucGxhY2VzX19uYW1lXCIpLnRleHRDb250ZW50ID0gYCR7dGhpcy5fbmFtZX1gO1xyXG4gICAgcmV0dXJuIHRoaXMuX2NhcmRJdGVtO1xyXG4gIH1cclxufVxyXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cCB7XHJcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvcikge1xyXG4gICAgdGhpcy5fcG9wdXBFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihwb3B1cFNlbGVjdG9yKTtcclxuICB9XHJcblxyXG4gIF9oYW5kbGVFc2NDbG9zZSA9IChlKSA9PiB7XHJcbiAgICBpZiAoZS5rZXkgPT0gXCJFc2NhcGVcIikge1xyXG4gICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICB9XHJcbiAgfTtcclxuICBvcGVuKCkge1xyXG4gICAgdGhpcy5fcG9wdXBFbGVtZW50LmNsYXNzTGlzdC5hZGQoXCJwb3B1cC1ib3hfdmlzaWJsZVwiKTtcclxuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcclxuICB9XHJcblxyXG4gIGNsb3NlKCkge1xyXG4gICAgdGhpcy5fcG9wdXBFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoXCJwb3B1cC1ib3hfdmlzaWJsZVwiKTtcclxuICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcclxuICB9XHJcblxyXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgdGhpcy5fcG9wdXBFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZWRvd25cIiwgKGUpID0+IHtcclxuICAgICAgaWYgKFxyXG4gICAgICAgIGUudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhcInBvcHVwLWJveF92aXNpYmxlXCIpIHx8XHJcbiAgICAgICAgZS50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwicG9wdXAtYm94X19jbG9zZS1idXR0b25cIilcclxuICAgICAgKSB7XHJcbiAgICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICB9XHJcbn1cclxuIiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwLmpzXCI7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhGb3JtIGV4dGVuZHMgUG9wdXAge1xyXG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IsIGhhbmRsZVN1Ym1pdEZyb20pIHtcclxuICAgIHN1cGVyKHBvcHVwU2VsZWN0b3IpO1xyXG4gICAgdGhpcy5faGFuZGxlU3VibWl0RnJvbSA9IGhhbmRsZVN1Ym1pdEZyb207XHJcbiAgICB0aGlzLl9mb3JtRWxlbWVudCA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwLWJveF9fZm9ybVwiKTtcclxuICAgIHRoaXMuX2lucHV0TGlzdCA9IFtcclxuICAgICAgLi4udGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5wb3B1cC1ib3hfX2lucHV0XCIpLFxyXG4gICAgXTtcclxuICB9XHJcblxyXG4gIF9oYW5kbGVGb3JtU3VibWl0ID0gKGUpID0+IHtcclxuICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgIHRoaXMuX2hhbmRsZVN1Ym1pdEZyb20odGhpcy5fcmV0dXJuSW5wdXRWYWxPYmooKSk7XHJcbiAgICB0aGlzLmNsb3NlKCk7XHJcbiAgfTtcclxuXHJcbiAgX3JldHVybklucHV0VmFsT2JqKCkge1xyXG4gICAgY29uc3QgdmFsSW5wdXRPYmogPSB7fTtcclxuICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKChpdGVtKSA9PiB7XHJcbiAgICAgIHZhbElucHV0T2JqW2l0ZW0ubmFtZV0gPSBpdGVtLnZhbHVlO1xyXG4gICAgfSk7XHJcbiAgICByZXR1cm4gdmFsSW5wdXRPYmo7XHJcbiAgfVxyXG4gIG9wZW4oKSB7XHJcbiAgICBzdXBlci5vcGVuKCk7XHJcbiAgfVxyXG4gIGNsb3NlKCkge1xyXG4gICAgc3VwZXIuY2xvc2UoKTtcclxuICAgIHRoaXMuX2Zvcm1FbGVtZW50LnJlc2V0KCk7XHJcbiAgfVxyXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgdGhpcy5fZm9ybUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCB0aGlzLl9oYW5kbGVGb3JtU3VibWl0KTtcclxuICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgfVxyXG59XHJcbiIsImNvbnN0IGluaXRpYWxDYXJkcyA9IFtcclxuICB7XHJcbiAgICBuYW1lOiBcIllvc2VtaXRlIFZhbGxleVwiLFxyXG4gICAgbGluazogXCJodHRwczovL2NvZGUuczMueWFuZGV4Lm5ldC93ZWItY29kZS95b3NlbWl0ZS5qcGdcIixcclxuICB9LFxyXG4gIHtcclxuICAgIG5hbWU6IFwiTGFrZSBMb3Vpc2VcIixcclxuICAgIGxpbms6IFwiaHR0cHM6Ly9jb2RlLnMzLnlhbmRleC5uZXQvd2ViLWNvZGUvbGFrZS1sb3Vpc2UuanBnXCIsXHJcbiAgfSxcclxuICB7XHJcbiAgICBuYW1lOiBcIkJhbGQgTW91bnRhaW5zXCIsXHJcbiAgICBsaW5rOiBcImh0dHBzOi8vY29kZS5zMy55YW5kZXgubmV0L3dlYi1jb2RlL2JhbGQtbW91bnRhaW5zLmpwZ1wiLFxyXG4gIH0sXHJcbiAge1xyXG4gICAgbmFtZTogXCJMYXRlbWFyXCIsXHJcbiAgICBsaW5rOiBcImh0dHBzOi8vY29kZS5zMy55YW5kZXgubmV0L3dlYi1jb2RlL2xhdGVtYXIuanBnXCIsXHJcbiAgfSxcclxuICB7XHJcbiAgICBuYW1lOiBcIlZhbm9pc2UgTmF0aW9uYWwgUGFya1wiLFxyXG4gICAgbGluazogXCJodHRwczovL2NvZGUuczMueWFuZGV4Lm5ldC93ZWItY29kZS92YW5vaXNlLmpwZ1wiLFxyXG4gIH0sXHJcbiAge1xyXG4gICAgbmFtZTogXCJMYWdvIGRpIEJyYWllc1wiLFxyXG4gICAgbGluazogXCJodHRwczovL2NvZGUuczMueWFuZGV4Lm5ldC93ZWItY29kZS9sYWdvLmpwZ1wiLFxyXG4gIH0sXHJcbiAge1xyXG4gICAgbmFtZTogXCJCZWVyc2hlYmEgVHVya2lzaCByYWlsd2F5IHN0YXRpb25cIixcclxuICAgIGxpbms6IFwiaHR0cHM6Ly91cGxvYWQud2lraW1lZGlhLm9yZy93aWtpcGVkaWEvY29tbW9ucy90aHVtYi9kL2RlLyVENyU5RSVENyVBQSVENyU5NyVENyU5RF8lRDclQUElRDclOTclRDclQTAlRDclQUFfJUQ3JTk0JUQ3JUE4JUQ3JTlCJUQ3JTkxJUQ3JUFBXyVENyU5NCVENyU5OCVENyU5NSVENyVBOCVENyVBNyVENyU5OSVENyVBQV8lRDclOTElRDclOTElRDclOTAlRDclQThfJUQ3JUE5JUQ3JTkxJUQ3JUEyLmpwZy8xMjgwcHgtJUQ3JTlFJUQ3JUFBJUQ3JTk3JUQ3JTlEXyVENyVBQSVENyU5NyVENyVBMCVENyVBQV8lRDclOTQlRDclQTglRDclOUIlRDclOTElRDclQUFfJUQ3JTk0JUQ3JTk4JUQ3JTk1JUQ3JUE4JUQ3JUE3JUQ3JTk5JUQ3JUFBXyVENyU5MSVENyU5MSVENyU5MCVENyVBOF8lRDclQTklRDclOTElRDclQTIuanBnXCIsXHJcbiAgfSxcclxuICBcclxuXTtcclxuY29uc3QgZm9ybVZhbGlkYXRvcnMgPSB7fTtcclxuXHJcbmNvbnN0IG9wZW5FZGl0VXNlclBvcHVwQnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19lZGl0LWJ0blwiKTtcclxuY29uc3Qgb3BlbkFkZFBsYWNlc1BvcHVwQnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19hZGQtYnRuXCIpO1xyXG5cclxuY29uc3QgbmFtZUlucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignaW5wdXRbbmFtZT1cIm5hbWVfaW5wdXRcIl0nKTtcclxuY29uc3QgYWJvdXRNZUlucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignaW5wdXRbbmFtZT1cImFib3V0X21lXCJdJyk7XHJcblxyXG5leHBvcnQge1xyXG4gIGFib3V0TWVJbnB1dCxcclxuICBuYW1lSW5wdXQsXHJcbiAgaW5pdGlhbENhcmRzLFxyXG4gIG9wZW5FZGl0VXNlclBvcHVwQnRuLFxyXG4gIG9wZW5BZGRQbGFjZXNQb3B1cEJ0bixcclxuICBmb3JtVmFsaWRhdG9ycyxcclxufTtcclxuIiwiaW1wb3J0IFwiLi9pbmRleC5jc3NcIjtcclxuaW1wb3J0IHsgYXBpQ29uZmluZyB9IGZyb20gXCIuLi8uLi9jb25maWcuanNcIjtcclxuaW1wb3J0IHsgRm9ybVZhbGlkYXRvciB9IGZyb20gXCIuLi9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanNcIjtcclxuaW1wb3J0IHsgQ2FyZCB9IGZyb20gXCIuLi9jb21wb25lbnRzL0NhcmQuanNcIjtcclxuaW1wb3J0IFNlY3Rpb24gZnJvbSBcIi4uL2NvbXBvbmVudHMvU2VjdGlvbi5qc1wiO1xyXG5pbXBvcnQgUG9wdXBXaXRoRm9ybSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzXCI7XHJcbmltcG9ydCBQb3B1cFdpdGhJbWFnZSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qc1wiO1xyXG5pbXBvcnQgVXNlckluZm8gZnJvbSBcIi4uL2NvbXBvbmVudHMvVXNlckluZm8uanNcIjtcclxuaW1wb3J0IEFwaSBmcm9tIFwiLi4vdXRpbHMvQXBpLmpzXCI7XHJcbmltcG9ydCBzcGlubmVyR2lmIGZyb20gXCIuLi9pbWFnZXMvcHJvZmlsZS9zcGlubmVyX3N2Zy5zdmdcIjtcclxuXHJcbmltcG9ydCB7XHJcbiAgYWJvdXRNZUlucHV0LFxyXG4gIG5hbWVJbnB1dCxcclxuICBpbml0aWFsQ2FyZHMsXHJcbiAgb3BlbkVkaXRVc2VyUG9wdXBCdG4sXHJcbiAgb3BlbkFkZFBsYWNlc1BvcHVwQnRuLFxyXG4gIGZvcm1WYWxpZGF0b3JzLFxyXG59IGZyb20gXCIuLi91dGlscy9jb25zdGFudHMuanNcIjtcclxuZnVuY3Rpb24gY3JlYXRlUGxhY2VJdGVtKGl0ZW0pIHtcclxuICBjb25zdCBuZXdDYXJkID0gbmV3IENhcmQoaXRlbSwgb3BlbkltZ1BvcHVwLCBcIiNwbGFjZXMtaXRlbS10ZW1wbGF0ZVwiKTtcclxuICByZXR1cm4gbmV3Q2FyZC5nZW5lcmF0ZUNhcmQoKTtcclxufVxyXG5cclxuZnVuY3Rpb24gZW5hYmxlVmFsaWRhdGlvbihzZXR0aW5ncykge1xyXG4gIGNvbnN0IGZvcm1JdGVtcyA9IEFycmF5LmZyb20oXHJcbiAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKHNldHRpbmdzLmZvcm1TZWxlY3RvcilcclxuICApO1xyXG5cclxuICBmb3JtSXRlbXMuZm9yRWFjaCgoZm9ybSkgPT4ge1xyXG4gICAgY29uc3QgbmV3VmFpbGQgPSBuZXcgRm9ybVZhbGlkYXRvcihzZXR0aW5ncywgZm9ybSk7XHJcbiAgICBjb25zdCBmb3JtTmFtZSA9IGZvcm0ubmFtZTtcclxuICAgIGZvcm1WYWxpZGF0b3JzW2Zvcm1OYW1lXSA9IG5ld1ZhaWxkO1xyXG4gICAgbmV3VmFpbGQuZW5hYmxlVmFsaWRhdGlvbigpO1xyXG4gIH0pO1xyXG59XHJcblxyXG5mdW5jdGlvbiBvcGVuQWRkUHJvZmlsZVBvcHVwKCkge1xyXG4gIGZvcm1WYWxpZGF0b3JzW1wiZm9ybV9hZGQtcGxhY2VcIl0ucmVzZXRWYWxpZGF0aW9uKCk7XHJcbiAgQWRkUG9wdXAub3BlbigpO1xyXG59XHJcbmZ1bmN0aW9uIG9wZW5FZGl0UHJvZmlsZVBvcHVwKCkge1xyXG4gIGZvcm1WYWxpZGF0b3JzW1wiZm9ybV9wcm9maWxlLWVkaXRcIl0ucmVzZXRWYWxpZGF0aW9uKCk7XHJcbiAgRWRpdFBvcHVwLm9wZW4oKTtcclxuICBjb25zdCB7IG5hbWVJbmZvLCBhYm91dE1lSW5mbyB9ID0gcHJvZmlsZVVzZXIuZ2V0VXNlckluZm8oKTtcclxuICBuYW1lSW5wdXQudmFsdWUgPSBuYW1lSW5mbztcclxuICBhYm91dE1lSW5wdXQudmFsdWUgPSBhYm91dE1lSW5mbztcclxufVxyXG5mdW5jdGlvbiBvcGVuSW1nUG9wdXAodGl0bGUsIGxpbmspIHtcclxuICBuZXdJbWdQb3B1cC5vcGVuKHRpdGxlLCBsaW5rKTtcclxufVxyXG5mdW5jdGlvbiBoYW5kbGVTdWJtaXRBZGRJdGVtKHsgdGl0bGVfcGxhY2U6IG5hbWUsIGltZ19saW5rOiBsaW5rIH0pIHtcclxuICBjYXJkc0xpc3QuYWRkSXRlbShjcmVhdGVQbGFjZUl0ZW0oeyBuYW1lLCBsaW5rIH0pKTtcclxufVxyXG5mdW5jdGlvbiBoYW5kbGVTdWJtaXRFZGl0UHJvZmlsZSh7IG5hbWVfaW5wdXQsIGFib3V0X21lIH0pIHtcclxuICBmb3JtVmFsaWRhdG9yc1tcImZvcm1fYWRkLXBsYWNlXCJdLnJlc2V0VmFsaWRhdGlvbigpO1xyXG4gIGFwaS5zZXRVc2VySW5mbyh7IG5hbWU6IG5hbWVfaW5wdXQsIGFib3V0OiBhYm91dF9tZSB9KS50aGVuKChyZXMpID0+IHtcclxuICAgIHByb2ZpbGVVc2VyLnNldFVzZXJJbmZvKHJlcyk7XHJcbiAgICAvLyBwcm9maWxlVXNlci5zZXRVc2VySW5mbygpXHJcbiAgfSk7XHJcbiAgLy8gcHJvZmlsZVVzZXIuc2V0VXNlckluZm8obmFtZV9pbnB1dCwgYWJvdXRfbWUpO1xyXG59XHJcbmZ1bmN0aW9uIHNldExvYWRpbmdJbml0KHN0YXR1cywgY2FyZEl0ZW1zQXJyLCB1c2VySW5mbykge1xyXG4gIGlmIChzdGF0dXMpIHtcclxuICAgIHByb2ZpbGVVc2VyLnNldFVzZXJJbmZvKHtcclxuICAgICAgbmFtZTogXCJMb2FkaW5nLi4uXCIsXHJcbiAgICAgIGFib3V0OiBcIkxvYWRpbmcuLi5cIixcclxuICAgICAgX2lkOiBudWxsLFxyXG4gICAgfSk7XHJcbiAgICBwcm9maWxlVXNlci5zZXRQaWN0dXJlUHJvZmlsZShzcGlubmVyR2lmKTtcclxuICAgIGNhcmRzTGlzdC5zZXROZXdJdGVtbGlzdChbeyBuYW1lOiBcIkxvYWRpbmcuLi5cIiwgbGluazogc3Bpbm5lckdpZiB9XSk7XHJcbiAgfSBlbHNlIHtcclxuICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wbGFjZXNfX2dyaWQtY29udGFpbmVyJykuaW5uZXJIVE1MID0nJ1xyXG4gICAgcHJvZmlsZVVzZXIuc2V0VXNlckluZm8oe1xyXG4gICAgICBuYW1lOiB1c2VySW5mby5uYW1lLFxyXG4gICAgICBhYm91dDogdXNlckluZm8uYWJvdXQsXHJcbiAgICAgIF9pZDogdXNlckluZm8uX2lkLFxyXG4gICAgfSk7XHJcbiAgICBwcm9maWxlVXNlci5zZXRQaWN0dXJlUHJvZmlsZSh1c2VySW5mby5hdmF0YXIpO1xyXG4gICAgY2FyZHNMaXN0LnNldE5ld0l0ZW1saXN0KGNhcmRJdGVtc0Fycik7XHJcbiAgfVxyXG59XHJcbmZ1bmN0aW9uIG9uSW5pdCgpIHtcclxuICBzZXRMb2FkaW5nSW5pdCh0cnVlKTtcclxuICBhcGlcclxuICAgIC5nZXRJbml0SW5mbygpXHJcbiAgICAudGhlbigoW2NhcmRJdGVtc0FyciwgdXNlckluZm9dKSA9PiB7XHJcbiAgICAgIHNldExvYWRpbmdJbml0KGZhbHNlLCBjYXJkSXRlbXNBcnIsIHVzZXJJbmZvKTtcclxuICAgICAgb3BlbkVkaXRVc2VyUG9wdXBCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIG9wZW5FZGl0UHJvZmlsZVBvcHVwKTtcclxuICAgICAgb3BlbkFkZFBsYWNlc1BvcHVwQnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBvcGVuQWRkUHJvZmlsZVBvcHVwKTtcclxuICAgICAgZW5hYmxlVmFsaWRhdGlvbih7XHJcbiAgICAgICAgZm9ybVNlbGVjdG9yOiBcIi5wb3B1cC1ib3hfX2Zvcm1cIixcclxuICAgICAgICBpbnB1dFNlbGVjdG9yOiBcIi5wb3B1cC1ib3hfX2lucHV0XCIsXHJcbiAgICAgICAgc3VibWl0QnV0dG9uU2VsZWN0b3I6IFwiLnBvcHVwLWJveF9fc3VibWl0LWJ1dHRvblwiLFxyXG4gICAgICAgIGluYWN0aXZlQnV0dG9uQ2xhc3M6IFwicG9wdXAtYm94X19zdWJtaXQtYnV0dG9uX2luYWN0aXZlXCIsXHJcbiAgICAgICAgaW5wdXRFcnJvckNsYXNzOiBcIi5wb3B1cC1ib3hfX2lucHV0X3R5cGVfZXJyb3JcIixcclxuICAgICAgICBlcnJvckNsYXNzOiBcIi5wb3B1cC1ib3hfX2lucHV0LWVycm9yX2FjdGl2ZVwiLFxyXG4gICAgICB9KTtcclxuICAgICAgc2V0UG9wdXBFdmVudCgpO1xyXG4gICAgIFxyXG4gICAgfSlcclxuICAgIC5jYXRjaCgoZXJyKSA9PiB7XHJcbiAgICAgIGNvbnNvbGUubG9nKGVycik7XHJcbiAgICB9KTtcclxufVxyXG5mdW5jdGlvbiBzZXRQb3B1cEV2ZW50KCkge1xyXG4gIEVkaXRQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xyXG4gIEFkZFBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgbmV3SW1nUG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxufVxyXG5mdW5jdGlvbiByZW5kZXJDYXJkKGl0ZW0pIHtcclxuICBjYXJkc0xpc3QuYWRkSXRlbShjcmVhdGVQbGFjZUl0ZW0oaXRlbSkpO1xyXG59XHJcblxyXG5jb25zdCBjYXJkc0xpc3QgPSBuZXcgU2VjdGlvbihyZW5kZXJDYXJkLCBcIi5wbGFjZXNfX2dyaWQtY29udGFpbmVyXCIpO1xyXG5jb25zdCBFZGl0UG9wdXAgPSBuZXcgUG9wdXBXaXRoRm9ybShcclxuICBcIi5wb3B1cC1ib3hfdHlwZV9wcm9maWxlLWVkaXRcIixcclxuICBoYW5kbGVTdWJtaXRFZGl0UHJvZmlsZVxyXG4pO1xyXG5jb25zdCBBZGRQb3B1cCA9IG5ldyBQb3B1cFdpdGhGb3JtKFxyXG4gIFwiLnBvcHVwLWJveF90eXBlX2FkZC1pdGVtXCIsXHJcbiAgaGFuZGxlU3VibWl0QWRkSXRlbVxyXG4pO1xyXG5jb25zdCBuZXdJbWdQb3B1cCA9IG5ldyBQb3B1cFdpdGhJbWFnZSh7XHJcbiAgcG9wdXBTZWxlY3RvcjogXCIucG9wdXAtYm94X3R5cGVfaW1nXCIsXHJcbiAgaW1nU2VsZWN0b3I6IFwiLnBvcHVwLWJveF9faW1nXCIsXHJcbiAgaW1nVGl0bGVTZWxlY3RvcjogXCIucG9wdXAtYm94X19pbWctdGl0bGVcIixcclxufSk7XHJcbmNvbnN0IHByb2ZpbGVVc2VyID0gbmV3IFVzZXJJbmZvKHtcclxuICBuYW1lRWxtOiBcIi5wcm9maWxlX19uYW1lXCIsXHJcbiAgam9iRWxtOiBcIi5wcm9maWxlX19hYm91dC1tZVwiLFxyXG4gIHBpY0VsbTogXCIucHJvZmlsZV9fYXZhdGFyXCIsXHJcbn0pO1xyXG5jb25zdCBhcGkgPSBuZXcgQXBpKGFwaUNvbmZpbmcpO1xyXG5cclxub25Jbml0KCk7XHJcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFNlY3Rpb24ge1xyXG4gIGNvbnN0cnVjdG9yKHJlbmRlcmVyLCBjb250YWluZXJTZWxlY3Rvcikge1xyXG4gICAgdGhpcy5fcmVuZGVyZXIgPSByZW5kZXJlcjtcclxuICAgIHRoaXMuX2NvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoY29udGFpbmVyU2VsZWN0b3IpO1xyXG4gIH1cclxuXHJcbiAgcmVuZGVySXRlbXMoKSB7XHJcbiAgICB0aGlzLl9pdGVtcy5mb3JFYWNoKChpdGVtKSA9PiB0aGlzLl9yZW5kZXJlcihpdGVtKSk7XHJcbiAgfVxyXG5cclxuICBhZGRJdGVtKGVsKSB7XHJcbiAgICB0aGlzLl9jb250YWluZXIucHJlcGVuZChlbCk7XHJcbiAgfVxyXG4gIHNldE5ld0l0ZW1saXN0KGl0ZW1zKSB7XHJcbiAgICB0aGlzLl9pdGVtcyA9IGl0ZW1zO1xyXG4gICAgdGhpcy5yZW5kZXJJdGVtcygpO1xyXG4gIH1cclxufVxyXG4iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXAuanNcIjtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwV2l0aEltYWdlIGV4dGVuZHMgUG9wdXAge1xyXG4gIGNvbnN0cnVjdG9yKHsgcG9wdXBTZWxlY3RvciwgaW1nU2VsZWN0b3IsIGltZ1RpdGxlU2VsZWN0b3IgfSkge1xyXG4gICAgc3VwZXIocG9wdXBTZWxlY3Rvcik7XHJcbiAgICB0aGlzLl9pbWdFbGVtZW50ID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoaW1nU2VsZWN0b3IpO1xyXG4gICAgdGhpcy5fdGl0bGVFbGVtZW50ID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoaW1nVGl0bGVTZWxlY3Rvcik7XHJcbiAgfVxyXG5cclxuICBfc2V0UG9wdXBJbWcoKSB7XHJcbiAgICB0aGlzLl90aXRsZUVsZW1lbnQudGV4dENvbnRlbnQgPSB0aGlzLnRpdGxlO1xyXG4gICAgdGhpcy5faW1nRWxlbWVudC5zcmMgPSB0aGlzLl9saW5rO1xyXG4gICAgdGhpcy5faW1nRWxlbWVudC5hbHQgPSBgYSBwaWN0cnVlIG9mICR7dGhpcy50aXRsZX1gO1xyXG4gIH1cclxuXHJcbiAgb3Blbih0aXRsZSwgbGluaykge1xyXG4gICAgdGhpcy50aXRsZSA9IHRpdGxlO1xyXG4gICAgdGhpcy5fbGluayA9IGxpbms7XHJcbiAgICB0aGlzLl9zZXRQb3B1cEltZygpO1xyXG4gICAgc3VwZXIub3BlbigpO1xyXG4gIH1cclxufVxyXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBVc2VySW5mbyB7XHJcbiAgY29uc3RydWN0b3IoeyBuYW1lRWxtLCBqb2JFbG0sIHBpY0VsbSB9KSB7XHJcbiAgICB0aGlzLl9uYW1lRWxtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihuYW1lRWxtKTtcclxuICAgIHRoaXMuX2pvYkVsbSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3Ioam9iRWxtKTtcclxuICAgIHRoaXMuX3BpY0VsbSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IocGljRWxtKTtcclxuICAgIHBpY0VsbTtcclxuICB9XHJcblxyXG4gIHNldFVzZXJJbmZvKHsgbmFtZSwgYWJvdXQsIF9pZCB9KSB7XHJcbiAgICB0aGlzLl9uYW1lRWxtLnRleHRDb250ZW50ID0gbmFtZTtcclxuICAgIHRoaXMuX2pvYkVsbS50ZXh0Q29udGVudCA9IGFib3V0O1xyXG4gICAgdGhpcy5fdXNlcklkID0gX2lkO1xyXG4gIH1cclxuICBnZXRVc2VySW5mbygpIHtcclxuICAgIHJldHVybiB7XHJcbiAgICAgIG5hbWVJbmZvOiB0aGlzLl9uYW1lRWxtLnRleHRDb250ZW50LFxyXG4gICAgICBhYm91dE1lSW5mbzogdGhpcy5fam9iRWxtLnRleHRDb250ZW50LFxyXG4gICAgfTtcclxuICB9XHJcbiAgc2V0UGljdHVyZVByb2ZpbGUocGljU3JjKSB7XHJcbiAgICB0aGlzLl9waWNFbG0uc3JjID0gcGljU3JjO1xyXG4gIH1cclxufVxyXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBBcGkge1xyXG4gIGNvbnN0cnVjdG9yKHsgYmFzZVVybCwgaGVhZGVycyB9KSB7XHJcbiAgICB0aGlzLmhlYWRlcnMgPSBoZWFkZXJzO1xyXG4gICAgdGhpcy5iYXNlVXJsID0gYmFzZVVybDtcclxuICB9XHJcbiAgX29uSHR0cFJlcXVlc3QodXJsLCBtZXRob2QsIGRhdGEpIHtcclxuICAgIGNvbnN0IGZ1bGxVcmwgPSBgJHt0aGlzLmJhc2VVcmx9JHt1cmx9YDtcclxuICAgIHJldHVybiBmZXRjaChmdWxsVXJsLCB7XHJcbiAgICAgIG1ldGhvZCxcclxuICAgICAgaGVhZGVyczogdGhpcy5oZWFkZXJzLFxyXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeShkYXRhKSxcclxuICAgIH0pLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICBpZiAocmVzLm9rKSB7XHJcbiAgICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICB9XHJcbiAgZ2V0SW5pdEluZm8oKSB7XHJcbiAgICByZXR1cm4gUHJvbWlzZS5hbGwoW3RoaXMuX2dldEluaXRpYWxDYXJkcygpLCB0aGlzLl9nZXRVc2VySW5mbygpXSk7XHJcbiAgfVxyXG4gIF9nZXRVc2VySW5mbygpIHtcclxuICAgIHJldHVybiB0aGlzLl9vbkh0dHBSZXF1ZXN0KFwidXNlcnMvbWVcIiwgXCJHRVRcIik7XHJcbiAgfVxyXG4gIF9nZXRJbml0aWFsQ2FyZHMoKSB7XHJcbiAgICByZXR1cm4gdGhpcy5fb25IdHRwUmVxdWVzdChcImNhcmRzXCIsIFwiR0VUXCIpO1xyXG4gIH1cclxuIFxyXG4gIHNldFVzZXJJbmZvKHtuYW1lLGFib3V0fSkge1xyXG4gICAgcmV0dXJuIHRoaXMuX29uSHR0cFJlcXVlc3QoXCJ1c2Vycy9tZVwiLCBcIlBBVENIXCIse25hbWUsYWJvdXR9KTtcclxuICB9XHJcbiAgYWRkTmV3Q2FyZCh7bmFtZSxsaW5rfSkge1xyXG4gICAgcmV0dXJuIHRoaXMuX29uSHR0cFJlcXVlc3QoJ2NhcmRzJywncG9zdCcse25hbWUsbGlua30pXHJcbiAgfVxyXG59XHJcbiIsImNvbnN0IGFwaUNvbmZpbmcgPSB7XHJcbiAgYmFzZVVybDogXCJodHRwczovL2Fyb3VuZC5ub21vcmVwYXJ0aWVzLmNvL3YxL2dyb3VwLTEyL1wiLFxyXG4gIGhlYWRlcnM6IHtcclxuICBhdXRob3JpemF0aW9uOiBcIjAzNWEzZTgwLTBkM2YtNDIxYi1iNGZhLTdmNDA2ZTQ5YWQ1ZlwiLFxyXG4gICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCJcclxuICB9XHJcbn07XHJcbmV4cG9ydCB7IGFwaUNvbmZpbmcgfTtcclxuIl0sIm5hbWVzIjpbIl9fd2VicGFja19tb2R1bGVfY2FjaGVfXyIsIl9fd2VicGFja19yZXF1aXJlX18iLCJtb2R1bGVJZCIsImNhY2hlZE1vZHVsZSIsInVuZGVmaW5lZCIsImV4cG9ydHMiLCJtb2R1bGUiLCJfX3dlYnBhY2tfbW9kdWxlc19fIiwicCIsIkZvcm1WYWxpZGF0b3IiLCJjb25zdHJ1Y3RvciIsInNldHRpbmdzIiwiZm9ybSIsInRoaXMiLCJfZm9ybVNlbGVjdG9yIiwiZm9ybVNlbGVjdG9yIiwiX2lucHV0U2VsZWN0b3IiLCJpbnB1dFNlbGVjdG9yIiwiX2Vycm9yQ2xhc3MiLCJlcnJvckNsYXNzIiwiX2luYWN0aXZlQnV0dG9uQ2xhc3MiLCJpbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiX2lucHV0RXJyb3JDbGFzcyIsImlucHV0RXJyb3JDbGFzcyIsIl9zdWJtaXRCdXR0b25TZWxlY3RvciIsInN1Ym1pdEJ1dHRvblNlbGVjdG9yIiwiX2Zvcm0iLCJfc2V0Rm9ybUxpc3RlbmVycyIsIl9pbnB1dExpc3QiLCJBcnJheSIsImZyb20iLCJxdWVyeVNlbGVjdG9yQWxsIiwiX2J1dHRvbkVsZW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiX3RvZ2dsZUJ1dHRvblN0YXRlIiwiZm9yRWFjaCIsImlucHV0RWxlbWVudCIsImFkZEV2ZW50TGlzdGVuZXIiLCJfY2hlY2tJbnB1dFZhbGlkaXR5IiwiX3Nob3dJbnB1dEVycm9yIiwiZXJyb3JFbGVtZW50IiwiaWQiLCJjbGFzc0xpc3QiLCJhZGQiLCJ0ZXh0Q29udGVudCIsInZhbGlkYXRpb25NZXNzYWdlIiwiX3JlbW92ZUlucHV0RXJyb3IiLCJyZW1vdmUiLCJ2YWxpZGl0eSIsInZhbGlkIiwicmVzZXRWYWxpZGF0aW9uIiwiYnRuRm9ybUVsbSIsImRpc2FibGVkIiwicmVzZXQiLCJfaGFzSW52YWxpZElucHV0Iiwic29tZSIsImlucHV0IiwiZW5hYmxlVmFsaWRhdGlvbiIsImUiLCJwcmV2ZW50RGVmYXVsdCIsIkNhcmQiLCJkYXRhIiwiaGFuZGxlSW1hZ2VDbGljayIsImNhcmRTZWxlY3RvciIsIm5hbWUiLCJsaW5rIiwiX25hbWUiLCJfbGluayIsIl9oYW5kbGVJbWFnZUNsaWNrIiwiX2NhcmRTZWxlY3RvciIsIl9nZXRUZW1wbGF0ZSIsImRvY3VtZW50IiwiY29udGVudCIsImNsb25lTm9kZSIsIl9oYW5kbGVUb2dnbGVMaWtlZEJ0biIsInN0b3BQcm9wYWdhdGlvbiIsIl9wbGFjZUxpa2VCdG4iLCJ0b2dnbGUiLCJfaGFuZGxlUmVtb3ZlSXRlbSIsIl9jYXJkSXRlbSIsIl9zZXRFdmVudExpc3RlbmVycyIsImdlbmVyYXRlQ2FyZCIsIl9wbGFjZUltZyIsInN0eWxlIiwiYmFja2dyb3VuZEltYWdlIiwiYWx0IiwiUG9wdXAiLCJwb3B1cFNlbGVjdG9yIiwia2V5IiwiY2xvc2UiLCJfcG9wdXBFbGVtZW50Iiwib3BlbiIsIl9oYW5kbGVFc2NDbG9zZSIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJzZXRFdmVudExpc3RlbmVycyIsInRhcmdldCIsImNvbnRhaW5zIiwiUG9wdXBXaXRoRm9ybSIsImhhbmRsZVN1Ym1pdEZyb20iLCJzdXBlciIsIl9oYW5kbGVTdWJtaXRGcm9tIiwiX3JldHVybklucHV0VmFsT2JqIiwiX2Zvcm1FbGVtZW50IiwidmFsSW5wdXRPYmoiLCJpdGVtIiwidmFsdWUiLCJfaGFuZGxlRm9ybVN1Ym1pdCIsImZvcm1WYWxpZGF0b3JzIiwib3BlbkVkaXRVc2VyUG9wdXBCdG4iLCJvcGVuQWRkUGxhY2VzUG9wdXBCdG4iLCJuYW1lSW5wdXQiLCJhYm91dE1lSW5wdXQiLCJjcmVhdGVQbGFjZUl0ZW0iLCJvcGVuSW1nUG9wdXAiLCJvcGVuQWRkUHJvZmlsZVBvcHVwIiwiQWRkUG9wdXAiLCJvcGVuRWRpdFByb2ZpbGVQb3B1cCIsIkVkaXRQb3B1cCIsIm5hbWVJbmZvIiwiYWJvdXRNZUluZm8iLCJwcm9maWxlVXNlciIsImdldFVzZXJJbmZvIiwidGl0bGUiLCJuZXdJbWdQb3B1cCIsInNldExvYWRpbmdJbml0Iiwic3RhdHVzIiwiY2FyZEl0ZW1zQXJyIiwidXNlckluZm8iLCJzZXRVc2VySW5mbyIsImFib3V0IiwiX2lkIiwic2V0UGljdHVyZVByb2ZpbGUiLCJzcGlubmVyR2lmIiwiY2FyZHNMaXN0Iiwic2V0TmV3SXRlbWxpc3QiLCJpbm5lckhUTUwiLCJhdmF0YXIiLCJyZW5kZXJlciIsImNvbnRhaW5lclNlbGVjdG9yIiwiX3JlbmRlcmVyIiwiX2NvbnRhaW5lciIsInJlbmRlckl0ZW1zIiwiX2l0ZW1zIiwiYWRkSXRlbSIsImVsIiwicHJlcGVuZCIsIml0ZW1zIiwibmFtZV9pbnB1dCIsImFib3V0X21lIiwiYXBpIiwidGhlbiIsInJlcyIsInRpdGxlX3BsYWNlIiwiaW1nX2xpbmsiLCJpbWdTZWxlY3RvciIsImltZ1RpdGxlU2VsZWN0b3IiLCJfaW1nRWxlbWVudCIsIl90aXRsZUVsZW1lbnQiLCJfc2V0UG9wdXBJbWciLCJzcmMiLCJuYW1lRWxtIiwiam9iRWxtIiwicGljRWxtIiwiX25hbWVFbG0iLCJfam9iRWxtIiwiX3BpY0VsbSIsIl91c2VySWQiLCJwaWNTcmMiLCJiYXNlVXJsIiwiaGVhZGVycyIsIl9vbkh0dHBSZXF1ZXN0IiwidXJsIiwibWV0aG9kIiwiZnVsbFVybCIsImZldGNoIiwiYm9keSIsIkpTT04iLCJzdHJpbmdpZnkiLCJvayIsImpzb24iLCJQcm9taXNlIiwicmVqZWN0IiwiZ2V0SW5pdEluZm8iLCJhbGwiLCJfZ2V0SW5pdGlhbENhcmRzIiwiX2dldFVzZXJJbmZvIiwiYWRkTmV3Q2FyZCIsImF1dGhvcml6YXRpb24iLCJuZXdWYWlsZCIsImZvcm1OYW1lIiwiY2F0Y2giLCJlcnIiLCJjb25zb2xlIiwibG9nIl0sInNvdXJjZVJvb3QiOiIifQ==