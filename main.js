!function(){"use strict";var e={855:function(e,t,s){e.exports=s.p+"images/spinner_svg.dc4086388e55820fbae1.svg"}},t={};function s(i){var n=t[i];if(void 0!==n)return n.exports;var o=t[i]={exports:{}};return e[i](o,o.exports,s),o.exports}s.p="",function(){class e{constructor(e,t){this._formSelector=e.formSelector,this._inputSelector=e.inputSelector,this._errorClass=e.errorClass,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._submitButtonSelector=e.submitButtonSelector,this._form=t}_setFormListeners(){this._inputList=Array.from(this._form.querySelectorAll(this._inputSelector)),this._buttonElement=this._form.querySelector(this._submitButtonSelector),this._toggleButtonState(),this._inputList.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this._toggleButtonState()}))}))}_showInputError(e){const t=this._form.querySelector(".".concat(e.id,"-error"));e.classList.add(this._inputErrorClass),t.textContent=e.validationMessage,t.classList.add(this._errorClass)}_removeInputError(e){const t=this._form.querySelector(".".concat(e.id,"-error"));e.classList.remove(this._inputErrorClass),t.textContent="",t.classList.remove(this._errorClass)}_checkInputValidity(e){e.validity.valid?this._removeInputError(e):this._showInputError(e)}resetValidation(){this._toggleButtonState(),this._inputList.forEach((e=>{this._removeInputError(e)}));const e=this._form.querySelector(".popup-box__submit-button");e.disabled=!0,e.classList.add("popup-box__submit-button_inactive"),this._form.reset()}_toggleButtonState(){this._hasInvalidInput()?(this._buttonElement.classList.add(this._inactiveButtonClass),this._buttonElement.disabled=!0):(this._buttonElement.classList.remove(this._inactiveButtonClass),this._buttonElement.disabled=!1)}_hasInvalidInput(){return this._inputList.some((e=>!e.validity.valid))}enableValidation(){this._setFormListeners(),this._form.addEventListener("submit",(e=>e.preventDefault()))}}function t(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:i(),t="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghiklmnopqrstuvwxyz".split("");e||(e=Math.floor(Math.random()*t.length));let s="";for(let i=0;i<e;i++)s+=t[Math.floor(Math.random()*t.length)];return s}function i(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:150;return Math.floor(Math.random()*(t-e+1))+e}class n{constructor(e,s,i,n,o,r){const{name:l,link:a,_id:c}=e,{likes:u,isOwner:_,likedByCurrUser:p}=o;this._name=l,this._link=a,this._handleImageClick=s,this._openRemoveItemPopup=i,this._cardSelector=r,this._likes=u||[],this._isOwner=_||!1,this._isLikedByCurrUser=p,this._id=c||t(),this._handleLikedToggle=n}_getTemplate(){return document.querySelector(this._cardSelector).content.querySelector(".places__item").cloneNode(!0)}_handleToggleLikedBtn(e){e.stopPropagation(),this._isLikedByCurrUser=!this._isLikedByCurrUser,this._isLikedByCurrUser?this._placeLikeBtn.classList.add("places__like-btn__active"):this._placeLikeBtn.classList.remove("places__like-btn__active"),this._handleLikedToggle(this._isLikedByCurrUser,this,this._id)}onUpdateLikesAmount(e){e&&(this._likes=e),this._placeLikeAmount.textContent=this._likes.length}_handleRemoveItem(e){e.stopPropagation(),this._openRemoveItemPopup(this._id,this._cardItem)}_setEventListeners(){this._cardItem.addEventListener("click",(()=>{this._handleImageClick(this._name,this._link)})),this._placeLikeBtn.addEventListener("click",(e=>{this._handleToggleLikedBtn(e)})),this._cardItem.querySelector(".places__remove-btn").addEventListener("click",(e=>{this._handleRemoveItem(e)}))}generateCard(){return this._cardItem=this._getTemplate(),this._placeImg=this._cardItem.querySelector(".places__img"),this._placeLikeBtn=this._cardItem.querySelector(".places__like-btn"),this._placeLikeAmount=this._cardItem.querySelector(".places__like-counter"),this._placeRemoveBtn=this._cardItem.querySelector(".places__remove-btn"),"Loading..."!==this._name&&"images/spinner_svg.dc4086388e55820fbae1.svg"!==this._link&&this._setEventListeners(),this._isOwner||this._placeRemoveBtn.remove(),this._isLikedByCurrUser&&this._placeLikeBtn.classList.add("places__like-btn__active"),this._placeImg.style.backgroundImage="url(".concat(this._link,")"),this._placeImg.alt="a photo of ".concat(this._name),this._cardItem.querySelector(".places__name").textContent="".concat(this._name),this.onUpdateLikesAmount(),this._cardItem}}function o(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class r{constructor(e){o(this,"_handleEscClose",(e=>{"Escape"==e.key&&this.close()})),o(this,"_handleContextMenu",(e=>{e.preventDefault()})),this._popupElement=document.querySelector(e)}open(){this._popupElement.classList.add("popup-box_visible"),document.addEventListener("keydown",this._handleEscClose)}close(){this._popupElement.classList.remove("popup-box_visible"),document.removeEventListener("keydown",this._handleEscClose)}setEventListeners(){this._popupElement.addEventListener("mousedown",(e=>{(e.target.classList.contains("popup-box_visible")||e.target.classList.contains("popup-box__close-button"))&&this.close()}))}}class l extends r{constructor(e,t){var s,i;super(e),i=e=>{e.preventDefault(),this._handleSubmitFrom(this._returnInputValObj()),this.close()},(s="_handleFormSubmit")in this?Object.defineProperty(this,s,{value:i,enumerable:!0,configurable:!0,writable:!0}):this[s]=i,this._handleSubmitFrom=t,this._formElement=this._popupElement.querySelector(".popup-box__form"),this._inputList=[...this._formElement.querySelectorAll(".popup-box__input")]}_returnInputValObj(){const e={};return this._inputList.forEach((t=>{e[t.name]=t.value})),e}open(){super.open()}close(){super.close(),this._formElement.reset()}setEventListeners(){this._formElement.addEventListener("submit",this._handleFormSubmit),super.setEventListeners()}}var a=s(855);const c={},u=document.querySelector(".profile__edit-btn"),_=document.querySelector(".profile__add-btn"),p=document.querySelector('input[name="name_input"]'),m=document.querySelector('input[name="about_me"]');function h(){c["form_add-place"].resetValidation(),I.open()}function d(){c["form_profile-edit"].resetValidation(),k.open();const{nameInfo:e,aboutMeInfo:t}=C.getUserInfo();p.value=e,m.value=t}function b(e,t){S.open(e,t)}function f(e,t){y.open(e,t)}function v(e,t,s){e?x.addItemLike(s).then((e=>{t.onUpdateLikesAmount(e.likes)})).catch((e=>console.log("err: "+e))):x.removeItemLike(s).then((e=>{t.onUpdateLikesAmount(e.likes)})).catch((e=>console.log("err: "+e)))}function E(e,s,i){e?(C.setUserInfo({name:"Loading...",about:"Loading...",_id:t()}),C.setPictureProfile(a),L.setNewItemlist([{name:"Loading...",link:a,owner:{_id:t()},likes:[]}])):(document.querySelector(".places__grid-container").innerHTML="",C.setUserInfo({name:i.name,about:i.about,_id:i._id}),C.setPictureProfile(i.avatar),L.setNewItemlist(s))}function g(e,t){L.addItem(function(e,t){return new n(e,b,f,v,t,"#places-item-template").generateCard()}(e,t))}const L=new class{constructor(e){let{renderer:t,containerSelector:s}=e;this._renderer=t,this._container=document.querySelector(s)}renderItems(){this._items.forEach((e=>this._renderer(e)))}addItem(e){this._container.prepend(e)}setNewItemlist(e){this._items=e,this.renderItems()}}({renderer:e=>{const{owner:t,likes:s}=e,i=C.getUserId();g(e,{isOwner:t._id===i,likedByCurrUser:s.some((e=>e._id===i)),likes:s})},containerSelector:".places__grid-container"}),k=new l(".popup-box_type_profile-edit",(function(e){let{name_input:t,about_me:s}=e;c["form_add-place"].resetValidation(),x.setUserInfo({name:t,about:s}).then((e=>{C.setUserInfo(e)}))})),I=new l(".popup-box_type_add-item",(function(e){let{title_place:t,img_link:s}=e;x.addNewCard({name:t,link:s}).then((e=>{g(e,{isOwner:!0,likedByOwner:!1,likes:[]})}))})),S=new class extends r{constructor(e){let{popupSelector:t,imgSelector:s,imgTitleSelector:i}=e;super(t),this._imgElement=this._popupElement.querySelector(s),this._titleElement=this._popupElement.querySelector(i)}_setPopupImg(){this._titleElement.textContent=this.title,this._imgElement.src=this._link,this._imgElement.alt="a pictrue of ".concat(this.title)}open(e,t){this.title=e,this._link=t,this._setPopupImg(),super.open()}}({popupSelector:".popup-box_type_img",imgSelector:".popup-box__img",imgTitleSelector:".popup-box__img-title"}),y=new class extends r{constructor(e){let{popupSelector:t,handleSubmitRemoveConfirm:s}=e;var i,n;super(t),n=e=>{e.preventDefault(),this._handleSubmitRemoveConfirm(this._id,this._element),this.close()},(i="_handleConfirmSubmit")in this?Object.defineProperty(this,i,{value:n,enumerable:!0,configurable:!0,writable:!0}):this[i]=n,this._handleSubmitRemoveConfirm=s,this._submitBtnElement=this._popupElement.querySelector(".popup-box__submit-button")}open(e,t){super.open(),this._element=t,this._id=e}close(){super.close()}setEventListeners(){this._submitBtnElement.addEventListener("click",this._handleConfirmSubmit),super.setEventListeners()}}({popupSelector:".popup-box_type_confirm",handleSubmitRemoveConfirm:function(e,t){x.onRemoveItem(e).then((()=>{t.remove()})).catch((e=>console.log("err: "+e)))}}),C=new class{constructor(e){let{nameElm:t,jobElm:s,picElm:i}=e;this._nameElm=document.querySelector(t),this._jobElm=document.querySelector(s),this._picElm=document.querySelector(i)}setUserInfo(e){let{name:t,about:s,_id:i}=e;this._nameElm.textContent=t,this._jobElm.textContent=s,this.userId=i}getUserInfo(){return{nameInfo:this._nameElm.textContent,aboutMeInfo:this._jobElm.textContent}}getUserId(){return this.userId}setPictureProfile(e){this._picElm.src=e}}({nameElm:".profile__name",jobElm:".profile__about-me",picElm:".profile__avatar"}),x=new class{constructor(e){let{baseUrl:t,headers:s}=e;this.headers=s,this.baseUrl=t}_onHttpRequest(e,t,s){const i="".concat(this.baseUrl).concat(e);return fetch(i,{method:t,headers:this.headers,body:JSON.stringify(s)}).then((e=>e.ok?e.json():Promise.reject("Error: ".concat(e.status))))}getInitInfo(){return Promise.all([this._getInitialCards(),this._getUserInfo()])}_getUserInfo(){return this._onHttpRequest("users/me","GET")}_getInitialCards(){return this._onHttpRequest("cards","GET")}setUserInfo(e){let{name:t,about:s}=e;return this._onHttpRequest("users/me","PATCH",{name:t,about:s})}addNewCard(e){let{name:t,link:s}=e;return this._onHttpRequest("cards","POST",{name:t,link:s})}onRemoveItem(e){return this._onHttpRequest("cards/".concat(e),"DELETE")}addItemLike(e){return this._onHttpRequest("cards/likes/".concat(e),"PUT")}removeItemLike(e){return this._onHttpRequest("cards/likes/".concat(e),"DELETE")}}({baseUrl:"https://around.nomoreparties.co/v1/group-12/",headers:{authorization:"035a3e80-0d3f-421b-b4fa-7f406e49ad5f","Content-Type":"application/json"}});E(!0),x.getInitInfo().then((t=>{let[s,i]=t;var n;E(!1,s,i),u.addEventListener("click",d),_.addEventListener("click",h),n={formSelector:".popup-box__form",inputSelector:".popup-box__input",submitButtonSelector:".popup-box__submit-button",inactiveButtonClass:"popup-box__submit-button_inactive",inputErrorClass:".popup-box__input_type_error",errorClass:".popup-box__input-error_active"},Array.from(document.querySelectorAll(n.formSelector)).forEach((t=>{const s=new e(n,t),i=t.name;c[i]=s,s.enableValidation()})),k.setEventListeners(),I.setEventListeners(),S.setEventListeners(),y.setEventListeners()})).catch((e=>{console.log(e)}))}()}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWFpbi5qcyIsIm1hcHBpbmdzIjoia0hBQ0lBLEVBQTJCLEdBRy9CLFNBQVNDLEVBQW9CQyxHQUU1QixJQUFJQyxFQUFlSCxFQUF5QkUsR0FDNUMsUUFBcUJFLElBQWpCRCxFQUNILE9BQU9BLEVBQWFFLFFBR3JCLElBQUlDLEVBQVNOLEVBQXlCRSxHQUFZLENBR2pERyxRQUFTLElBT1YsT0FIQUUsRUFBb0JMLEdBQVVJLEVBQVFBLEVBQU9ELFFBQVNKLEdBRy9DSyxFQUFPRCxRQ3JCZkosRUFBb0JPLEVBQUksRyxXQ0FqQixNQUFNQyxFQUNYQyxZQUFZQyxFQUFVQyxHQUNwQkMsS0FBS0MsY0FBZ0JILEVBQVNJLGFBQzlCRixLQUFLRyxlQUFpQkwsRUFBU00sY0FDL0JKLEtBQUtLLFlBQWNQLEVBQVNRLFdBQzVCTixLQUFLTyxxQkFBdUJULEVBQVNVLG9CQUNyQ1IsS0FBS1MsaUJBQW1CWCxFQUFTWSxnQkFDakNWLEtBQUtXLHNCQUF3QmIsRUFBU2MscUJBQ3RDWixLQUFLYSxNQUFRZCxFQUVmZSxvQkFDRWQsS0FBS2UsV0FBYUMsTUFBTUMsS0FDdEJqQixLQUFLYSxNQUFNSyxpQkFBaUJsQixLQUFLRyxpQkFFbkNILEtBQUttQixlQUFpQm5CLEtBQUthLE1BQU1PLGNBQWNwQixLQUFLVyx1QkFDcERYLEtBQUtxQixxQkFDTHJCLEtBQUtlLFdBQVdPLFNBQVNDLElBQ3ZCQSxFQUFhQyxpQkFBaUIsU0FBUyxLQUNyQ3hCLEtBQUt5QixvQkFBb0JGLEdBQ3pCdkIsS0FBS3FCLDJCQUlYSyxnQkFBZ0JILEdBQ2QsTUFBTUksRUFBZTNCLEtBQUthLE1BQU1PLGNBQVgsV0FBNkJHLEVBQWFLLEdBQTFDLFdBQ3JCTCxFQUFhTSxVQUFVQyxJQUFJOUIsS0FBS1Msa0JBQ2hDa0IsRUFBYUksWUFBY1IsRUFBYVMsa0JBQ3hDTCxFQUFhRSxVQUFVQyxJQUFJOUIsS0FBS0ssYUFHbEM0QixrQkFBa0JWLEdBQ2hCLE1BQU1JLEVBQWUzQixLQUFLYSxNQUFNTyxjQUFYLFdBQTZCRyxFQUFhSyxHQUExQyxXQUNyQkwsRUFBYU0sVUFBVUssT0FBT2xDLEtBQUtTLGtCQUNuQ2tCLEVBQWFJLFlBQWMsR0FDM0JKLEVBQWFFLFVBQVVLLE9BQU9sQyxLQUFLSyxhQUdyQ29CLG9CQUFvQkYsR0FDZEEsRUFBYVksU0FBU0MsTUFDeEJwQyxLQUFLaUMsa0JBQWtCVixHQUNsQnZCLEtBQUswQixnQkFBZ0JILEdBRzlCYyxrQkFDRXJDLEtBQUtxQixxQkFDTHJCLEtBQUtlLFdBQVdPLFNBQVNDLElBQ3ZCdkIsS0FBS2lDLGtCQUFrQlYsTUFFekIsTUFBTWUsRUFBYXRDLEtBQUthLE1BQU1PLGNBQWMsNkJBQzVDa0IsRUFBV0MsVUFBVyxFQUN0QkQsRUFBV1QsVUFBVUMsSUFBSSxxQ0FDekI5QixLQUFLYSxNQUFNMkIsUUFFYm5CLHFCQUNNckIsS0FBS3lDLG9CQUNQekMsS0FBS21CLGVBQWVVLFVBQVVDLElBQUk5QixLQUFLTyxzQkFDdkNQLEtBQUttQixlQUFlb0IsVUFBVyxJQUUvQnZDLEtBQUttQixlQUFlVSxVQUFVSyxPQUFPbEMsS0FBS08sc0JBQzFDUCxLQUFLbUIsZUFBZW9CLFVBQVcsR0FHbkNFLG1CQUNFLE9BQU96QyxLQUFLZSxXQUFXMkIsTUFBTUMsSUFDbkJBLEVBQU1SLFNBQVNDLFFBRzNCUSxtQkFDRTVDLEtBQUtjLG9CQUNMZCxLQUFLYSxNQUFNVyxpQkFBaUIsVUFBV3FCLEdBQU1BLEVBQUVDLG9CQ3JFbkQsU0FBU0MsSUFBeUMsSUFBekJDLEVBQXlCLHVEQUFoQkMsSUFDNUJDLEVBQ0YsZ0VBQWdFQyxNQUFNLElBRW5FSCxJQUNIQSxFQUFTSSxLQUFLQyxNQUFNRCxLQUFLRSxTQUFXSixFQUFNRixTQUc1QyxJQUFJTyxFQUFNLEdBQ1YsSUFBSyxJQUFJQyxFQUFJLEVBQUdBLEVBQUlSLEVBQVFRLElBQzFCRCxHQUFPTCxFQUFNRSxLQUFLQyxNQUFNRCxLQUFLRSxTQUFXSixFQUFNRixTQUVoRCxPQUFPTyxFQUVULFNBQVNOLElBQW1DLElBQXRCUSxFQUFzQix1REFBaEIsSUFBS0MsRUFBVyx1REFBTCxJQUNyQyxPQUFPTixLQUFLQyxNQUFNRCxLQUFLRSxVQUFZSSxFQUFNRCxFQUFNLElBQU1BLEVDZGhELE1BQU1FLEVBQ1g5RCxZQUNFK0QsRUFDQUMsRUFDQUMsRUFDQUMsRUFDQUMsRUFDQUMsR0FFQSxNQUFNLEtBQUVDLEVBQUYsS0FBUUMsRUFBUixJQUFjQyxHQUFRUixHQUN0QixNQUFFUyxFQUFGLFFBQVNDLEVBQVQsZ0JBQWtCQyxHQUFvQlAsRUFDNUNoRSxLQUFLd0UsTUFBUU4sRUFDYmxFLEtBQUt5RSxNQUFRTixFQUNibkUsS0FBSzBFLGtCQUFvQmIsRUFDekI3RCxLQUFLMkUscUJBQXVCYixFQUM1QjlELEtBQUs0RSxjQUFnQlgsRUFDckJqRSxLQUFLNkUsT0FBU1IsR0FBUyxHQUN2QnJFLEtBQUs4RSxTQUFXUixJQUFXLEVBQzNCdEUsS0FBSytFLG1CQUFxQlIsRUFDMUJ2RSxLQUFLb0UsSUFBTUEsR0FBT3JCLElBQ2xCL0MsS0FBS2dGLG1CQUFxQmpCLEVBRTVCa0IsZUFRRSxPQVAwQkMsU0FBUzlELGNBQ2pDcEIsS0FBSzRFLGVBQ0xPLFFBRUMvRCxjQUFjLGlCQUNkZ0UsV0FBVSxHQUlmQyxzQkFBc0J4QyxHQUNwQkEsRUFBRXlDLGtCQUNGdEYsS0FBSytFLG9CQUFzQi9FLEtBQUsrRSxtQkFDaEMvRSxLQUFLK0UsbUJBQ0QvRSxLQUFLdUYsY0FBYzFELFVBQVVDLElBQUksNEJBQ2pDOUIsS0FBS3VGLGNBQWMxRCxVQUFVSyxPQUFPLDRCQUV4Q2xDLEtBQUtnRixtQkFBbUJoRixLQUFLK0UsbUJBQW9CL0UsS0FBTUEsS0FBS29FLEtBRTlEb0Isb0JBQW9CbkIsR0FDZEEsSUFBT3JFLEtBQUs2RSxPQUFTUixHQUN6QnJFLEtBQUt5RixpQkFBaUIxRCxZQUFjL0IsS0FBSzZFLE9BQU83QixPQUVsRDBDLGtCQUFrQjdDLEdBQ2hCQSxFQUFFeUMsa0JBQ0Z0RixLQUFLMkUscUJBQXFCM0UsS0FBS29FLElBQUtwRSxLQUFLMkYsV0FHM0NDLHFCQUNFNUYsS0FBSzJGLFVBQVVuRSxpQkFBaUIsU0FBUyxLQUN2Q3hCLEtBQUswRSxrQkFBa0IxRSxLQUFLd0UsTUFBT3hFLEtBQUt5RSxVQUUxQ3pFLEtBQUt1RixjQUFjL0QsaUJBQWlCLFNBQVVxQixJQUM1QzdDLEtBQUtxRixzQkFBc0J4QyxNQUU3QjdDLEtBQUsyRixVQUNGdkUsY0FBYyx1QkFDZEksaUJBQWlCLFNBQVVxQixJQUMxQjdDLEtBQUswRixrQkFBa0I3QyxNQUk3QmdELGVBeUJFLE9BeEJBN0YsS0FBSzJGLFVBQVkzRixLQUFLaUYsZUFDdEJqRixLQUFLOEYsVUFBWTlGLEtBQUsyRixVQUFVdkUsY0FBYyxnQkFDOUNwQixLQUFLdUYsY0FBZ0J2RixLQUFLMkYsVUFBVXZFLGNBQWMscUJBQ2xEcEIsS0FBS3lGLGlCQUFtQnpGLEtBQUsyRixVQUFVdkUsY0FDckMseUJBRUZwQixLQUFLK0YsZ0JBQWtCL0YsS0FBSzJGLFVBQVV2RSxjQUFjLHVCQUVuQyxlQUFmcEIsS0FBS3dFLE9BQ1UsZ0RBQWZ4RSxLQUFLeUUsT0FFTHpFLEtBQUs0RixxQkFFRjVGLEtBQUs4RSxVQUNSOUUsS0FBSytGLGdCQUFnQjdELFNBRW5CbEMsS0FBSytFLG9CQUNQL0UsS0FBS3VGLGNBQWMxRCxVQUFVQyxJQUFJLDRCQUduQzlCLEtBQUs4RixVQUFVRSxNQUFNQyxnQkFBckIsY0FBOENqRyxLQUFLeUUsTUFBbkQsS0FDQXpFLEtBQUs4RixVQUFVSSxJQUFmLHFCQUFtQ2xHLEtBQUt3RSxPQUN4Q3hFLEtBQUsyRixVQUFVdkUsY0FBYyxpQkFBaUJXLFlBQTlDLFVBQStEL0IsS0FBS3dFLE9BQ3BFeEUsS0FBS3dGLHNCQUNFeEYsS0FBSzJGLFcsd0hDMUZELE1BQU1RLEVBQ25CdEcsWUFBWXVHLEdBQWUsMEJBSVJ2RCxJQUNKLFVBQVRBLEVBQUV3RCxLQUNKckcsS0FBS3NHLFdBTmtCLDZCQVNMekQsSUFDcEJBLEVBQUVDLG9CQVRGOUMsS0FBS3VHLGNBQWdCckIsU0FBUzlELGNBQWNnRixHQVc5Q0ksT0FDRXhHLEtBQUt1RyxjQUFjMUUsVUFBVUMsSUFBSSxxQkFDakNvRCxTQUFTMUQsaUJBQWlCLFVBQVd4QixLQUFLeUcsaUJBRzVDSCxRQUNFdEcsS0FBS3VHLGNBQWMxRSxVQUFVSyxPQUFPLHFCQUNwQ2dELFNBQVN3QixvQkFBb0IsVUFBVzFHLEtBQUt5RyxpQkFHL0NFLG9CQUNFM0csS0FBS3VHLGNBQWMvRSxpQkFBaUIsYUFBY3FCLEtBRTlDQSxFQUFFK0QsT0FBTy9FLFVBQVVnRixTQUFTLHNCQUM1QmhFLEVBQUUrRCxPQUFPL0UsVUFBVWdGLFNBQVMsNkJBRTVCN0csS0FBS3NHLFlDM0JFLE1BQU1RLFVBQXNCWCxFQUN6Q3RHLFlBQVl1RyxFQUFlVyxHLFFBQ3pCQyxNQUFNWixHLEVBUWF2RCxJQUNuQkEsRUFBRUMsaUJBQ0Y5QyxLQUFLaUgsa0JBQWtCakgsS0FBS2tILHNCQUM1QmxILEtBQUtzRyxVLEVBWnNDLDRCLHNCQUFBLEssdURBQUEsSyxLQUUzQ3RHLEtBQUtpSCxrQkFBb0JGLEVBQ3pCL0csS0FBS21ILGFBQWVuSCxLQUFLdUcsY0FBY25GLGNBQWMsb0JBQ3JEcEIsS0FBS2UsV0FBYSxJQUNiZixLQUFLbUgsYUFBYWpHLGlCQUFpQixzQkFVMUNnRyxxQkFDRSxNQUFNRSxFQUFjLEdBSXBCLE9BSEFwSCxLQUFLZSxXQUFXTyxTQUFTK0YsSUFDdkJELEVBQVlDLEVBQUtuRCxNQUFRbUQsRUFBS0MsU0FFekJGLEVBRVRaLE9BQ0VRLE1BQU1SLE9BRVJGLFFBQ0VVLE1BQU1WLFFBQ050RyxLQUFLbUgsYUFBYTNFLFFBRXBCbUUsb0JBQ0UzRyxLQUFLbUgsYUFBYTNGLGlCQUFpQixTQUFVeEIsS0FBS3VILG1CQUNsRFAsTUFBTUwscUIsYUNsQ1YsTUErQk1hLEVBQWlCLEdBRWpCQyxFQUF1QnZDLFNBQVM5RCxjQUFjLHNCQUM5Q3NHLEVBQXdCeEMsU0FBUzlELGNBQWMscUJBRS9DdUcsRUFBWXpDLFNBQVM5RCxjQUFjLDRCQUNuQ3dHLEVBQWUxQyxTQUFTOUQsY0FBYywwQkNTNUMsU0FBU3lHLElBQ1BMLEVBQWUsa0JBQWtCbkYsa0JBQ2pDeUYsRUFBU3RCLE9BRVgsU0FBU3VCLElBQ1BQLEVBQWUscUJBQXFCbkYsa0JBQ3BDMkYsRUFBVXhCLE9BQ1YsTUFBTSxTQUFFeUIsRUFBRixZQUFZQyxHQUFnQkMsRUFBWUMsY0FDOUNULEVBQVVMLE1BQVFXLEVBQ2xCTCxFQUFhTixNQUFRWSxFQUV2QixTQUFTRyxFQUFhQyxFQUFPbkUsR0FDM0JvRSxFQUFZL0IsS0FBSzhCLEVBQU9uRSxHQUUxQixTQUFTTCxFQUFvQmxDLEVBQUk0RyxHQUMvQkMsRUFBbUJqQyxLQUFLNUUsRUFBSTRHLEdBK0I5QixTQUFTekUsRUFBa0IyRSxFQUFTckIsRUFBTXpGLEdBQ3BDOEcsRUFDRkMsRUFDR0MsWUFBWWhILEdBQ1ppSCxNQUFNQyxJQUNMekIsRUFBSzdCLG9CQUFvQnNELEVBQUl6RSxVQUU5QjBFLE9BQU9DLEdBQVFDLFFBQVFDLElBQUksUUFBVUYsS0FFeENMLEVBQ0dRLGVBQWV2SCxHQUNmaUgsTUFBTUMsSUFDTHpCLEVBQUs3QixvQkFBb0JzRCxFQUFJekUsVUFFOUIwRSxPQUFPQyxHQUFRQyxRQUFRQyxJQUFJLFFBQVVGLEtBRzVDLFNBQVNJLEVBQWVDLEVBQVFDLEVBQWNDLEdBQ3hDRixHQUNGbEIsRUFBWXFCLFlBQVksQ0FDdEJ0RixLQUFNLGFBQ051RixNQUFPLGFBQ1ByRixJQUFLckIsTUFFUG9GLEVBQVl1QixrQkFBa0JDLEdBQzlCQyxFQUFVQyxlQUFlLENBQ3ZCLENBQ0UzRixLQUFNLGFBQ05DLEtBQU13RixFQUNORyxNQUFPLENBQUUxRixJQUFLckIsS0FDZHNCLE1BQU8sUUFJWGEsU0FBUzlELGNBQWMsMkJBQTJCMkksVUFBWSxHQUM5RDVCLEVBQVlxQixZQUFZLENBQ3RCdEYsS0FBTXFGLEVBQVNyRixLQUNmdUYsTUFBT0YsRUFBU0UsTUFDaEJyRixJQUFLbUYsRUFBU25GLE1BRWhCK0QsRUFBWXVCLGtCQUFrQkgsRUFBU1MsUUFFdkNKLEVBQVVDLGVBQWVQLElBaUM3QixTQUFTVyxFQUFXNUMsRUFBTXJELEdBQ3hCNEYsRUFBVU0sUUFuSlosU0FBeUI3QyxFQUFNckQsR0FTN0IsT0FSZ0IsSUFBSUwsRUFDbEIwRCxFQUNBZ0IsRUFDQXZFLEVBQ0FDLEVBQ0FDLEVBQ0EseUJBRWE2QixlQTBJR3NFLENBQWdCOUMsRUFBTXJELElBRzFDLE1BQU00RixFQUFZLElDM0tILE1BQ2IvSixZQUFZLEdBQStCLElBQS9CLFNBQUN1SyxFQUFELGtCQUFXQyxHQUFvQixFQUN6Q3JLLEtBQUtzSyxVQUFZRixFQUNqQnBLLEtBQUt1SyxXQUFhckYsU0FBUzlELGNBQWNpSixHQUczQ0csY0FDRXhLLEtBQUt5SyxPQUFPbkosU0FBUytGLEdBQVNySCxLQUFLc0ssVUFBVWpELEtBRy9DNkMsUUFBUVEsR0FDTjFLLEtBQUt1SyxXQUFXSSxRQUFRRCxHQUUxQmIsZUFBZWUsR0FDYjVLLEtBQUt5SyxPQUFTRyxFQUNkNUssS0FBS3dLLGdCRDRKcUIsQ0FDNUJKLFNBQVd4RyxJQUNULE1BQU0sTUFBRWtHLEVBQUYsTUFBU3pGLEdBQVVULEVBQ25CaEMsRUFBS3VHLEVBQVkwQyxZQU12QlosRUFBV3JHLEVBTE0sQ0FDZlUsUUFBU3dGLEVBQU0xRixNQUFReEMsRUFDdkIyQyxnQkFBaUJGLEVBQU0zQixNQUFNb0ksR0FBU0EsRUFBSzFHLE1BQVF4QyxJQUNuRHlDLE1BQUFBLEtBSUpnRyxrQkFBbUIsNEJBRWZyQyxFQUFZLElBQUlsQixFQUNwQixnQ0FuR0YsWUFBMkQsSUFBMUIsV0FBRWlFLEVBQUYsU0FBY0MsR0FBWSxFQUN6RHhELEVBQWUsa0JBQWtCbkYsa0JBQ2pDc0csRUFBSWEsWUFBWSxDQUFFdEYsS0FBTTZHLEVBQVl0QixNQUFPdUIsSUFBWW5DLE1BQU1DLElBQzNEWCxFQUFZcUIsWUFBWVYsU0FtR3RCaEIsRUFBVyxJQUFJaEIsRUFDbkIsNEJBOUhGLFlBQW9FLElBQXJDbUUsWUFBYS9HLEVBQU1nSCxTQUFVL0csR0FBUSxFQUNsRXdFLEVBQ0d3QyxXQUFXLENBQ1ZqSCxLQUFBQSxFQUNBQyxLQUFBQSxJQUVEMEUsTUFBTUMsSUFNTG1CLEVBQVduQixFQUxNLENBQ2Z4RSxTQUFTLEVBQ1Q4RyxjQUFjLEVBQ2QvRyxNQUFPLFdBdUhUa0UsRUFBYyxJRTlMTCxjQUE2QnBDLEVBQzFDdEcsWUFBWSxHQUFrRCxJQUFsRCxjQUFFdUcsRUFBRixZQUFpQmlGLEVBQWpCLGlCQUE4QkMsR0FBb0IsRUFDNUR0RSxNQUFNWixHQUNOcEcsS0FBS3VMLFlBQWN2TCxLQUFLdUcsY0FBY25GLGNBQWNpSyxHQUNwRHJMLEtBQUt3TCxjQUFnQnhMLEtBQUt1RyxjQUFjbkYsY0FBY2tLLEdBR3hERyxlQUNFekwsS0FBS3dMLGNBQWN6SixZQUFjL0IsS0FBS3NJLE1BQ3RDdEksS0FBS3VMLFlBQVlHLElBQU0xTCxLQUFLeUUsTUFDNUJ6RSxLQUFLdUwsWUFBWXJGLElBQWpCLHVCQUF1Q2xHLEtBQUtzSSxPQUc5QzlCLEtBQUs4QixFQUFPbkUsR0FDVm5FLEtBQUtzSSxNQUFRQSxFQUNidEksS0FBS3lFLE1BQVFOLEVBQ2JuRSxLQUFLeUwsZUFDTHpFLE1BQU1SLFNGNks2QixDQUNyQ0osY0FBZSxzQkFDZmlGLFlBQWEsa0JBQ2JDLGlCQUFrQiwwQkFHZDdDLEVBQXFCLElHcE1aLGNBQTJCdEMsRUFDeEN0RyxZQUFZLEdBQThDLElBQTlDLGNBQUV1RyxFQUFGLDBCQUFpQnVGLEdBQTZCLEUsUUFDeEQzRSxNQUFNWixHLEVBZWdCdkQsSUFDdEJBLEVBQUVDLGlCQUNGOUMsS0FBSzRMLDJCQUEyQjVMLEtBQUtvRSxJQUFLcEUsS0FBSzZMLFVBQy9DN0wsS0FBS3NHLFUsRUFuQm1ELCtCLHNCQUFBLEssdURBQUEsSyxLQUV4RHRHLEtBQUs0TCwyQkFBNkJELEVBQ2xDM0wsS0FBSzhMLGtCQUFvQjlMLEtBQUt1RyxjQUFjbkYsY0FDMUMsNkJBR0pvRixLQUFLNUUsRUFBSW1LLEdBQ1AvRSxNQUFNUixPQUNOeEcsS0FBSzZMLFNBQVdFLEVBQ2hCL0wsS0FBS29FLElBQU14QyxFQUViMEUsUUFDRVUsTUFBTVYsUUFTUkssb0JBQ0UzRyxLQUFLOEwsa0JBQWtCdEssaUJBQWlCLFFBQVN4QixLQUFLZ00sc0JBQ3REaEYsTUFBTUwsc0JIMktrQyxDQUMxQ1AsY0FBZSwwQkFDZnVGLDBCQTFIRixTQUFtQy9KLEVBQUltSyxHQUNyQ3BELEVBQ0dzRCxhQUFhckssR0FDYmlILE1BQUssS0FDSmtELEVBQVE3SixZQUVUNkcsT0FBT0MsR0FBUUMsUUFBUUMsSUFBSSxRQUFVRixRQXNIcENiLEVBQWMsSUkxTUwsTUFDYnRJLFlBQVksR0FBNkIsSUFBN0IsUUFBRXFNLEVBQUYsT0FBV0MsRUFBWCxPQUFtQkMsR0FBVSxFQUN2Q3BNLEtBQUtxTSxTQUFXbkgsU0FBUzlELGNBQWM4SyxHQUN2Q2xNLEtBQUtzTSxRQUFVcEgsU0FBUzlELGNBQWMrSyxHQUN0Q25NLEtBQUt1TSxRQUFVckgsU0FBUzlELGNBQWNnTCxHQUl4QzVDLFlBQVksR0FBc0IsSUFBdEIsS0FBRXRGLEVBQUYsTUFBUXVGLEVBQVIsSUFBZXJGLEdBQU8sRUFDaENwRSxLQUFLcU0sU0FBU3RLLFlBQWNtQyxFQUM1QmxFLEtBQUtzTSxRQUFRdkssWUFBYzBILEVBQzNCekosS0FBS3dNLE9BQVNwSSxFQUVoQmdFLGNBQ0UsTUFBTyxDQUNMSCxTQUFVakksS0FBS3FNLFNBQVN0SyxZQUN4Qm1HLFlBQWFsSSxLQUFLc00sUUFBUXZLLGFBSTlCOEksWUFDRSxPQUFPN0ssS0FBS3dNLE9BRWQ5QyxrQkFBa0IrQyxHQUNoQnpNLEtBQUt1TSxRQUFRYixJQUFNZSxJSmtMVSxDQUMvQlAsUUFBUyxpQkFDVEMsT0FBUSxxQkFDUkMsT0FBUSxxQkFFSnpELEVBQU0sSUsvTUcsTUFDYjlJLFlBQVksR0FBc0IsSUFBdEIsUUFBRTZNLEVBQUYsUUFBV0MsR0FBVyxFQUNoQzNNLEtBQUsyTSxRQUFVQSxFQUNmM00sS0FBSzBNLFFBQVVBLEVBRWpCRSxlQUFlQyxFQUFLQyxFQUFRbEosR0FDMUIsTUFBTW1KLEVBQVUsR0FBSCxPQUFNL00sS0FBSzBNLFNBQVgsT0FBcUJHLEdBQ2xDLE9BQU9HLE1BQU1ELEVBQVMsQ0FDcEJELE9BQUFBLEVBQ0FILFFBQVMzTSxLQUFLMk0sUUFDZE0sS0FBTUMsS0FBS0MsVUFBVXZKLEtBQ3BCaUYsTUFBTUMsR0FDSEEsRUFBSXNFLEdBQ0N0RSxFQUFJdUUsT0FFSkMsUUFBUUMsT0FBUixpQkFBeUJ6RSxFQUFJTyxXQUkxQ21FLGNBQ0UsT0FBT0YsUUFBUUcsSUFBSSxDQUFDek4sS0FBSzBOLG1CQUFvQjFOLEtBQUsyTixpQkFFcERBLGVBQ0UsT0FBTzNOLEtBQUs0TSxlQUFlLFdBQVksT0FFekNjLG1CQUNFLE9BQU8xTixLQUFLNE0sZUFBZSxRQUFTLE9BR3RDcEQsWUFBWSxHQUFjLElBQWQsS0FBQ3RGLEVBQUQsTUFBTXVGLEdBQVEsRUFDeEIsT0FBT3pKLEtBQUs0TSxlQUFlLFdBQVksUUFBUSxDQUFDMUksS0FBQUEsRUFBS3VGLE1BQUFBLElBRXZEMEIsV0FBVyxHQUFhLElBQWIsS0FBQ2pILEVBQUQsS0FBTUMsR0FBTyxFQUN0QixPQUFPbkUsS0FBSzRNLGVBQWUsUUFBUSxPQUFPLENBQUMxSSxLQUFBQSxFQUFLQyxLQUFBQSxJQUVsRDhILGFBQWFySyxHQUNYLE9BQU81QixLQUFLNE0sZUFBTCxnQkFBNkJoTCxHQUFLLFVBRTNDZ0gsWUFBWWhILEdBQ1YsT0FBTzVCLEtBQUs0TSxlQUFMLHNCQUFtQ2hMLEdBQUssT0FHakR1SCxlQUFldkgsR0FDYixPQUFPNUIsS0FBSzRNLGVBQUwsc0JBQW1DaEwsR0FBSyxZQzNDaEMsQ0FDakI4SyxRQUFTLCtDQUNUQyxRQUFTLENBQ1RpQixjQUFlLHVDQUNiLGVBQWdCLHNCTnNJbEJ4RSxHQUFlLEdBQ2ZULEVBQ0c2RSxjQUNBM0UsTUFBSyxJQUE4QixJQUE1QlMsRUFBY0MsR0FBYyxFQTVHeEMsSUFBMEJ6SixFQTZHcEJzSixHQUFlLEVBQU9FLEVBQWNDLEdBQ3BDOUIsRUFBcUJqRyxpQkFBaUIsUUFBU3VHLEdBQy9DTCxFQUFzQmxHLGlCQUFpQixRQUFTcUcsR0EvRzVCL0gsRUFnSEgsQ0FDZkksYUFBYyxtQkFDZEUsY0FBZSxvQkFDZlEscUJBQXNCLDRCQUN0Qkosb0JBQXFCLG9DQUNyQkUsZ0JBQWlCLCtCQUNqQkosV0FBWSxrQ0FySEFVLE1BQU1DLEtBQ3RCaUUsU0FBU2hFLGlCQUFpQnBCLEVBQVNJLGVBRzNCb0IsU0FBU3ZCLElBQ2pCLE1BQU04TixFQUFXLElBQUlqTyxFQUFjRSxFQUFVQyxHQUN2QytOLEVBQVcvTixFQUFLbUUsS0FDdEJzRCxFQUFlc0csR0FBWUQsRUFDM0JBLEVBQVNqTCxzQkF3SFhvRixFQUFVckIsb0JBQ1ZtQixFQUFTbkIsb0JBQ1Q0QixFQUFZNUIsb0JBQ1o4QixFQUFtQjlCLHVCQVRoQm9DLE9BQU9DLElBQ05DLFFBQVFDLElBQUlGLE0iLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80L3dlYnBhY2svYm9vdHN0cmFwIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvd2VicGFjay9ydW50aW1lL3B1YmxpY1BhdGgiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy91dGlscy91dGlscy5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL2NvbXBvbmVudHMvQ2FyZC5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL2NvbXBvbmVudHMvUG9wdXAuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy91dGlscy9jb25zdGFudHMuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9wYWdlcy9pbmRleC5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL2NvbXBvbmVudHMvU2VjdGlvbi5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL1BvcHVwQ29uZmlybS5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL2NvbXBvbmVudHMvVXNlckluZm8uanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy91dGlscy9BcGkuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL2NvbmZpZy5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBUaGUgbW9kdWxlIGNhY2hlXG52YXIgX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fID0ge307XG5cbi8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG5mdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuXHR2YXIgY2FjaGVkTW9kdWxlID0gX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fW21vZHVsZUlkXTtcblx0aWYgKGNhY2hlZE1vZHVsZSAhPT0gdW5kZWZpbmVkKSB7XG5cdFx0cmV0dXJuIGNhY2hlZE1vZHVsZS5leHBvcnRzO1xuXHR9XG5cdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG5cdHZhciBtb2R1bGUgPSBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX19bbW9kdWxlSWRdID0ge1xuXHRcdC8vIG5vIG1vZHVsZS5pZCBuZWVkZWRcblx0XHQvLyBubyBtb2R1bGUubG9hZGVkIG5lZWRlZFxuXHRcdGV4cG9ydHM6IHt9XG5cdH07XG5cblx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG5cdF9fd2VicGFja19tb2R1bGVzX19bbW9kdWxlSWRdKG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuXG5cdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG5cdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbn1cblxuIiwiX193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCJcIjsiLCJleHBvcnQgY2xhc3MgRm9ybVZhbGlkYXRvciB7XHJcbiAgY29uc3RydWN0b3Ioc2V0dGluZ3MsIGZvcm0pIHtcclxuICAgIHRoaXMuX2Zvcm1TZWxlY3RvciA9IHNldHRpbmdzLmZvcm1TZWxlY3RvcjtcclxuICAgIHRoaXMuX2lucHV0U2VsZWN0b3IgPSBzZXR0aW5ncy5pbnB1dFNlbGVjdG9yO1xyXG4gICAgdGhpcy5fZXJyb3JDbGFzcyA9IHNldHRpbmdzLmVycm9yQ2xhc3M7XHJcbiAgICB0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzID0gc2V0dGluZ3MuaW5hY3RpdmVCdXR0b25DbGFzcztcclxuICAgIHRoaXMuX2lucHV0RXJyb3JDbGFzcyA9IHNldHRpbmdzLmlucHV0RXJyb3JDbGFzcztcclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvblNlbGVjdG9yID0gc2V0dGluZ3Muc3VibWl0QnV0dG9uU2VsZWN0b3I7XHJcbiAgICB0aGlzLl9mb3JtID0gZm9ybTtcclxuICB9XHJcbiAgX3NldEZvcm1MaXN0ZW5lcnMoKSB7XHJcbiAgICB0aGlzLl9pbnB1dExpc3QgPSBBcnJheS5mcm9tKFxyXG4gICAgICB0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3JBbGwodGhpcy5faW5wdXRTZWxlY3RvcilcclxuICAgICk7XHJcbiAgICB0aGlzLl9idXR0b25FbGVtZW50ID0gdGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yKHRoaXMuX3N1Ym1pdEJ1dHRvblNlbGVjdG9yKTtcclxuICAgIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKCk7XHJcbiAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaCgoaW5wdXRFbGVtZW50KSA9PiB7XHJcbiAgICAgIGlucHV0RWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiaW5wdXRcIiwgKCkgPT4ge1xyXG4gICAgICAgIHRoaXMuX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dEVsZW1lbnQpO1xyXG4gICAgICAgIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKCk7XHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcbiAgfVxyXG4gIF9zaG93SW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpIHtcclxuICAgIGNvbnN0IGVycm9yRWxlbWVudCA9IHRoaXMuX2Zvcm0ucXVlcnlTZWxlY3RvcihgLiR7aW5wdXRFbGVtZW50LmlkfS1lcnJvcmApO1xyXG4gICAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5hZGQodGhpcy5faW5wdXRFcnJvckNsYXNzKTtcclxuICAgIGVycm9yRWxlbWVudC50ZXh0Q29udGVudCA9IGlucHV0RWxlbWVudC52YWxpZGF0aW9uTWVzc2FnZTtcclxuICAgIGVycm9yRWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuX2Vycm9yQ2xhc3MpO1xyXG4gIH1cclxuXHJcbiAgX3JlbW92ZUlucHV0RXJyb3IoaW5wdXRFbGVtZW50KSB7XHJcbiAgICBjb25zdCBlcnJvckVsZW1lbnQgPSB0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3IoYC4ke2lucHV0RWxlbWVudC5pZH0tZXJyb3JgKTtcclxuICAgIGlucHV0RWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2lucHV0RXJyb3JDbGFzcyk7XHJcbiAgICBlcnJvckVsZW1lbnQudGV4dENvbnRlbnQgPSBcIlwiO1xyXG4gICAgZXJyb3JFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5fZXJyb3JDbGFzcyk7XHJcbiAgfVxyXG5cclxuICBfY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWxlbWVudCkge1xyXG4gICAgaWYgKGlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZCkge1xyXG4gICAgICB0aGlzLl9yZW1vdmVJbnB1dEVycm9yKGlucHV0RWxlbWVudCk7XHJcbiAgICB9IGVsc2UgdGhpcy5fc2hvd0lucHV0RXJyb3IoaW5wdXRFbGVtZW50KTtcclxuICB9XHJcblxyXG4gIHJlc2V0VmFsaWRhdGlvbigpIHtcclxuICAgIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKCk7XHJcbiAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaCgoaW5wdXRFbGVtZW50KSA9PiB7XHJcbiAgICAgIHRoaXMuX3JlbW92ZUlucHV0RXJyb3IoaW5wdXRFbGVtZW50KTtcclxuICAgIH0pO1xyXG4gICAgY29uc3QgYnRuRm9ybUVsbSA9IHRoaXMuX2Zvcm0ucXVlcnlTZWxlY3RvcihcIi5wb3B1cC1ib3hfX3N1Ym1pdC1idXR0b25cIik7XHJcbiAgICBidG5Gb3JtRWxtLmRpc2FibGVkID0gdHJ1ZTtcclxuICAgIGJ0bkZvcm1FbG0uY2xhc3NMaXN0LmFkZChcInBvcHVwLWJveF9fc3VibWl0LWJ1dHRvbl9pbmFjdGl2ZVwiKTtcclxuICAgIHRoaXMuX2Zvcm0ucmVzZXQoKTtcclxuICB9XHJcbiAgX3RvZ2dsZUJ1dHRvblN0YXRlKCkge1xyXG4gICAgaWYgKHRoaXMuX2hhc0ludmFsaWRJbnB1dCgpKSB7XHJcbiAgICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcclxuICAgICAgdGhpcy5fYnV0dG9uRWxlbWVudC5kaXNhYmxlZCA9IHRydWU7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLl9idXR0b25FbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyk7XHJcbiAgICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQuZGlzYWJsZWQgPSBmYWxzZTtcclxuICAgIH1cclxuICB9XHJcbiAgX2hhc0ludmFsaWRJbnB1dCgpIHtcclxuICAgIHJldHVybiB0aGlzLl9pbnB1dExpc3Quc29tZSgoaW5wdXQpID0+IHtcclxuICAgICAgcmV0dXJuICFpbnB1dC52YWxpZGl0eS52YWxpZDtcclxuICAgIH0pO1xyXG4gIH1cclxuICBlbmFibGVWYWxpZGF0aW9uKCkge1xyXG4gICAgdGhpcy5fc2V0Rm9ybUxpc3RlbmVycygpO1xyXG4gICAgdGhpcy5fZm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChlKSA9PiBlLnByZXZlbnREZWZhdWx0KCkpO1xyXG4gIH1cclxufVxyXG4iLCJmdW5jdGlvbiBnZXRSYW5kb21TdHJpbmcobGVuZ3RoID0gZ2V0UmFuZG9tSW50KCkpIHtcclxuICBsZXQgY2hhcnMgPVxyXG4gICAgXCIwMTIzNDU2Nzg5QUJDREVGR0hJSktMTU5PUFFSU1RVVldYWVphYmNkZWZnaGlrbG1ub3BxcnN0dXZ3eHl6XCIuc3BsaXQoXCJcIik7XHJcblxyXG4gIGlmICghbGVuZ3RoKSB7XHJcbiAgICBsZW5ndGggPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiBjaGFycy5sZW5ndGgpO1xyXG4gIH1cclxuXHJcbiAgbGV0IHN0ciA9IFwiXCI7XHJcbiAgZm9yIChsZXQgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykge1xyXG4gICAgc3RyICs9IGNoYXJzW01hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIGNoYXJzLmxlbmd0aCldO1xyXG4gIH1cclxuICByZXR1cm4gc3RyO1xyXG59XHJcbmZ1bmN0aW9uIGdldFJhbmRvbUludChtaW4gPSAxMDAsIG1heCA9IDE1MCkge1xyXG4gIHJldHVybiBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAobWF4IC0gbWluICsgMSkpICsgbWluO1xyXG59XHJcblxyXG5leHBvcnQgeyBnZXRSYW5kb21TdHJpbmcgfTtcclxuIiwiaW1wb3J0IHsgZ2V0UmFuZG9tU3RyaW5nIH0gZnJvbSBcIi4uL3V0aWxzL3V0aWxzLmpzXCI7XHJcbmV4cG9ydCBjbGFzcyBDYXJkIHtcclxuICBjb25zdHJ1Y3RvcihcclxuICAgIGRhdGEsXHJcbiAgICBoYW5kbGVJbWFnZUNsaWNrLFxyXG4gICAgb3BlblJlbW92ZUl0ZW1Qb3B1cCxcclxuICAgIGhhbmRsZUxpa2VkVG9nZ2xlLFxyXG4gICAgY2FyZEluZm8sXHJcbiAgICBjYXJkU2VsZWN0b3JcclxuICApIHtcclxuICAgIGNvbnN0IHsgbmFtZSwgbGluaywgX2lkIH0gPSBkYXRhO1xyXG4gICAgY29uc3QgeyBsaWtlcywgaXNPd25lciwgbGlrZWRCeUN1cnJVc2VyIH0gPSBjYXJkSW5mbztcclxuICAgIHRoaXMuX25hbWUgPSBuYW1lO1xyXG4gICAgdGhpcy5fbGluayA9IGxpbms7XHJcbiAgICB0aGlzLl9oYW5kbGVJbWFnZUNsaWNrID0gaGFuZGxlSW1hZ2VDbGljaztcclxuICAgIHRoaXMuX29wZW5SZW1vdmVJdGVtUG9wdXAgPSBvcGVuUmVtb3ZlSXRlbVBvcHVwO1xyXG4gICAgdGhpcy5fY2FyZFNlbGVjdG9yID0gY2FyZFNlbGVjdG9yO1xyXG4gICAgdGhpcy5fbGlrZXMgPSBsaWtlcyB8fCBbXTtcclxuICAgIHRoaXMuX2lzT3duZXIgPSBpc093bmVyIHx8IGZhbHNlO1xyXG4gICAgdGhpcy5faXNMaWtlZEJ5Q3VyclVzZXIgPSBsaWtlZEJ5Q3VyclVzZXI7XHJcbiAgICB0aGlzLl9pZCA9IF9pZCB8fCBnZXRSYW5kb21TdHJpbmcoKTtcclxuICAgIHRoaXMuX2hhbmRsZUxpa2VkVG9nZ2xlID0gaGFuZGxlTGlrZWRUb2dnbGU7XHJcbiAgfVxyXG4gIF9nZXRUZW1wbGF0ZSgpIHtcclxuICAgIGNvbnN0IHBsYWNlSXRlbVRlbXBsYXRlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcclxuICAgICAgdGhpcy5fY2FyZFNlbGVjdG9yXHJcbiAgICApLmNvbnRlbnQ7XHJcbiAgICBjb25zdCBjYXJkRWxlbWVudCA9IHBsYWNlSXRlbVRlbXBsYXRlXHJcbiAgICAgIC5xdWVyeVNlbGVjdG9yKFwiLnBsYWNlc19faXRlbVwiKVxyXG4gICAgICAuY2xvbmVOb2RlKHRydWUpO1xyXG5cclxuICAgIHJldHVybiBjYXJkRWxlbWVudDtcclxuICB9XHJcbiAgX2hhbmRsZVRvZ2dsZUxpa2VkQnRuKGUpIHtcclxuICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgICB0aGlzLl9pc0xpa2VkQnlDdXJyVXNlciA9ICF0aGlzLl9pc0xpa2VkQnlDdXJyVXNlcjtcclxuICAgIHRoaXMuX2lzTGlrZWRCeUN1cnJVc2VyXHJcbiAgICAgID8gdGhpcy5fcGxhY2VMaWtlQnRuLmNsYXNzTGlzdC5hZGQoXCJwbGFjZXNfX2xpa2UtYnRuX19hY3RpdmVcIilcclxuICAgICAgOiB0aGlzLl9wbGFjZUxpa2VCdG4uY2xhc3NMaXN0LnJlbW92ZShcInBsYWNlc19fbGlrZS1idG5fX2FjdGl2ZVwiKTtcclxuXHJcbiAgICB0aGlzLl9oYW5kbGVMaWtlZFRvZ2dsZSh0aGlzLl9pc0xpa2VkQnlDdXJyVXNlciwgdGhpcywgdGhpcy5faWQpO1xyXG4gIH1cclxuICBvblVwZGF0ZUxpa2VzQW1vdW50KGxpa2VzKSB7XHJcbiAgICBpZiAobGlrZXMpIHRoaXMuX2xpa2VzID0gbGlrZXM7XHJcbiAgICB0aGlzLl9wbGFjZUxpa2VBbW91bnQudGV4dENvbnRlbnQgPSB0aGlzLl9saWtlcy5sZW5ndGg7XHJcbiAgfVxyXG4gIF9oYW5kbGVSZW1vdmVJdGVtKGUpIHtcclxuICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgICB0aGlzLl9vcGVuUmVtb3ZlSXRlbVBvcHVwKHRoaXMuX2lkLCB0aGlzLl9jYXJkSXRlbSk7XHJcbiAgfVxyXG5cclxuICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICB0aGlzLl9jYXJkSXRlbS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gICAgICB0aGlzLl9oYW5kbGVJbWFnZUNsaWNrKHRoaXMuX25hbWUsIHRoaXMuX2xpbmspO1xyXG4gICAgfSk7XHJcbiAgICB0aGlzLl9wbGFjZUxpa2VCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChlKSA9PiB7XHJcbiAgICAgIHRoaXMuX2hhbmRsZVRvZ2dsZUxpa2VkQnRuKGUpO1xyXG4gICAgfSk7XHJcbiAgICB0aGlzLl9jYXJkSXRlbVxyXG4gICAgICAucXVlcnlTZWxlY3RvcihcIi5wbGFjZXNfX3JlbW92ZS1idG5cIilcclxuICAgICAgLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZSkgPT4ge1xyXG4gICAgICAgIHRoaXMuX2hhbmRsZVJlbW92ZUl0ZW0oZSk7XHJcbiAgICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgZ2VuZXJhdGVDYXJkKCkge1xyXG4gICAgdGhpcy5fY2FyZEl0ZW0gPSB0aGlzLl9nZXRUZW1wbGF0ZSgpO1xyXG4gICAgdGhpcy5fcGxhY2VJbWcgPSB0aGlzLl9jYXJkSXRlbS5xdWVyeVNlbGVjdG9yKFwiLnBsYWNlc19faW1nXCIpO1xyXG4gICAgdGhpcy5fcGxhY2VMaWtlQnRuID0gdGhpcy5fY2FyZEl0ZW0ucXVlcnlTZWxlY3RvcihcIi5wbGFjZXNfX2xpa2UtYnRuXCIpO1xyXG4gICAgdGhpcy5fcGxhY2VMaWtlQW1vdW50ID0gdGhpcy5fY2FyZEl0ZW0ucXVlcnlTZWxlY3RvcihcclxuICAgICAgXCIucGxhY2VzX19saWtlLWNvdW50ZXJcIlxyXG4gICAgKTtcclxuICAgIHRoaXMuX3BsYWNlUmVtb3ZlQnRuID0gdGhpcy5fY2FyZEl0ZW0ucXVlcnlTZWxlY3RvcihcIi5wbGFjZXNfX3JlbW92ZS1idG5cIik7XHJcbiAgICBpZiAoXHJcbiAgICAgIHRoaXMuX25hbWUgIT09IFwiTG9hZGluZy4uLlwiICYmXHJcbiAgICAgIHRoaXMuX2xpbmsgIT09IFwiaW1hZ2VzL3NwaW5uZXJfc3ZnLmRjNDA4NjM4OGU1NTgyMGZiYWUxLnN2Z1wiXHJcbiAgICApIHtcclxuICAgICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuICAgIH1cclxuICAgIGlmICghdGhpcy5faXNPd25lcikge1xyXG4gICAgICB0aGlzLl9wbGFjZVJlbW92ZUJ0bi5yZW1vdmUoKTtcclxuICAgIH1cclxuICAgIGlmICh0aGlzLl9pc0xpa2VkQnlDdXJyVXNlcikge1xyXG4gICAgICB0aGlzLl9wbGFjZUxpa2VCdG4uY2xhc3NMaXN0LmFkZChcInBsYWNlc19fbGlrZS1idG5fX2FjdGl2ZVwiKTtcclxuICAgIH1cclxuXHJcbiAgICB0aGlzLl9wbGFjZUltZy5zdHlsZS5iYWNrZ3JvdW5kSW1hZ2UgPSBgdXJsKCR7dGhpcy5fbGlua30pYDtcclxuICAgIHRoaXMuX3BsYWNlSW1nLmFsdCA9IGBhIHBob3RvIG9mICR7dGhpcy5fbmFtZX1gO1xyXG4gICAgdGhpcy5fY2FyZEl0ZW0ucXVlcnlTZWxlY3RvcihcIi5wbGFjZXNfX25hbWVcIikudGV4dENvbnRlbnQgPSBgJHt0aGlzLl9uYW1lfWA7XHJcbiAgICB0aGlzLm9uVXBkYXRlTGlrZXNBbW91bnQoKTtcclxuICAgIHJldHVybiB0aGlzLl9jYXJkSXRlbTtcclxuICB9XHJcbn1cclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXAge1xyXG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IpIHtcclxuICAgIHRoaXMuX3BvcHVwRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IocG9wdXBTZWxlY3Rvcik7XHJcbiAgfVxyXG5cclxuICBfaGFuZGxlRXNjQ2xvc2UgPSAoZSkgPT4ge1xyXG4gICAgaWYgKGUua2V5ID09IFwiRXNjYXBlXCIpIHtcclxuICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgfVxyXG4gIH07XHJcbiAgX2hhbmRsZUNvbnRleHRNZW51ID0gKGUpID0+IHtcclxuICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICB9O1xyXG4gIG9wZW4oKSB7XHJcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQuY2xhc3NMaXN0LmFkZChcInBvcHVwLWJveF92aXNpYmxlXCIpO1xyXG4gICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgdGhpcy5faGFuZGxlRXNjQ2xvc2UpO1xyXG4gIH1cclxuXHJcbiAgY2xvc2UoKSB7XHJcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShcInBvcHVwLWJveF92aXNpYmxlXCIpO1xyXG4gICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgdGhpcy5faGFuZGxlRXNjQ2xvc2UpO1xyXG4gIH1cclxuXHJcbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlZG93blwiLCAoZSkgPT4ge1xyXG4gICAgICBpZiAoXHJcbiAgICAgICAgZS50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwicG9wdXAtYm94X3Zpc2libGVcIikgfHxcclxuICAgICAgICBlLnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJwb3B1cC1ib3hfX2Nsb3NlLWJ1dHRvblwiKVxyXG4gICAgICApIHtcclxuICAgICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gIH1cclxufVxyXG4iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXAuanNcIjtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwV2l0aEZvcm0gZXh0ZW5kcyBQb3B1cCB7XHJcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3RvciwgaGFuZGxlU3VibWl0RnJvbSkge1xyXG4gICAgc3VwZXIocG9wdXBTZWxlY3Rvcik7XHJcbiAgICB0aGlzLl9oYW5kbGVTdWJtaXRGcm9tID0gaGFuZGxlU3VibWl0RnJvbTtcclxuICAgIHRoaXMuX2Zvcm1FbGVtZW50ID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXAtYm94X19mb3JtXCIpO1xyXG4gICAgdGhpcy5faW5wdXRMaXN0ID0gW1xyXG4gICAgICAuLi50aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLnBvcHVwLWJveF9faW5wdXRcIiksXHJcbiAgICBdO1xyXG4gIH1cclxuXHJcbiAgX2hhbmRsZUZvcm1TdWJtaXQgPSAoZSkgPT4ge1xyXG4gICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgdGhpcy5faGFuZGxlU3VibWl0RnJvbSh0aGlzLl9yZXR1cm5JbnB1dFZhbE9iaigpKTtcclxuICAgIHRoaXMuY2xvc2UoKTtcclxuICB9O1xyXG5cclxuICBfcmV0dXJuSW5wdXRWYWxPYmooKSB7XHJcbiAgICBjb25zdCB2YWxJbnB1dE9iaiA9IHt9O1xyXG4gICAgdGhpcy5faW5wdXRMaXN0LmZvckVhY2goKGl0ZW0pID0+IHtcclxuICAgICAgdmFsSW5wdXRPYmpbaXRlbS5uYW1lXSA9IGl0ZW0udmFsdWU7XHJcbiAgICB9KTtcclxuICAgIHJldHVybiB2YWxJbnB1dE9iajtcclxuICB9XHJcbiAgb3BlbigpIHtcclxuICAgIHN1cGVyLm9wZW4oKTtcclxuICB9XHJcbiAgY2xvc2UoKSB7XHJcbiAgICBzdXBlci5jbG9zZSgpO1xyXG4gICAgdGhpcy5fZm9ybUVsZW1lbnQucmVzZXQoKTtcclxuICB9XHJcbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICB0aGlzLl9mb3JtRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQpO1xyXG4gICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuICB9XHJcbn1cclxuIiwiY29uc3QgaW5pdGlhbENhcmRzID0gW1xyXG4gIHtcclxuICAgIG5hbWU6IFwiWW9zZW1pdGUgVmFsbGV5XCIsXHJcbiAgICBsaW5rOiBcImh0dHBzOi8vY29kZS5zMy55YW5kZXgubmV0L3dlYi1jb2RlL3lvc2VtaXRlLmpwZ1wiLFxyXG4gIH0sXHJcbiAge1xyXG4gICAgbmFtZTogXCJMYWtlIExvdWlzZVwiLFxyXG4gICAgbGluazogXCJodHRwczovL2NvZGUuczMueWFuZGV4Lm5ldC93ZWItY29kZS9sYWtlLWxvdWlzZS5qcGdcIixcclxuICB9LFxyXG4gIHtcclxuICAgIG5hbWU6IFwiQmFsZCBNb3VudGFpbnNcIixcclxuICAgIGxpbms6IFwiaHR0cHM6Ly9jb2RlLnMzLnlhbmRleC5uZXQvd2ViLWNvZGUvYmFsZC1tb3VudGFpbnMuanBnXCIsXHJcbiAgfSxcclxuICB7XHJcbiAgICBuYW1lOiBcIkxhdGVtYXJcIixcclxuICAgIGxpbms6IFwiaHR0cHM6Ly9jb2RlLnMzLnlhbmRleC5uZXQvd2ViLWNvZGUvbGF0ZW1hci5qcGdcIixcclxuICB9LFxyXG4gIHtcclxuICAgIG5hbWU6IFwiVmFub2lzZSBOYXRpb25hbCBQYXJrXCIsXHJcbiAgICBsaW5rOiBcImh0dHBzOi8vY29kZS5zMy55YW5kZXgubmV0L3dlYi1jb2RlL3Zhbm9pc2UuanBnXCIsXHJcbiAgfSxcclxuICB7XHJcbiAgICBuYW1lOiBcIkxhZ28gZGkgQnJhaWVzXCIsXHJcbiAgICBsaW5rOiBcImh0dHBzOi8vY29kZS5zMy55YW5kZXgubmV0L3dlYi1jb2RlL2xhZ28uanBnXCIsXHJcbiAgfSxcclxuICB7XHJcbiAgICBuYW1lOiBcIkJlZXJzaGViYSBUdXJraXNoIHJhaWx3YXkgc3RhdGlvblwiLFxyXG4gICAgbGluazogXCJodHRwczovL3VwbG9hZC53aWtpbWVkaWEub3JnL3dpa2lwZWRpYS9jb21tb25zL3RodW1iL2QvZGUvJUQ3JTlFJUQ3JUFBJUQ3JTk3JUQ3JTlEXyVENyVBQSVENyU5NyVENyVBMCVENyVBQV8lRDclOTQlRDclQTglRDclOUIlRDclOTElRDclQUFfJUQ3JTk0JUQ3JTk4JUQ3JTk1JUQ3JUE4JUQ3JUE3JUQ3JTk5JUQ3JUFBXyVENyU5MSVENyU5MSVENyU5MCVENyVBOF8lRDclQTklRDclOTElRDclQTIuanBnLzEyODBweC0lRDclOUUlRDclQUElRDclOTclRDclOURfJUQ3JUFBJUQ3JTk3JUQ3JUEwJUQ3JUFBXyVENyU5NCVENyVBOCVENyU5QiVENyU5MSVENyVBQV8lRDclOTQlRDclOTglRDclOTUlRDclQTglRDclQTclRDclOTklRDclQUFfJUQ3JTkxJUQ3JTkxJUQ3JTkwJUQ3JUE4XyVENyVBOSVENyU5MSVENyVBMi5qcGdcIixcclxuICB9LFxyXG4gIFxyXG5dO1xyXG5jb25zdCBmb3JtVmFsaWRhdG9ycyA9IHt9O1xyXG5cclxuY29uc3Qgb3BlbkVkaXRVc2VyUG9wdXBCdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2VkaXQtYnRuXCIpO1xyXG5jb25zdCBvcGVuQWRkUGxhY2VzUG9wdXBCdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2FkZC1idG5cIik7XHJcblxyXG5jb25zdCBuYW1lSW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdpbnB1dFtuYW1lPVwibmFtZV9pbnB1dFwiXScpO1xyXG5jb25zdCBhYm91dE1lSW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdpbnB1dFtuYW1lPVwiYWJvdXRfbWVcIl0nKTtcclxuXHJcbmV4cG9ydCB7XHJcbiAgYWJvdXRNZUlucHV0LFxyXG4gIG5hbWVJbnB1dCxcclxuICBpbml0aWFsQ2FyZHMsXHJcbiAgb3BlbkVkaXRVc2VyUG9wdXBCdG4sXHJcbiAgb3BlbkFkZFBsYWNlc1BvcHVwQnRuLFxyXG4gIGZvcm1WYWxpZGF0b3JzLFxyXG59O1xyXG4iLCJpbXBvcnQgXCIuL2luZGV4LmNzc1wiO1xyXG5pbXBvcnQgeyBhcGlDb25maW5nIH0gZnJvbSBcIi4uLy4uL2NvbmZpZy5qc1wiO1xyXG5pbXBvcnQgeyBGb3JtVmFsaWRhdG9yIH0gZnJvbSBcIi4uL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qc1wiO1xyXG5pbXBvcnQgeyBDYXJkIH0gZnJvbSBcIi4uL2NvbXBvbmVudHMvQ2FyZC5qc1wiO1xyXG5pbXBvcnQgU2VjdGlvbiBmcm9tIFwiLi4vY29tcG9uZW50cy9TZWN0aW9uLmpzXCI7XHJcbmltcG9ydCBQb3B1cFdpdGhGb3JtIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanNcIjtcclxuaW1wb3J0IFBvcHVwV2l0aEltYWdlIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzXCI7XHJcbmltcG9ydCBVc2VySW5mbyBmcm9tIFwiLi4vY29tcG9uZW50cy9Vc2VySW5mby5qc1wiO1xyXG5pbXBvcnQgQXBpIGZyb20gXCIuLi91dGlscy9BcGkuanNcIjtcclxuaW1wb3J0IHNwaW5uZXJHaWYgZnJvbSBcIi4uL2ltYWdlcy9wcm9maWxlL3NwaW5uZXJfc3ZnLnN2Z1wiO1xyXG5pbXBvcnQgeyBnZXRSYW5kb21TdHJpbmcgfSBmcm9tIFwiLi4vdXRpbHMvdXRpbHMuanNcIjtcclxuXHJcbmltcG9ydCB7XHJcbiAgYWJvdXRNZUlucHV0LFxyXG4gIG5hbWVJbnB1dCxcclxuICBpbml0aWFsQ2FyZHMsXHJcbiAgb3BlbkVkaXRVc2VyUG9wdXBCdG4sXHJcbiAgb3BlbkFkZFBsYWNlc1BvcHVwQnRuLFxyXG4gIGZvcm1WYWxpZGF0b3JzLFxyXG59IGZyb20gXCIuLi91dGlscy9jb25zdGFudHMuanNcIjtcclxuaW1wb3J0IFBvcHVwQ29uZmlybSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cENvbmZpcm1cIjtcclxuZnVuY3Rpb24gY3JlYXRlUGxhY2VJdGVtKGl0ZW0sIGNhcmRJbmZvKSB7XHJcbiAgY29uc3QgbmV3Q2FyZCA9IG5ldyBDYXJkKFxyXG4gICAgaXRlbSxcclxuICAgIG9wZW5JbWdQb3B1cCxcclxuICAgIG9wZW5SZW1vdmVJdGVtUG9wdXAsXHJcbiAgICBoYW5kbGVMaWtlZFRvZ2dsZSxcclxuICAgIGNhcmRJbmZvLFxyXG4gICAgXCIjcGxhY2VzLWl0ZW0tdGVtcGxhdGVcIlxyXG4gICk7XHJcbiAgcmV0dXJuIG5ld0NhcmQuZ2VuZXJhdGVDYXJkKCk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGVuYWJsZVZhbGlkYXRpb24oc2V0dGluZ3MpIHtcclxuICBjb25zdCBmb3JtSXRlbXMgPSBBcnJheS5mcm9tKFxyXG4gICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChzZXR0aW5ncy5mb3JtU2VsZWN0b3IpXHJcbiAgKTtcclxuXHJcbiAgZm9ybUl0ZW1zLmZvckVhY2goKGZvcm0pID0+IHtcclxuICAgIGNvbnN0IG5ld1ZhaWxkID0gbmV3IEZvcm1WYWxpZGF0b3Ioc2V0dGluZ3MsIGZvcm0pO1xyXG4gICAgY29uc3QgZm9ybU5hbWUgPSBmb3JtLm5hbWU7XHJcbiAgICBmb3JtVmFsaWRhdG9yc1tmb3JtTmFtZV0gPSBuZXdWYWlsZDtcclxuICAgIG5ld1ZhaWxkLmVuYWJsZVZhbGlkYXRpb24oKTtcclxuICB9KTtcclxufVxyXG5cclxuZnVuY3Rpb24gb3BlbkFkZFByb2ZpbGVQb3B1cCgpIHtcclxuICBmb3JtVmFsaWRhdG9yc1tcImZvcm1fYWRkLXBsYWNlXCJdLnJlc2V0VmFsaWRhdGlvbigpO1xyXG4gIEFkZFBvcHVwLm9wZW4oKTtcclxufVxyXG5mdW5jdGlvbiBvcGVuRWRpdFByb2ZpbGVQb3B1cCgpIHtcclxuICBmb3JtVmFsaWRhdG9yc1tcImZvcm1fcHJvZmlsZS1lZGl0XCJdLnJlc2V0VmFsaWRhdGlvbigpO1xyXG4gIEVkaXRQb3B1cC5vcGVuKCk7XHJcbiAgY29uc3QgeyBuYW1lSW5mbywgYWJvdXRNZUluZm8gfSA9IHByb2ZpbGVVc2VyLmdldFVzZXJJbmZvKCk7XHJcbiAgbmFtZUlucHV0LnZhbHVlID0gbmFtZUluZm87XHJcbiAgYWJvdXRNZUlucHV0LnZhbHVlID0gYWJvdXRNZUluZm87XHJcbn1cclxuZnVuY3Rpb24gb3BlbkltZ1BvcHVwKHRpdGxlLCBsaW5rKSB7XHJcbiAgTmV3SW1nUG9wdXAub3Blbih0aXRsZSwgbGluayk7XHJcbn1cclxuZnVuY3Rpb24gb3BlblJlbW92ZUl0ZW1Qb3B1cChpZCwgY2FyZEl0ZW0pIHtcclxuICBEZWxldGVDb25maXJtUG9wdXAub3BlbihpZCwgY2FyZEl0ZW0pO1xyXG59XHJcbmZ1bmN0aW9uIGhhbmRsZVN1Ym1pdEFkZEl0ZW0oeyB0aXRsZV9wbGFjZTogbmFtZSwgaW1nX2xpbms6IGxpbmsgfSkge1xyXG4gIGFwaVxyXG4gICAgLmFkZE5ld0NhcmQoe1xyXG4gICAgICBuYW1lLFxyXG4gICAgICBsaW5rLFxyXG4gICAgfSlcclxuICAgIC50aGVuKChyZXMpID0+IHtcclxuICAgICAgY29uc3QgY2FyZEluZm8gPSB7XHJcbiAgICAgICAgaXNPd25lcjogdHJ1ZSxcclxuICAgICAgICBsaWtlZEJ5T3duZXI6IGZhbHNlLFxyXG4gICAgICAgIGxpa2VzOiBbXSxcclxuICAgICAgfTtcclxuICAgICAgcmVuZGVyQ2FyZChyZXMsIGNhcmRJbmZvKTtcclxuICAgIH0pO1xyXG59XHJcbmZ1bmN0aW9uIGhhbmRsZVN1Ym1pdFJlbW92ZUNvbmZpcm0oaWQsIGVsZW1lbnQpIHtcclxuICBhcGlcclxuICAgIC5vblJlbW92ZUl0ZW0oaWQpXHJcbiAgICAudGhlbigoKSA9PiB7XHJcbiAgICAgIGVsZW1lbnQucmVtb3ZlKCk7XHJcbiAgICB9KVxyXG4gICAgLmNhdGNoKChlcnIpID0+IGNvbnNvbGUubG9nKFwiZXJyOiBcIiArIGVycikpO1xyXG59XHJcbmZ1bmN0aW9uIGhhbmRsZVN1Ym1pdEVkaXRQcm9maWxlKHsgbmFtZV9pbnB1dCwgYWJvdXRfbWUgfSkge1xyXG4gIGZvcm1WYWxpZGF0b3JzW1wiZm9ybV9hZGQtcGxhY2VcIl0ucmVzZXRWYWxpZGF0aW9uKCk7XHJcbiAgYXBpLnNldFVzZXJJbmZvKHsgbmFtZTogbmFtZV9pbnB1dCwgYWJvdXQ6IGFib3V0X21lIH0pLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgcHJvZmlsZVVzZXIuc2V0VXNlckluZm8ocmVzKTtcclxuICB9KTtcclxufVxyXG5mdW5jdGlvbiBoYW5kbGVMaWtlZFRvZ2dsZShpc0xpa2VkLCBpdGVtLCBpZCkge1xyXG4gIGlmIChpc0xpa2VkKSB7XHJcbiAgICBhcGlcclxuICAgICAgLmFkZEl0ZW1MaWtlKGlkKVxyXG4gICAgICAudGhlbigocmVzKSA9PiB7XHJcbiAgICAgICAgaXRlbS5vblVwZGF0ZUxpa2VzQW1vdW50KHJlcy5saWtlcyk7XHJcbiAgICAgIH0pXHJcbiAgICAgIC5jYXRjaCgoZXJyKSA9PiBjb25zb2xlLmxvZyhcImVycjogXCIgKyBlcnIpKTtcclxuICB9IGVsc2Uge1xyXG4gICAgYXBpXHJcbiAgICAgIC5yZW1vdmVJdGVtTGlrZShpZClcclxuICAgICAgLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICAgIGl0ZW0ub25VcGRhdGVMaWtlc0Ftb3VudChyZXMubGlrZXMpO1xyXG4gICAgICB9KVxyXG4gICAgICAuY2F0Y2goKGVycikgPT4gY29uc29sZS5sb2coXCJlcnI6IFwiICsgZXJyKSk7XHJcbiAgfVxyXG59XHJcbmZ1bmN0aW9uIHNldExvYWRpbmdJbml0KHN0YXR1cywgY2FyZEl0ZW1zQXJyLCB1c2VySW5mbykge1xyXG4gIGlmIChzdGF0dXMpIHtcclxuICAgIHByb2ZpbGVVc2VyLnNldFVzZXJJbmZvKHtcclxuICAgICAgbmFtZTogXCJMb2FkaW5nLi4uXCIsXHJcbiAgICAgIGFib3V0OiBcIkxvYWRpbmcuLi5cIixcclxuICAgICAgX2lkOiBnZXRSYW5kb21TdHJpbmcoKSxcclxuICAgIH0pO1xyXG4gICAgcHJvZmlsZVVzZXIuc2V0UGljdHVyZVByb2ZpbGUoc3Bpbm5lckdpZik7XHJcbiAgICBjYXJkc0xpc3Quc2V0TmV3SXRlbWxpc3QoW1xyXG4gICAgICB7XHJcbiAgICAgICAgbmFtZTogXCJMb2FkaW5nLi4uXCIsXHJcbiAgICAgICAgbGluazogc3Bpbm5lckdpZixcclxuICAgICAgICBvd25lcjogeyBfaWQ6IGdldFJhbmRvbVN0cmluZygpIH0sXHJcbiAgICAgICAgbGlrZXM6IFtdLFxyXG4gICAgICB9LFxyXG4gICAgXSk7XHJcbiAgfSBlbHNlIHtcclxuICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucGxhY2VzX19ncmlkLWNvbnRhaW5lclwiKS5pbm5lckhUTUwgPSBcIlwiO1xyXG4gICAgcHJvZmlsZVVzZXIuc2V0VXNlckluZm8oe1xyXG4gICAgICBuYW1lOiB1c2VySW5mby5uYW1lLFxyXG4gICAgICBhYm91dDogdXNlckluZm8uYWJvdXQsXHJcbiAgICAgIF9pZDogdXNlckluZm8uX2lkLFxyXG4gICAgfSk7XHJcbiAgICBwcm9maWxlVXNlci5zZXRQaWN0dXJlUHJvZmlsZSh1c2VySW5mby5hdmF0YXIpO1xyXG5cclxuICAgIGNhcmRzTGlzdC5zZXROZXdJdGVtbGlzdChjYXJkSXRlbXNBcnIpO1xyXG4gIH1cclxufVxyXG5mdW5jdGlvbiBvbkluaXQoKSB7XHJcbiAgc2V0TG9hZGluZ0luaXQodHJ1ZSk7XHJcbiAgYXBpXHJcbiAgICAuZ2V0SW5pdEluZm8oKVxyXG4gICAgLnRoZW4oKFtjYXJkSXRlbXNBcnIsIHVzZXJJbmZvXSkgPT4ge1xyXG4gICAgICBzZXRMb2FkaW5nSW5pdChmYWxzZSwgY2FyZEl0ZW1zQXJyLCB1c2VySW5mbyk7XHJcbiAgICAgIG9wZW5FZGl0VXNlclBvcHVwQnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBvcGVuRWRpdFByb2ZpbGVQb3B1cCk7XHJcbiAgICAgIG9wZW5BZGRQbGFjZXNQb3B1cEJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgb3BlbkFkZFByb2ZpbGVQb3B1cCk7XHJcbiAgICAgIGVuYWJsZVZhbGlkYXRpb24oe1xyXG4gICAgICAgIGZvcm1TZWxlY3RvcjogXCIucG9wdXAtYm94X19mb3JtXCIsXHJcbiAgICAgICAgaW5wdXRTZWxlY3RvcjogXCIucG9wdXAtYm94X19pbnB1dFwiLFxyXG4gICAgICAgIHN1Ym1pdEJ1dHRvblNlbGVjdG9yOiBcIi5wb3B1cC1ib3hfX3N1Ym1pdC1idXR0b25cIixcclxuICAgICAgICBpbmFjdGl2ZUJ1dHRvbkNsYXNzOiBcInBvcHVwLWJveF9fc3VibWl0LWJ1dHRvbl9pbmFjdGl2ZVwiLFxyXG4gICAgICAgIGlucHV0RXJyb3JDbGFzczogXCIucG9wdXAtYm94X19pbnB1dF90eXBlX2Vycm9yXCIsXHJcbiAgICAgICAgZXJyb3JDbGFzczogXCIucG9wdXAtYm94X19pbnB1dC1lcnJvcl9hY3RpdmVcIixcclxuICAgICAgfSk7XHJcbiAgICAgIHNldFBvcHVwRXZlbnQoKTtcclxuICAgIH0pXHJcblxyXG4gICAgLmNhdGNoKChlcnIpID0+IHtcclxuICAgICAgY29uc29sZS5sb2coZXJyKTtcclxuICAgIH0pO1xyXG59XHJcblxyXG5mdW5jdGlvbiBzZXRQb3B1cEV2ZW50KCkge1xyXG4gIEVkaXRQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xyXG4gIEFkZFBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgTmV3SW1nUG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuICBEZWxldGVDb25maXJtUG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxufVxyXG5mdW5jdGlvbiByZW5kZXJDYXJkKGl0ZW0sIGNhcmRJbmZvKSB7XHJcbiAgY2FyZHNMaXN0LmFkZEl0ZW0oY3JlYXRlUGxhY2VJdGVtKGl0ZW0sIGNhcmRJbmZvKSk7XHJcbn1cclxuXHJcbmNvbnN0IGNhcmRzTGlzdCA9IG5ldyBTZWN0aW9uKHtcclxuICByZW5kZXJlcjogKGRhdGEpID0+IHtcclxuICAgIGNvbnN0IHsgb3duZXIsIGxpa2VzIH0gPSBkYXRhO1xyXG4gICAgY29uc3QgaWQgPSBwcm9maWxlVXNlci5nZXRVc2VySWQoKTtcclxuICAgIGNvbnN0IGNhcmRJbmZvID0ge1xyXG4gICAgICBpc093bmVyOiBvd25lci5faWQgPT09IGlkLFxyXG4gICAgICBsaWtlZEJ5Q3VyclVzZXI6IGxpa2VzLnNvbWUoKHVzZXIpID0+IHVzZXIuX2lkID09PSBpZCksXHJcbiAgICAgIGxpa2VzLFxyXG4gICAgfTtcclxuICAgIHJlbmRlckNhcmQoZGF0YSwgY2FyZEluZm8pO1xyXG4gIH0sXHJcbiAgY29udGFpbmVyU2VsZWN0b3I6IFwiLnBsYWNlc19fZ3JpZC1jb250YWluZXJcIixcclxufSk7XHJcbmNvbnN0IEVkaXRQb3B1cCA9IG5ldyBQb3B1cFdpdGhGb3JtKFxyXG4gIFwiLnBvcHVwLWJveF90eXBlX3Byb2ZpbGUtZWRpdFwiLFxyXG4gIGhhbmRsZVN1Ym1pdEVkaXRQcm9maWxlXHJcbik7XHJcbmNvbnN0IEFkZFBvcHVwID0gbmV3IFBvcHVwV2l0aEZvcm0oXHJcbiAgXCIucG9wdXAtYm94X3R5cGVfYWRkLWl0ZW1cIixcclxuICBoYW5kbGVTdWJtaXRBZGRJdGVtXHJcbik7XHJcbmNvbnN0IE5ld0ltZ1BvcHVwID0gbmV3IFBvcHVwV2l0aEltYWdlKHtcclxuICBwb3B1cFNlbGVjdG9yOiBcIi5wb3B1cC1ib3hfdHlwZV9pbWdcIixcclxuICBpbWdTZWxlY3RvcjogXCIucG9wdXAtYm94X19pbWdcIixcclxuICBpbWdUaXRsZVNlbGVjdG9yOiBcIi5wb3B1cC1ib3hfX2ltZy10aXRsZVwiLFxyXG59KTtcclxuXHJcbmNvbnN0IERlbGV0ZUNvbmZpcm1Qb3B1cCA9IG5ldyBQb3B1cENvbmZpcm0oe1xyXG4gIHBvcHVwU2VsZWN0b3I6IFwiLnBvcHVwLWJveF90eXBlX2NvbmZpcm1cIixcclxuICBoYW5kbGVTdWJtaXRSZW1vdmVDb25maXJtLFxyXG59KTtcclxuY29uc3QgcHJvZmlsZVVzZXIgPSBuZXcgVXNlckluZm8oe1xyXG4gIG5hbWVFbG06IFwiLnByb2ZpbGVfX25hbWVcIixcclxuICBqb2JFbG06IFwiLnByb2ZpbGVfX2Fib3V0LW1lXCIsXHJcbiAgcGljRWxtOiBcIi5wcm9maWxlX19hdmF0YXJcIixcclxufSk7XHJcbmNvbnN0IGFwaSA9IG5ldyBBcGkoYXBpQ29uZmluZyk7XHJcblxyXG5vbkluaXQoKTtcclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgU2VjdGlvbiB7XHJcbiAgY29uc3RydWN0b3Ioe3JlbmRlcmVyLCBjb250YWluZXJTZWxlY3Rvcn0pIHtcclxuICAgIHRoaXMuX3JlbmRlcmVyID0gcmVuZGVyZXI7XHJcbiAgICB0aGlzLl9jb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGNvbnRhaW5lclNlbGVjdG9yKTtcclxuICB9XHJcblxyXG4gIHJlbmRlckl0ZW1zKCkge1xyXG4gICAgdGhpcy5faXRlbXMuZm9yRWFjaCgoaXRlbSkgPT4gdGhpcy5fcmVuZGVyZXIoaXRlbSkpO1xyXG4gIH1cclxuXHJcbiAgYWRkSXRlbShlbCkge1xyXG4gICAgdGhpcy5fY29udGFpbmVyLnByZXBlbmQoZWwpO1xyXG4gIH1cclxuICBzZXROZXdJdGVtbGlzdChpdGVtcykge1xyXG4gICAgdGhpcy5faXRlbXMgPSBpdGVtcztcclxuICAgIHRoaXMucmVuZGVySXRlbXMoKTtcclxuICB9XHJcbn1cclxuIiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwLmpzXCI7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhJbWFnZSBleHRlbmRzIFBvcHVwIHtcclxuICBjb25zdHJ1Y3Rvcih7IHBvcHVwU2VsZWN0b3IsIGltZ1NlbGVjdG9yLCBpbWdUaXRsZVNlbGVjdG9yIH0pIHtcclxuICAgIHN1cGVyKHBvcHVwU2VsZWN0b3IpO1xyXG4gICAgdGhpcy5faW1nRWxlbWVudCA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKGltZ1NlbGVjdG9yKTtcclxuICAgIHRoaXMuX3RpdGxlRWxlbWVudCA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKGltZ1RpdGxlU2VsZWN0b3IpO1xyXG4gIH1cclxuXHJcbiAgX3NldFBvcHVwSW1nKCkge1xyXG4gICAgdGhpcy5fdGl0bGVFbGVtZW50LnRleHRDb250ZW50ID0gdGhpcy50aXRsZTtcclxuICAgIHRoaXMuX2ltZ0VsZW1lbnQuc3JjID0gdGhpcy5fbGluaztcclxuICAgIHRoaXMuX2ltZ0VsZW1lbnQuYWx0ID0gYGEgcGljdHJ1ZSBvZiAke3RoaXMudGl0bGV9YDtcclxuICB9XHJcblxyXG4gIG9wZW4odGl0bGUsIGxpbmspIHtcclxuICAgIHRoaXMudGl0bGUgPSB0aXRsZTtcclxuICAgIHRoaXMuX2xpbmsgPSBsaW5rO1xyXG4gICAgdGhpcy5fc2V0UG9wdXBJbWcoKTtcclxuICAgIHN1cGVyLm9wZW4oKTtcclxuICB9XHJcbn1cclxuIiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwXCI7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cENvbmZpcm0gZXh0ZW5kcyBQb3B1cCB7XHJcbiAgY29uc3RydWN0b3IoeyBwb3B1cFNlbGVjdG9yLCBoYW5kbGVTdWJtaXRSZW1vdmVDb25maXJtIH0pIHtcclxuICAgIHN1cGVyKHBvcHVwU2VsZWN0b3IpO1xyXG4gICAgdGhpcy5faGFuZGxlU3VibWl0UmVtb3ZlQ29uZmlybSA9IGhhbmRsZVN1Ym1pdFJlbW92ZUNvbmZpcm07XHJcbiAgICB0aGlzLl9zdWJtaXRCdG5FbGVtZW50ID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgICAgIFwiLnBvcHVwLWJveF9fc3VibWl0LWJ1dHRvblwiXHJcbiAgICApO1xyXG4gIH1cclxuICBvcGVuKGlkLCBlbGVtZW50KSB7XHJcbiAgICBzdXBlci5vcGVuKCk7XHJcbiAgICB0aGlzLl9lbGVtZW50ID0gZWxlbWVudDtcclxuICAgIHRoaXMuX2lkID0gaWQ7XHJcbiAgfVxyXG4gIGNsb3NlKCkge1xyXG4gICAgc3VwZXIuY2xvc2UoKTtcclxuXHJcbiAgfVxyXG4gIF9oYW5kbGVDb25maXJtU3VibWl0ID0gKGUpID0+IHtcclxuICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgIHRoaXMuX2hhbmRsZVN1Ym1pdFJlbW92ZUNvbmZpcm0odGhpcy5faWQsIHRoaXMuX2VsZW1lbnQpO1xyXG4gICAgdGhpcy5jbG9zZSgpO1xyXG4gIH07XHJcblxyXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgdGhpcy5fc3VibWl0QnRuRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgdGhpcy5faGFuZGxlQ29uZmlybVN1Ym1pdCk7XHJcbiAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xyXG4gIH1cclxufVxyXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBVc2VySW5mbyB7XHJcbiAgY29uc3RydWN0b3IoeyBuYW1lRWxtLCBqb2JFbG0sIHBpY0VsbSB9KSB7XHJcbiAgICB0aGlzLl9uYW1lRWxtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihuYW1lRWxtKTtcclxuICAgIHRoaXMuX2pvYkVsbSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3Ioam9iRWxtKTtcclxuICAgIHRoaXMuX3BpY0VsbSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IocGljRWxtKTtcclxuICAgIHBpY0VsbTtcclxuICB9XHJcblxyXG4gIHNldFVzZXJJbmZvKHsgbmFtZSwgYWJvdXQsIF9pZCB9KSB7XHJcbiAgICB0aGlzLl9uYW1lRWxtLnRleHRDb250ZW50ID0gbmFtZTtcclxuICAgIHRoaXMuX2pvYkVsbS50ZXh0Q29udGVudCA9IGFib3V0O1xyXG4gICAgdGhpcy51c2VySWQgPSBfaWQ7XHJcbiAgfVxyXG4gIGdldFVzZXJJbmZvKCkge1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgbmFtZUluZm86IHRoaXMuX25hbWVFbG0udGV4dENvbnRlbnQsXHJcbiAgICAgIGFib3V0TWVJbmZvOiB0aGlzLl9qb2JFbG0udGV4dENvbnRlbnQsXHJcbiAgICAgIFxyXG4gICAgfTtcclxuICB9XHJcbiAgZ2V0VXNlcklkKCkge1xyXG4gICAgcmV0dXJuIHRoaXMudXNlcklkXHJcbiAgfVxyXG4gIHNldFBpY3R1cmVQcm9maWxlKHBpY1NyYykge1xyXG4gICAgdGhpcy5fcGljRWxtLnNyYyA9IHBpY1NyYztcclxuICB9XHJcbn1cclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgQXBpIHtcclxuICBjb25zdHJ1Y3Rvcih7IGJhc2VVcmwsIGhlYWRlcnMgfSkge1xyXG4gICAgdGhpcy5oZWFkZXJzID0gaGVhZGVycztcclxuICAgIHRoaXMuYmFzZVVybCA9IGJhc2VVcmw7XHJcbiAgfVxyXG4gIF9vbkh0dHBSZXF1ZXN0KHVybCwgbWV0aG9kLCBkYXRhKSB7XHJcbiAgICBjb25zdCBmdWxsVXJsID0gYCR7dGhpcy5iYXNlVXJsfSR7dXJsfWA7XHJcbiAgICByZXR1cm4gZmV0Y2goZnVsbFVybCwge1xyXG4gICAgICBtZXRob2QsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuaGVhZGVycyxcclxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoZGF0YSksXHJcbiAgICB9KS50aGVuKChyZXMpID0+IHtcclxuICAgICAgaWYgKHJlcy5vaykge1xyXG4gICAgICAgIHJldHVybiByZXMuanNvbigpO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgfVxyXG4gIGdldEluaXRJbmZvKCkge1xyXG4gICAgcmV0dXJuIFByb21pc2UuYWxsKFt0aGlzLl9nZXRJbml0aWFsQ2FyZHMoKSwgdGhpcy5fZ2V0VXNlckluZm8oKV0pO1xyXG4gIH1cclxuICBfZ2V0VXNlckluZm8oKSB7XHJcbiAgICByZXR1cm4gdGhpcy5fb25IdHRwUmVxdWVzdChcInVzZXJzL21lXCIsIFwiR0VUXCIpO1xyXG4gIH1cclxuICBfZ2V0SW5pdGlhbENhcmRzKCkge1xyXG4gICAgcmV0dXJuIHRoaXMuX29uSHR0cFJlcXVlc3QoXCJjYXJkc1wiLCBcIkdFVFwiKTtcclxuICB9XHJcbiBcclxuICBzZXRVc2VySW5mbyh7bmFtZSxhYm91dH0pIHtcclxuICAgIHJldHVybiB0aGlzLl9vbkh0dHBSZXF1ZXN0KFwidXNlcnMvbWVcIiwgXCJQQVRDSFwiLHtuYW1lLGFib3V0fSk7XHJcbiAgfVxyXG4gIGFkZE5ld0NhcmQoe25hbWUsbGlua30pIHtcclxuICAgIHJldHVybiB0aGlzLl9vbkh0dHBSZXF1ZXN0KCdjYXJkcycsJ1BPU1QnLHtuYW1lLGxpbmt9KVxyXG4gIH1cclxuICBvblJlbW92ZUl0ZW0oaWQpIHtcclxuICAgIHJldHVybiB0aGlzLl9vbkh0dHBSZXF1ZXN0KGBjYXJkcy8ke2lkfWAsJ0RFTEVURScpXHJcbiAgfVxyXG4gIGFkZEl0ZW1MaWtlKGlkKSB7XHJcbiAgICByZXR1cm4gdGhpcy5fb25IdHRwUmVxdWVzdChgY2FyZHMvbGlrZXMvJHtpZH1gLCdQVVQnKVxyXG4gICAgXHJcbiAgfVxyXG4gIHJlbW92ZUl0ZW1MaWtlKGlkKSB7XHJcbiAgICByZXR1cm4gdGhpcy5fb25IdHRwUmVxdWVzdChgY2FyZHMvbGlrZXMvJHtpZH1gLCdERUxFVEUnKVxyXG5cclxuICB9XHJcbn1cclxuIiwiY29uc3QgYXBpQ29uZmluZyA9IHtcclxuICBiYXNlVXJsOiBcImh0dHBzOi8vYXJvdW5kLm5vbW9yZXBhcnRpZXMuY28vdjEvZ3JvdXAtMTIvXCIsXHJcbiAgaGVhZGVyczoge1xyXG4gIGF1dGhvcml6YXRpb246IFwiMDM1YTNlODAtMGQzZi00MjFiLWI0ZmEtN2Y0MDZlNDlhZDVmXCIsXHJcbiAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIlxyXG4gIH1cclxufTtcclxuZXhwb3J0IHsgYXBpQ29uZmluZyB9O1xyXG4iXSwibmFtZXMiOlsiX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fIiwiX193ZWJwYWNrX3JlcXVpcmVfXyIsIm1vZHVsZUlkIiwiY2FjaGVkTW9kdWxlIiwidW5kZWZpbmVkIiwiZXhwb3J0cyIsIm1vZHVsZSIsIl9fd2VicGFja19tb2R1bGVzX18iLCJwIiwiRm9ybVZhbGlkYXRvciIsImNvbnN0cnVjdG9yIiwic2V0dGluZ3MiLCJmb3JtIiwidGhpcyIsIl9mb3JtU2VsZWN0b3IiLCJmb3JtU2VsZWN0b3IiLCJfaW5wdXRTZWxlY3RvciIsImlucHV0U2VsZWN0b3IiLCJfZXJyb3JDbGFzcyIsImVycm9yQ2xhc3MiLCJfaW5hY3RpdmVCdXR0b25DbGFzcyIsImluYWN0aXZlQnV0dG9uQ2xhc3MiLCJfaW5wdXRFcnJvckNsYXNzIiwiaW5wdXRFcnJvckNsYXNzIiwiX3N1Ym1pdEJ1dHRvblNlbGVjdG9yIiwic3VibWl0QnV0dG9uU2VsZWN0b3IiLCJfZm9ybSIsIl9zZXRGb3JtTGlzdGVuZXJzIiwiX2lucHV0TGlzdCIsIkFycmF5IiwiZnJvbSIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJfYnV0dG9uRWxlbWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJfdG9nZ2xlQnV0dG9uU3RhdGUiLCJmb3JFYWNoIiwiaW5wdXRFbGVtZW50IiwiYWRkRXZlbnRMaXN0ZW5lciIsIl9jaGVja0lucHV0VmFsaWRpdHkiLCJfc2hvd0lucHV0RXJyb3IiLCJlcnJvckVsZW1lbnQiLCJpZCIsImNsYXNzTGlzdCIsImFkZCIsInRleHRDb250ZW50IiwidmFsaWRhdGlvbk1lc3NhZ2UiLCJfcmVtb3ZlSW5wdXRFcnJvciIsInJlbW92ZSIsInZhbGlkaXR5IiwidmFsaWQiLCJyZXNldFZhbGlkYXRpb24iLCJidG5Gb3JtRWxtIiwiZGlzYWJsZWQiLCJyZXNldCIsIl9oYXNJbnZhbGlkSW5wdXQiLCJzb21lIiwiaW5wdXQiLCJlbmFibGVWYWxpZGF0aW9uIiwiZSIsInByZXZlbnREZWZhdWx0IiwiZ2V0UmFuZG9tU3RyaW5nIiwibGVuZ3RoIiwiZ2V0UmFuZG9tSW50IiwiY2hhcnMiLCJzcGxpdCIsIk1hdGgiLCJmbG9vciIsInJhbmRvbSIsInN0ciIsImkiLCJtaW4iLCJtYXgiLCJDYXJkIiwiZGF0YSIsImhhbmRsZUltYWdlQ2xpY2siLCJvcGVuUmVtb3ZlSXRlbVBvcHVwIiwiaGFuZGxlTGlrZWRUb2dnbGUiLCJjYXJkSW5mbyIsImNhcmRTZWxlY3RvciIsIm5hbWUiLCJsaW5rIiwiX2lkIiwibGlrZXMiLCJpc093bmVyIiwibGlrZWRCeUN1cnJVc2VyIiwiX25hbWUiLCJfbGluayIsIl9oYW5kbGVJbWFnZUNsaWNrIiwiX29wZW5SZW1vdmVJdGVtUG9wdXAiLCJfY2FyZFNlbGVjdG9yIiwiX2xpa2VzIiwiX2lzT3duZXIiLCJfaXNMaWtlZEJ5Q3VyclVzZXIiLCJfaGFuZGxlTGlrZWRUb2dnbGUiLCJfZ2V0VGVtcGxhdGUiLCJkb2N1bWVudCIsImNvbnRlbnQiLCJjbG9uZU5vZGUiLCJfaGFuZGxlVG9nZ2xlTGlrZWRCdG4iLCJzdG9wUHJvcGFnYXRpb24iLCJfcGxhY2VMaWtlQnRuIiwib25VcGRhdGVMaWtlc0Ftb3VudCIsIl9wbGFjZUxpa2VBbW91bnQiLCJfaGFuZGxlUmVtb3ZlSXRlbSIsIl9jYXJkSXRlbSIsIl9zZXRFdmVudExpc3RlbmVycyIsImdlbmVyYXRlQ2FyZCIsIl9wbGFjZUltZyIsIl9wbGFjZVJlbW92ZUJ0biIsInN0eWxlIiwiYmFja2dyb3VuZEltYWdlIiwiYWx0IiwiUG9wdXAiLCJwb3B1cFNlbGVjdG9yIiwia2V5IiwiY2xvc2UiLCJfcG9wdXBFbGVtZW50Iiwib3BlbiIsIl9oYW5kbGVFc2NDbG9zZSIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJzZXRFdmVudExpc3RlbmVycyIsInRhcmdldCIsImNvbnRhaW5zIiwiUG9wdXBXaXRoRm9ybSIsImhhbmRsZVN1Ym1pdEZyb20iLCJzdXBlciIsIl9oYW5kbGVTdWJtaXRGcm9tIiwiX3JldHVybklucHV0VmFsT2JqIiwiX2Zvcm1FbGVtZW50IiwidmFsSW5wdXRPYmoiLCJpdGVtIiwidmFsdWUiLCJfaGFuZGxlRm9ybVN1Ym1pdCIsImZvcm1WYWxpZGF0b3JzIiwib3BlbkVkaXRVc2VyUG9wdXBCdG4iLCJvcGVuQWRkUGxhY2VzUG9wdXBCdG4iLCJuYW1lSW5wdXQiLCJhYm91dE1lSW5wdXQiLCJvcGVuQWRkUHJvZmlsZVBvcHVwIiwiQWRkUG9wdXAiLCJvcGVuRWRpdFByb2ZpbGVQb3B1cCIsIkVkaXRQb3B1cCIsIm5hbWVJbmZvIiwiYWJvdXRNZUluZm8iLCJwcm9maWxlVXNlciIsImdldFVzZXJJbmZvIiwib3BlbkltZ1BvcHVwIiwidGl0bGUiLCJOZXdJbWdQb3B1cCIsImNhcmRJdGVtIiwiRGVsZXRlQ29uZmlybVBvcHVwIiwiaXNMaWtlZCIsImFwaSIsImFkZEl0ZW1MaWtlIiwidGhlbiIsInJlcyIsImNhdGNoIiwiZXJyIiwiY29uc29sZSIsImxvZyIsInJlbW92ZUl0ZW1MaWtlIiwic2V0TG9hZGluZ0luaXQiLCJzdGF0dXMiLCJjYXJkSXRlbXNBcnIiLCJ1c2VySW5mbyIsInNldFVzZXJJbmZvIiwiYWJvdXQiLCJzZXRQaWN0dXJlUHJvZmlsZSIsInNwaW5uZXJHaWYiLCJjYXJkc0xpc3QiLCJzZXROZXdJdGVtbGlzdCIsIm93bmVyIiwiaW5uZXJIVE1MIiwiYXZhdGFyIiwicmVuZGVyQ2FyZCIsImFkZEl0ZW0iLCJjcmVhdGVQbGFjZUl0ZW0iLCJyZW5kZXJlciIsImNvbnRhaW5lclNlbGVjdG9yIiwiX3JlbmRlcmVyIiwiX2NvbnRhaW5lciIsInJlbmRlckl0ZW1zIiwiX2l0ZW1zIiwiZWwiLCJwcmVwZW5kIiwiaXRlbXMiLCJnZXRVc2VySWQiLCJ1c2VyIiwibmFtZV9pbnB1dCIsImFib3V0X21lIiwidGl0bGVfcGxhY2UiLCJpbWdfbGluayIsImFkZE5ld0NhcmQiLCJsaWtlZEJ5T3duZXIiLCJpbWdTZWxlY3RvciIsImltZ1RpdGxlU2VsZWN0b3IiLCJfaW1nRWxlbWVudCIsIl90aXRsZUVsZW1lbnQiLCJfc2V0UG9wdXBJbWciLCJzcmMiLCJoYW5kbGVTdWJtaXRSZW1vdmVDb25maXJtIiwiX2hhbmRsZVN1Ym1pdFJlbW92ZUNvbmZpcm0iLCJfZWxlbWVudCIsIl9zdWJtaXRCdG5FbGVtZW50IiwiZWxlbWVudCIsIl9oYW5kbGVDb25maXJtU3VibWl0Iiwib25SZW1vdmVJdGVtIiwibmFtZUVsbSIsImpvYkVsbSIsInBpY0VsbSIsIl9uYW1lRWxtIiwiX2pvYkVsbSIsIl9waWNFbG0iLCJ1c2VySWQiLCJwaWNTcmMiLCJiYXNlVXJsIiwiaGVhZGVycyIsIl9vbkh0dHBSZXF1ZXN0IiwidXJsIiwibWV0aG9kIiwiZnVsbFVybCIsImZldGNoIiwiYm9keSIsIkpTT04iLCJzdHJpbmdpZnkiLCJvayIsImpzb24iLCJQcm9taXNlIiwicmVqZWN0IiwiZ2V0SW5pdEluZm8iLCJhbGwiLCJfZ2V0SW5pdGlhbENhcmRzIiwiX2dldFVzZXJJbmZvIiwiYXV0aG9yaXphdGlvbiIsIm5ld1ZhaWxkIiwiZm9ybU5hbWUiXSwic291cmNlUm9vdCI6IiJ9